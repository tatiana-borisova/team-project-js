parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"clu1":[function(require,module,exports) {

},{"./../fonts/roboto-v29-latin-regular.eot":[["roboto-v29-latin-regular.c305bc34.eot","bfF6"],"bfF6"],"./../fonts/roboto-v29-latin-regular.woff2":[["roboto-v29-latin-regular.04b4334c.woff2","S1de"],"S1de"],"./../fonts/roboto-v29-latin-regular.woff":[["roboto-v29-latin-regular.4841bd6e.woff","M7qt"],"M7qt"],"./../fonts/roboto-v29-latin-regular.ttf":[["roboto-v29-latin-regular.887afede.ttf","WCKa"],"WCKa"],"./../fonts/roboto-v29-latin-regular.svg":[["roboto-v29-latin-regular.ab9033c4.svg","ubUI"],"ubUI"],"./../fonts/roboto-v29-latin-500.eot":[["roboto-v29-latin-500.1adad60e.eot","snNY"],"snNY"],"./../fonts/roboto-v29-latin-500.woff2":[["roboto-v29-latin-500.687684e9.woff2","pO6o"],"pO6o"],"./../fonts/roboto-v29-latin-500.woff":[["roboto-v29-latin-500.e90a09a5.woff","J4QS"],"J4QS"],"./../fonts/roboto-v29-latin-500.ttf":[["roboto-v29-latin-500.c163cb67.ttf","yqrD"],"yqrD"],"./../fonts/roboto-v29-latin-500.svg":[["roboto-v29-latin-500.e970ecea.svg","wI4V"],"wI4V"],"./../images/film.jpg":[["film.39320e0f.jpg","b4k8"],"b4k8"],"./../images/background/rectangle-1x-desktop.jpg":[["rectangle-1x-desktop.dcabd5f6.jpg","Bz7m"],"Bz7m"],"./../images/background/rectangle-2x-desktop.jpg":[["rectangle-2x-desktop.96e92ea3.jpg","PZ3y"],"PZ3y"],"./../images/background/library-1x-desktop.jpg":[["library-1x-desktop.007550a9.jpg","PQgW"],"PQgW"],"./../images/background/library-2x-desktop.jpg":[["library-2x-desktop.989f2ef3.jpg","iccm"],"iccm"],"./../images/sun-moon.png":[["sun-moon.5a3f400b.png","oZIM"],"oZIM"]}],"VyiV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={homeLink:document.querySelector(".header-links__link--home"),libraryLink:document.querySelector(".header-links__item--library"),libraryBtns:document.querySelector(".header-library__list"),watchedBtn:document.querySelector(".header-library__btn--watched"),queueBtn:document.querySelector(".header-library__btn--queue"),searchForm:document.querySelector(".header-form"),searchInput:document.querySelector(".header-form__input"),gallery:document.querySelector(".gallery"),galleryItem:document.querySelector(".gallery__item"),headerBackground:document.querySelector(".header"),movieModal:document.querySelector(".modal-movie"),modalContainer:document.querySelector(".modal-container"),developerLink:document.querySelector(".developer__link"),loginLink:document.getElementById("login"),logoutLink:document.getElementById("logout"),footer:document.querySelector(".footer"),closeModalBtn:document.querySelector("[data-modal-close]"),modal:document.querySelector("[data-modal]"),backdrop:document.querySelector(".backdrop"),scrollBtn:document.querySelector("#scrollBtn"),filter:document.querySelector(".filter")};exports.default=e;
},{}],"a5Nu":[function(require,module,exports) {
var define;
var e;!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof e&&e.amd?e([],i):"object"==typeof exports?exports.SlimSelect=i():t.SlimSelect=i()}(window,function(){return i={},e.m=t=[function(e,t,i){"use strict";function s(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}var n;t.__esModule=!0,t.hasClassInTree=function(e,t){function i(e,t){return t&&e&&e.classList&&e.classList.contains(t)?e:null}return i(e,t)||function e(t,s){return t&&t!==document?i(t,s)?t:e(t.parentNode,s):null}(e,t)},t.ensureElementInView=function(e,t){var i=e.scrollTop+e.offsetTop,s=i+e.clientHeight,n=t.offsetTop,a=n+t.clientHeight;n<i?e.scrollTop-=i-n:s<a&&(e.scrollTop+=a-s)},t.putContent=function(e,t,i){var s=e.offsetHeight,n=e.getBoundingClientRect(),a=i?n.top:n.top-s,o=i?n.bottom:n.bottom+s;return a<=0?"below":o>=window.innerHeight?"above":i?t:"below"},t.debounce=function(e,t,i){var s;return void 0===t&&(t=100),void 0===i&&(i=!1),function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var o=self,l=i&&!s;clearTimeout(s),s=setTimeout(function(){s=null,i||e.apply(o,n)},t),l&&e.apply(o,n)}},t.isValueInArrayOfObjects=function(e,t,i){if(!Array.isArray(e))return e[t]===i;for(var s=0,n=e;s<n.length;s++){var a=n[s];if(a&&a[t]&&a[t]===i)return!0}return!1},t.highlight=function(e,t,i){var s=e,n=new RegExp("("+t.trim()+")(?![^<]*>[^<>]*</)","i");if(!e.match(n))return e;var a=e.match(n).index,o=a+e.match(n)[0].toString().length,l=e.substring(a,o);return s.replace(n,'<mark class="'+i+'">'+l+"</mark>")},t.kebabCase=function(e){var t=e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,function(e){return"-"+e.toLowerCase()});return e[0]===e[0].toUpperCase()?t.substring(1):t},"function"!=typeof(n=window).CustomEvent&&(s.prototype=n.Event.prototype,n.CustomEvent=s)},function(e,t,i){"use strict";t.__esModule=!0;var s=(n.prototype.newOption=function(e){return{id:e.id?e.id:String(Math.floor(1e8*Math.random())),value:e.value?e.value:"",text:e.text?e.text:"",innerHTML:e.innerHTML?e.innerHTML:"",selected:!!e.selected&&e.selected,display:void 0===e.display||e.display,disabled:!!e.disabled&&e.disabled,placeholder:!!e.placeholder&&e.placeholder,class:e.class?e.class:void 0,data:e.data?e.data:{},mandatory:!!e.mandatory&&e.mandatory}},n.prototype.add=function(e){this.data.push({id:String(Math.floor(1e8*Math.random())),value:e.value,text:e.text,innerHTML:"",selected:!1,display:!0,disabled:!1,placeholder:!1,class:void 0,mandatory:e.mandatory,data:{}})},n.prototype.parseSelectData=function(){this.data=[];for(var e=0,t=this.main.select.element.childNodes;e<t.length;e++){var i=t[e];if("OPTGROUP"===i.nodeName){for(var s={label:i.label,options:[]},n=0,a=i.childNodes;n<a.length;n++){var o=a[n];if("OPTION"===o.nodeName){var l=this.pullOptionData(o);s.options.push(l),l.placeholder&&""!==l.text.trim()&&(this.main.config.placeholderText=l.text)}}this.data.push(s)}else"OPTION"===i.nodeName&&(l=this.pullOptionData(i),this.data.push(l),l.placeholder&&""!==l.text.trim()&&(this.main.config.placeholderText=l.text))}},n.prototype.pullOptionData=function(e){return{id:!!e.dataset&&e.dataset.id||String(Math.floor(1e8*Math.random())),value:e.value,text:e.text,innerHTML:e.innerHTML,selected:e.selected,disabled:e.disabled,placeholder:"true"===e.dataset.placeholder,class:e.className,style:e.style.cssText,data:e.dataset,mandatory:!!e.dataset&&"true"===e.dataset.mandatory}},n.prototype.setSelectedFromSelect=function(){if(this.main.config.isMultiple){for(var e=[],t=0,i=this.main.select.element.options;t<i.length;t++){var s=i[t];if(s.selected){var n=this.getObjectFromData(s.value,"value");n&&n.id&&e.push(n.id)}}this.setSelected(e,"id")}else{var a=this.main.select.element;if(-1!==a.selectedIndex){var o=a.options[a.selectedIndex].value;this.setSelected(o,"value")}}},n.prototype.setSelected=function(e,t){void 0===t&&(t="id");for(var i=0,s=this.data;i<s.length;i++){var n=s[i];if(n.hasOwnProperty("label")){if(n.hasOwnProperty("options")){var a=n.options;if(a)for(var o=0,l=a;o<l.length;o++){var r=l[o];r.placeholder||(r.selected=this.shouldBeSelected(r,e,t))}}}else n.selected=this.shouldBeSelected(n,e,t)}},n.prototype.shouldBeSelected=function(e,t,i){if(void 0===i&&(i="id"),Array.isArray(t))for(var s=0,n=t;s<n.length;s++){var a=n[s];if(i in e&&String(e[i])===String(a))return!0}else if(i in e&&String(e[i])===String(t))return!0;return!1},n.prototype.getSelected=function(){for(var e={text:"",placeholder:this.main.config.placeholderText},t=[],i=0,s=this.data;i<s.length;i++){var n=s[i];if(n.hasOwnProperty("label")){if(n.hasOwnProperty("options")){var a=n.options;if(a)for(var o=0,l=a;o<l.length;o++){var r=l[o];r.selected&&(this.main.config.isMultiple?t.push(r):e=r)}}}else n.selected&&(this.main.config.isMultiple?t.push(n):e=n)}return this.main.config.isMultiple?t:e},n.prototype.addToSelected=function(e,t){if(void 0===t&&(t="id"),this.main.config.isMultiple){var i=[],s=this.getSelected();if(Array.isArray(s))for(var n=0,a=s;n<a.length;n++){var o=a[n];i.push(o[t])}i.push(e),this.setSelected(i,t)}},n.prototype.removeFromSelected=function(e,t){if(void 0===t&&(t="id"),this.main.config.isMultiple){for(var i=[],s=0,n=this.getSelected();s<n.length;s++){var a=n[s];String(a[t])!==String(e)&&i.push(a[t])}this.setSelected(i,t)}},n.prototype.onDataChange=function(){this.main.onChange&&this.isOnChangeEnabled&&this.main.onChange(JSON.parse(JSON.stringify(this.getSelected())))},n.prototype.getObjectFromData=function(e,t){void 0===t&&(t="id");for(var i=0,s=this.data;i<s.length;i++){var n=s[i];if(t in n&&String(n[t])===String(e))return n;if(n.hasOwnProperty("options")&&n.options)for(var a=0,o=n.options;a<o.length;a++){var l=o[a];if(String(l[t])===String(e))return l}}return null},n.prototype.search=function(e){if(""!==(this.searchValue=e).trim()){var t=this.main.config.searchFilter,i=this.data.slice(0);e=e.trim();var s=i.map(function(i){if(i.hasOwnProperty("options")){var s=i,n=[];if(s.options&&(n=s.options.filter(function(i){return t(i,e)})),0!==n.length){var a=Object.assign({},s);return a.options=n,a}}return i.hasOwnProperty("text")&&t(i,e)?i:null});this.filtered=s.filter(function(e){return e})}else this.filtered=null},n);function n(e){this.contentOpen=!1,this.contentPosition="below",this.isOnChangeEnabled=!0,this.main=e.main,this.searchValue="",this.data=[],this.filtered=null,this.parseSelectData(),this.setSelectedFromSelect()}function a(e){return void 0!==e.text||(console.error("Data object option must have at least have a text value. Check object: "+JSON.stringify(e)),!1)}t.Data=s,t.validateData=function(e){if(!e)return console.error("Data must be an array of objects"),!1;for(var t=0,i=0,s=e;i<s.length;i++){var n=s[i];if(n.hasOwnProperty("label")){if(n.hasOwnProperty("options")){var o=n.options;if(o)for(var l=0,r=o;l<r.length;l++)a(r[l])||t++}}else a(n)||t++}return 0===t},t.validateOption=a},function(e,t,i){"use strict";t.__esModule=!0;var s=i(3),n=i(4),a=i(5),o=i(1),l=i(0),r=(c.prototype.validate=function(e){var t="string"==typeof e.select?document.querySelector(e.select):e.select;if(!t)throw new Error("Could not find select element");if("SELECT"!==t.tagName)throw new Error("Element isnt of type select");return t},c.prototype.selected=function(){if(this.config.isMultiple){for(var e=[],t=0,i=n=this.data.getSelected();t<i.length;t++){var s=i[t];e.push(s.value)}return e}var n;return(n=this.data.getSelected())?n.value:""},c.prototype.set=function(e,t,i,s){void 0===t&&(t="value"),void 0===i&&(i=!0),void 0===s&&(s=!0),this.config.isMultiple&&!Array.isArray(e)?this.data.addToSelected(e,t):this.data.setSelected(e,t),this.select.setValue(),this.data.onDataChange(),this.render(),i&&this.close()},c.prototype.setSelected=function(e,t,i,s){void 0===t&&(t="value"),void 0===i&&(i=!0),void 0===s&&(s=!0),this.set(e,t,i,s)},c.prototype.setData=function(e){if(o.validateData(e)){for(var t=JSON.parse(JSON.stringify(e)),i=this.data.getSelected(),s=0;s<t.length;s++)t[s].value||t[s].placeholder||(t[s].value=t[s].text);if(this.config.isAjax&&i)if(this.config.isMultiple)for(var n=0,a=i.reverse();n<a.length;n++){var l=a[n];t.unshift(l)}else{for(t.unshift(i),s=0;s<t.length;s++)t[s].placeholder||t[s].value!==i.value||t[s].text!==i.text||delete t[s];var r=!1;for(s=0;s<t.length;s++)t[s].placeholder&&(r=!0);r||t.unshift({text:"",placeholder:!0})}this.select.create(t),this.data.parseSelectData(),this.data.setSelectedFromSelect()}else console.error("Validation problem on: #"+this.select.element.id)},c.prototype.addData=function(e){o.validateData([e])?(this.data.add(this.data.newOption(e)),this.select.create(this.data.data),this.data.parseSelectData(),this.data.setSelectedFromSelect(),this.render()):console.error("Validation problem on: #"+this.select.element.id)},c.prototype.open=function(){var e=this;if(this.config.isEnabled&&!this.data.contentOpen){if(this.beforeOpen&&this.beforeOpen(),this.config.isMultiple&&this.slim.multiSelected?this.slim.multiSelected.plus.classList.add("ss-cross"):this.slim.singleSelected&&(this.slim.singleSelected.arrowIcon.arrow.classList.remove("arrow-down"),this.slim.singleSelected.arrowIcon.arrow.classList.add("arrow-up")),this.slim[this.config.isMultiple?"multiSelected":"singleSelected"].container.classList.add("above"===this.data.contentPosition?this.config.openAbove:this.config.openBelow),this.config.addToBody){var t=this.slim.container.getBoundingClientRect();this.slim.content.style.top=t.top+t.height+window.scrollY+"px",this.slim.content.style.left=t.left+window.scrollX+"px",this.slim.content.style.width=t.width+"px"}if(this.slim.content.classList.add(this.config.open),"up"===this.config.showContent.toLowerCase()||"down"!==this.config.showContent.toLowerCase()&&"above"===l.putContent(this.slim.content,this.data.contentPosition,this.data.contentOpen)?this.moveContentAbove():this.moveContentBelow(),!this.config.isMultiple){var i=this.data.getSelected();if(i){var s=i.id,n=this.slim.list.querySelector('[data-id="'+s+'"]');n&&l.ensureElementInView(this.slim.list,n)}}setTimeout(function(){e.data.contentOpen=!0,e.config.searchFocus&&e.slim.search.input.focus(),e.afterOpen&&e.afterOpen()},this.config.timeoutDelay)}},c.prototype.close=function(){var e=this;this.data.contentOpen&&(this.beforeClose&&this.beforeClose(),this.config.isMultiple&&this.slim.multiSelected?(this.slim.multiSelected.container.classList.remove(this.config.openAbove),this.slim.multiSelected.container.classList.remove(this.config.openBelow),this.slim.multiSelected.plus.classList.remove("ss-cross")):this.slim.singleSelected&&(this.slim.singleSelected.container.classList.remove(this.config.openAbove),this.slim.singleSelected.container.classList.remove(this.config.openBelow),this.slim.singleSelected.arrowIcon.arrow.classList.add("arrow-down"),this.slim.singleSelected.arrowIcon.arrow.classList.remove("arrow-up")),this.slim.content.classList.remove(this.config.open),this.data.contentOpen=!1,this.search(""),setTimeout(function(){e.slim.content.removeAttribute("style"),e.data.contentPosition="below",e.config.isMultiple&&e.slim.multiSelected?(e.slim.multiSelected.container.classList.remove(e.config.openAbove),e.slim.multiSelected.container.classList.remove(e.config.openBelow)):e.slim.singleSelected&&(e.slim.singleSelected.container.classList.remove(e.config.openAbove),e.slim.singleSelected.container.classList.remove(e.config.openBelow)),e.slim.search.input.blur(),e.afterClose&&e.afterClose()},this.config.timeoutDelay))},c.prototype.moveContentAbove=function(){var e=0;this.config.isMultiple&&this.slim.multiSelected?e=this.slim.multiSelected.container.offsetHeight:this.slim.singleSelected&&(e=this.slim.singleSelected.container.offsetHeight);var t=e+this.slim.content.offsetHeight-1;this.slim.content.style.margin="-"+t+"px 0 0 0",this.slim.content.style.height=t-e+1+"px",this.slim.content.style.transformOrigin="center bottom",this.data.contentPosition="above",this.config.isMultiple&&this.slim.multiSelected?(this.slim.multiSelected.container.classList.remove(this.config.openBelow),this.slim.multiSelected.container.classList.add(this.config.openAbove)):this.slim.singleSelected&&(this.slim.singleSelected.container.classList.remove(this.config.openBelow),this.slim.singleSelected.container.classList.add(this.config.openAbove))},c.prototype.moveContentBelow=function(){this.data.contentPosition="below",this.config.isMultiple&&this.slim.multiSelected?(this.slim.multiSelected.container.classList.remove(this.config.openAbove),this.slim.multiSelected.container.classList.add(this.config.openBelow)):this.slim.singleSelected&&(this.slim.singleSelected.container.classList.remove(this.config.openAbove),this.slim.singleSelected.container.classList.add(this.config.openBelow))},c.prototype.enable=function(){this.config.isEnabled=!0,this.config.isMultiple&&this.slim.multiSelected?this.slim.multiSelected.container.classList.remove(this.config.disabled):this.slim.singleSelected&&this.slim.singleSelected.container.classList.remove(this.config.disabled),this.select.triggerMutationObserver=!1,this.select.element.disabled=!1,this.slim.search.input.disabled=!1,this.select.triggerMutationObserver=!0},c.prototype.disable=function(){this.config.isEnabled=!1,this.config.isMultiple&&this.slim.multiSelected?this.slim.multiSelected.container.classList.add(this.config.disabled):this.slim.singleSelected&&this.slim.singleSelected.container.classList.add(this.config.disabled),this.select.triggerMutationObserver=!1,this.select.element.disabled=!0,this.slim.search.input.disabled=!0,this.select.triggerMutationObserver=!0},c.prototype.search=function(e){if(this.data.searchValue!==e)if(this.slim.search.input.value=e,this.config.isAjax){var t=this;this.config.isSearching=!0,this.render(),this.ajax&&this.ajax(e,function(i){t.config.isSearching=!1,Array.isArray(i)?(i.unshift({text:"",placeholder:!0}),t.setData(i),t.data.search(e),t.render()):"string"==typeof i?t.slim.options(i):t.render()})}else this.data.search(e),this.render()},c.prototype.setSearchText=function(e){this.config.searchText=e},c.prototype.render=function(){this.config.isMultiple?this.slim.values():(this.slim.placeholder(),this.slim.deselect()),this.slim.options()},c.prototype.destroy=function(e){void 0===e&&(e=null);var t=e?document.querySelector("."+e+".ss-main"):this.slim.container,i=e?document.querySelector("[data-ssid="+e+"]"):this.select.element;if(t&&i&&(document.removeEventListener("click",this.documentClick),"auto"===this.config.showContent&&window.removeEventListener("scroll",this.windowScroll,!1),i.style.display="",delete i.dataset.ssid,i.slim=null,t.parentElement&&t.parentElement.removeChild(t),this.config.addToBody)){var s=e?document.querySelector("."+e+".ss-content"):this.slim.content;if(!s)return;document.body.removeChild(s)}},c);function c(e){var t=this;this.ajax=null,this.addable=null,this.beforeOnChange=null,this.onChange=null,this.beforeOpen=null,this.afterOpen=null,this.beforeClose=null,this.afterClose=null,this.windowScroll=l.debounce(function(e){t.data.contentOpen&&("above"===l.putContent(t.slim.content,t.data.contentPosition,t.data.contentOpen)?t.moveContentAbove():t.moveContentBelow())}),this.documentClick=function(e){e.target&&!l.hasClassInTree(e.target,t.config.id)&&t.close()};var i=this.validate(e);i.dataset.ssid&&this.destroy(i.dataset.ssid),e.ajax&&(this.ajax=e.ajax),e.addable&&(this.addable=e.addable),this.config=new s.Config({select:i,isAjax:!!e.ajax,showSearch:e.showSearch,searchPlaceholder:e.searchPlaceholder,searchText:e.searchText,searchingText:e.searchingText,searchFocus:e.searchFocus,searchHighlight:e.searchHighlight,searchFilter:e.searchFilter,closeOnSelect:e.closeOnSelect,showContent:e.showContent,placeholderText:e.placeholder,allowDeselect:e.allowDeselect,allowDeselectOption:e.allowDeselectOption,hideSelectedOption:e.hideSelectedOption,deselectLabel:e.deselectLabel,isEnabled:e.isEnabled,valuesUseText:e.valuesUseText,showOptionTooltips:e.showOptionTooltips,selectByGroup:e.selectByGroup,limit:e.limit,timeoutDelay:e.timeoutDelay,addToBody:e.addToBody}),this.select=new n.Select({select:i,main:this}),this.data=new o.Data({main:this}),this.slim=new a.Slim({main:this}),this.select.element.parentNode&&this.select.element.parentNode.insertBefore(this.slim.container,this.select.element.nextSibling),e.data?this.setData(e.data):this.render(),document.addEventListener("click",this.documentClick),"auto"===this.config.showContent&&window.addEventListener("scroll",this.windowScroll,!1),e.beforeOnChange&&(this.beforeOnChange=e.beforeOnChange),e.onChange&&(this.onChange=e.onChange),e.beforeOpen&&(this.beforeOpen=e.beforeOpen),e.afterOpen&&(this.afterOpen=e.afterOpen),e.beforeClose&&(this.beforeClose=e.beforeClose),e.afterClose&&(this.afterClose=e.afterClose),this.config.isEnabled||this.disable()}t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var s=(n.prototype.searchFilter=function(e,t){return-1!==e.text.toLowerCase().indexOf(t.toLowerCase())},n);function n(e){this.id="",this.isMultiple=!1,this.isAjax=!1,this.isSearching=!1,this.showSearch=!0,this.searchFocus=!0,this.searchHighlight=!1,this.closeOnSelect=!0,this.showContent="auto",this.searchPlaceholder="Search",this.searchText="No Results",this.searchingText="Searching...",this.placeholderText="Select Value",this.allowDeselect=!1,this.allowDeselectOption=!1,this.hideSelectedOption=!1,this.deselectLabel="x",this.isEnabled=!0,this.valuesUseText=!1,this.showOptionTooltips=!1,this.selectByGroup=!1,this.limit=0,this.timeoutDelay=200,this.addToBody=!1,this.main="ss-main",this.singleSelected="ss-single-selected",this.arrow="ss-arrow",this.multiSelected="ss-multi-selected",this.add="ss-add",this.plus="ss-plus",this.values="ss-values",this.value="ss-value",this.valueText="ss-value-text",this.valueDelete="ss-value-delete",this.content="ss-content",this.open="ss-open",this.openAbove="ss-open-above",this.openBelow="ss-open-below",this.search="ss-search",this.searchHighlighter="ss-search-highlight",this.addable="ss-addable",this.list="ss-list",this.optgroup="ss-optgroup",this.optgroupLabel="ss-optgroup-label",this.optgroupLabelSelectable="ss-optgroup-label-selectable",this.option="ss-option",this.optionSelected="ss-option-selected",this.highlighted="ss-highlighted",this.disabled="ss-disabled",this.hide="ss-hide",this.id="ss-"+Math.floor(1e5*Math.random()),this.style=e.select.style.cssText,this.class=e.select.className.split(" "),this.isMultiple=e.select.multiple,this.isAjax=e.isAjax,this.showSearch=!1!==e.showSearch,this.searchFocus=!1!==e.searchFocus,this.searchHighlight=!0===e.searchHighlight,this.closeOnSelect=!1!==e.closeOnSelect,e.showContent&&(this.showContent=e.showContent),this.isEnabled=!1!==e.isEnabled,e.searchPlaceholder&&(this.searchPlaceholder=e.searchPlaceholder),e.searchText&&(this.searchText=e.searchText),e.searchingText&&(this.searchingText=e.searchingText),e.placeholderText&&(this.placeholderText=e.placeholderText),this.allowDeselect=!0===e.allowDeselect,this.allowDeselectOption=!0===e.allowDeselectOption,this.hideSelectedOption=!0===e.hideSelectedOption,e.deselectLabel&&(this.deselectLabel=e.deselectLabel),e.valuesUseText&&(this.valuesUseText=e.valuesUseText),e.showOptionTooltips&&(this.showOptionTooltips=e.showOptionTooltips),e.selectByGroup&&(this.selectByGroup=e.selectByGroup),e.limit&&(this.limit=e.limit),e.searchFilter&&(this.searchFilter=e.searchFilter),null!=e.timeoutDelay&&(this.timeoutDelay=e.timeoutDelay),this.addToBody=!0===e.addToBody}t.Config=s},function(e,t,i){"use strict";t.__esModule=!0;var s=i(0),n=(a.prototype.setValue=function(){if(this.main.data.getSelected()){if(this.main.config.isMultiple)for(var e=this.main.data.getSelected(),t=0,i=this.element.options;t<i.length;t++){var s=i[t];s.selected=!1;for(var n=0,a=e;n<a.length;n++)a[n].value===s.value&&(s.selected=!0)}else e=this.main.data.getSelected(),this.element.value=e?e.value:"";this.main.data.isOnChangeEnabled=!1,this.element.dispatchEvent(new CustomEvent("change",{bubbles:!0})),this.main.data.isOnChangeEnabled=!0}},a.prototype.addAttributes=function(){this.element.tabIndex=-1,this.element.style.display="none",this.element.dataset.ssid=this.main.config.id},a.prototype.addEventListeners=function(){var e=this;this.element.addEventListener("change",function(t){e.main.data.setSelectedFromSelect(),e.main.render()})},a.prototype.addMutationObserver=function(){var e=this;this.main.config.isAjax||(this.mutationObserver=new MutationObserver(function(t){e.triggerMutationObserver&&(e.main.data.parseSelectData(),e.main.data.setSelectedFromSelect(),e.main.render(),t.forEach(function(t){"class"===t.attributeName&&e.main.slim.updateContainerDivClass(e.main.slim.container)}))}),this.observeMutationObserver())},a.prototype.observeMutationObserver=function(){this.mutationObserver&&this.mutationObserver.observe(this.element,{attributes:!0,childList:!0,characterData:!0})},a.prototype.disconnectMutationObserver=function(){this.mutationObserver&&this.mutationObserver.disconnect()},a.prototype.create=function(e){this.element.innerHTML="";for(var t=0,i=e;t<i.length;t++){var s=i[t];if(s.hasOwnProperty("options")){var n=s,a=document.createElement("optgroup");if(a.label=n.label,n.options)for(var o=0,l=n.options;o<l.length;o++){var r=l[o];a.appendChild(this.createOption(r))}this.element.appendChild(a)}else this.element.appendChild(this.createOption(s))}},a.prototype.createOption=function(e){var t=document.createElement("option");return t.value=""!==e.value?e.value:e.text,t.innerHTML=e.innerHTML||e.text,e.selected&&(t.selected=e.selected),!1===e.display&&(t.style.display="none"),e.disabled&&(t.disabled=!0),e.placeholder&&t.setAttribute("data-placeholder","true"),e.mandatory&&t.setAttribute("data-mandatory","true"),e.class&&e.class.split(" ").forEach(function(e){t.classList.add(e)}),e.data&&"object"==typeof e.data&&Object.keys(e.data).forEach(function(i){t.setAttribute("data-"+s.kebabCase(i),e.data[i])}),t},a);function a(e){this.triggerMutationObserver=!0,this.element=e.select,this.main=e.main,this.element.disabled&&(this.main.config.isEnabled=!1),this.addAttributes(),this.addEventListeners(),this.mutationObserver=null,this.addMutationObserver(),this.element.slim=e.main}t.Select=n},function(e,t,i){"use strict";t.__esModule=!0;var s=i(0),n=i(1),a=(o.prototype.containerDiv=function(){var e=document.createElement("div");return e.style.cssText=this.main.config.style,this.updateContainerDivClass(e),e},o.prototype.updateContainerDivClass=function(e){this.main.config.class=this.main.select.element.className.split(" "),e.className="",e.classList.add(this.main.config.id),e.classList.add(this.main.config.main);for(var t=0,i=this.main.config.class;t<i.length;t++){var s=i[t];""!==s.trim()&&e.classList.add(s)}},o.prototype.singleSelectedDiv=function(){var e=this,t=document.createElement("div");t.classList.add(this.main.config.singleSelected);var i=document.createElement("span");i.classList.add("placeholder"),t.appendChild(i);var s=document.createElement("span");s.innerHTML=this.main.config.deselectLabel,s.classList.add("ss-deselect"),s.onclick=function(t){t.stopPropagation(),e.main.config.isEnabled&&e.main.set("")},t.appendChild(s);var n=document.createElement("span");n.classList.add(this.main.config.arrow);var a=document.createElement("span");return a.classList.add("arrow-down"),n.appendChild(a),t.appendChild(n),t.onclick=function(){e.main.config.isEnabled&&(e.main.data.contentOpen?e.main.close():e.main.open())},{container:t,placeholder:i,deselect:s,arrowIcon:{container:n,arrow:a}}},o.prototype.placeholder=function(){var e=this.main.data.getSelected();if(null===e||e&&e.placeholder){var t=document.createElement("span");t.classList.add(this.main.config.disabled),t.innerHTML=this.main.config.placeholderText,this.singleSelected&&(this.singleSelected.placeholder.innerHTML=t.outerHTML)}else{var i="";e&&(i=e.innerHTML&&!0!==this.main.config.valuesUseText?e.innerHTML:e.text),this.singleSelected&&(this.singleSelected.placeholder.innerHTML=e?i:"")}},o.prototype.deselect=function(){if(this.singleSelected){if(!this.main.config.allowDeselect)return void this.singleSelected.deselect.classList.add("ss-hide");""===this.main.selected()?this.singleSelected.deselect.classList.add("ss-hide"):this.singleSelected.deselect.classList.remove("ss-hide")}},o.prototype.multiSelectedDiv=function(){var e=this,t=document.createElement("div");t.classList.add(this.main.config.multiSelected);var i=document.createElement("div");i.classList.add(this.main.config.values),t.appendChild(i);var s=document.createElement("div");s.classList.add(this.main.config.add);var n=document.createElement("span");return n.classList.add(this.main.config.plus),n.onclick=function(t){e.main.data.contentOpen&&(e.main.close(),t.stopPropagation())},s.appendChild(n),t.appendChild(s),t.onclick=function(t){e.main.config.isEnabled&&(t.target.classList.contains(e.main.config.valueDelete)||(e.main.data.contentOpen?e.main.close():e.main.open()))},{container:t,values:i,add:s,plus:n}},o.prototype.values=function(){if(this.multiSelected){for(var e,t=this.multiSelected.values.childNodes,i=this.main.data.getSelected(),s=[],n=0,a=t;n<a.length;n++){var o=a[n];e=!0;for(var l=0,r=i;l<r.length;l++){var c=r[l];String(c.id)===String(o.dataset.id)&&(e=!1)}e&&s.push(o)}for(var d=0,h=s;d<h.length;d++){var u=h[d];u.classList.add("ss-out"),this.multiSelected.values.removeChild(u)}for(t=this.multiSelected.values.childNodes,c=0;c<i.length;c++){e=!1;for(var p=0,m=t;p<m.length;p++)o=m[p],String(i[c].id)===String(o.dataset.id)&&(e=!0);e||(0!==t.length&&HTMLElement.prototype.insertAdjacentElement?0===c?this.multiSelected.values.insertBefore(this.valueDiv(i[c]),t[c]):t[c-1].insertAdjacentElement("afterend",this.valueDiv(i[c])):this.multiSelected.values.appendChild(this.valueDiv(i[c])))}if(0===i.length){var f=document.createElement("span");f.classList.add(this.main.config.disabled),f.innerHTML=this.main.config.placeholderText,this.multiSelected.values.innerHTML=f.outerHTML}}},o.prototype.valueDiv=function(e){var t=this,i=document.createElement("div");i.classList.add(this.main.config.value),i.dataset.id=e.id;var s=document.createElement("span");if(s.classList.add(this.main.config.valueText),s.innerHTML=e.innerHTML&&!0!==this.main.config.valuesUseText?e.innerHTML:e.text,i.appendChild(s),!e.mandatory){var n=document.createElement("span");n.classList.add(this.main.config.valueDelete),n.innerHTML=this.main.config.deselectLabel,n.onclick=function(i){i.preventDefault(),i.stopPropagation();var s=!1;if(t.main.beforeOnChange||(s=!0),t.main.beforeOnChange){for(var n=t.main.data.getSelected(),a=JSON.parse(JSON.stringify(n)),o=0;o<a.length;o++)a[o].id===e.id&&a.splice(o,1);!1!==t.main.beforeOnChange(a)&&(s=!0)}s&&(t.main.data.removeFromSelected(e.id,"id"),t.main.render(),t.main.select.setValue(),t.main.data.onDataChange())},i.appendChild(n)}return i},o.prototype.contentDiv=function(){var e=document.createElement("div");return e.classList.add(this.main.config.content),e},o.prototype.searchDiv=function(){var e=this,t=document.createElement("div"),i=document.createElement("input"),s=document.createElement("div");t.classList.add(this.main.config.search);var a={container:t,input:i};return this.main.config.showSearch||(t.classList.add(this.main.config.hide),i.readOnly=!0),i.type="search",i.placeholder=this.main.config.searchPlaceholder,i.tabIndex=0,i.setAttribute("aria-label",this.main.config.searchPlaceholder),i.setAttribute("autocapitalize","off"),i.setAttribute("autocomplete","off"),i.setAttribute("autocorrect","off"),i.onclick=function(t){setTimeout(function(){""===t.target.value&&e.main.search("")},10)},i.onkeydown=function(t){"ArrowUp"===t.key?(e.main.open(),e.highlightUp(),t.preventDefault()):"ArrowDown"===t.key?(e.main.open(),e.highlightDown(),t.preventDefault()):"Tab"===t.key?e.main.data.contentOpen?e.main.close():setTimeout(function(){e.main.close()},e.main.config.timeoutDelay):"Enter"===t.key&&t.preventDefault()},i.onkeyup=function(t){var n=t.target;if("Enter"===t.key){if(e.main.addable&&t.ctrlKey)return s.click(),t.preventDefault(),void t.stopPropagation();var a=e.list.querySelector("."+e.main.config.highlighted);a&&a.click()}else"ArrowUp"===t.key||"ArrowDown"===t.key||("Escape"===t.key?e.main.close():e.main.config.showSearch&&e.main.data.contentOpen?e.main.search(n.value):i.value="");t.preventDefault(),t.stopPropagation()},i.onfocus=function(){e.main.open()},t.appendChild(i),this.main.addable&&(s.classList.add(this.main.config.addable),s.innerHTML="+",s.onclick=function(t){if(e.main.addable){t.preventDefault(),t.stopPropagation();var i=e.search.input.value;if(""===i.trim())return void e.search.input.focus();var s=e.main.addable(i),a="";if(!s)return;"object"==typeof s?n.validateOption(s)&&(e.main.addData(s),a=s.value?s.value:s.text):(e.main.addData(e.main.data.newOption({text:s,value:s})),a=s),e.main.search(""),setTimeout(function(){e.main.set(a,"value",!1,!1)},100),e.main.config.closeOnSelect&&setTimeout(function(){e.main.close()},100)}},t.appendChild(s),a.addable=s),a},o.prototype.highlightUp=function(){var e=this.list.querySelector("."+this.main.config.highlighted),t=null;if(e)for(t=e.previousSibling;null!==t&&t.classList.contains(this.main.config.disabled);)t=t.previousSibling;else{var i=this.list.querySelectorAll("."+this.main.config.option+":not(."+this.main.config.disabled+")");t=i[i.length-1]}if(t&&t.classList.contains(this.main.config.optgroupLabel)&&(t=null),null===t){var n=e.parentNode;if(n.classList.contains(this.main.config.optgroup)&&n.previousSibling){var a=n.previousSibling.querySelectorAll("."+this.main.config.option+":not(."+this.main.config.disabled+")");a.length&&(t=a[a.length-1])}}t&&(e&&e.classList.remove(this.main.config.highlighted),t.classList.add(this.main.config.highlighted),s.ensureElementInView(this.list,t))},o.prototype.highlightDown=function(){var e=this.list.querySelector("."+this.main.config.highlighted),t=null;if(e)for(t=e.nextSibling;null!==t&&t.classList.contains(this.main.config.disabled);)t=t.nextSibling;else t=this.list.querySelector("."+this.main.config.option+":not(."+this.main.config.disabled+")");if(null===t&&null!==e){var i=e.parentNode;i.classList.contains(this.main.config.optgroup)&&i.nextSibling&&(t=i.nextSibling.querySelector("."+this.main.config.option+":not(."+this.main.config.disabled+")"))}t&&(e&&e.classList.remove(this.main.config.highlighted),t.classList.add(this.main.config.highlighted),s.ensureElementInView(this.list,t))},o.prototype.listDiv=function(){var e=document.createElement("div");return e.classList.add(this.main.config.list),e},o.prototype.options=function(e){void 0===e&&(e="");var t,i=this.main.data.filtered||this.main.data.data;if((this.list.innerHTML="")!==e)return(t=document.createElement("div")).classList.add(this.main.config.option),t.classList.add(this.main.config.disabled),t.innerHTML=e,void this.list.appendChild(t);if(this.main.config.isAjax&&this.main.config.isSearching)return(t=document.createElement("div")).classList.add(this.main.config.option),t.classList.add(this.main.config.disabled),t.innerHTML=this.main.config.searchingText,void this.list.appendChild(t);if(0===i.length){var s=document.createElement("div");return s.classList.add(this.main.config.option),s.classList.add(this.main.config.disabled),s.innerHTML=this.main.config.searchText,void this.list.appendChild(s)}for(var n=function(e){if(e.hasOwnProperty("label")){var t=e,i=document.createElement("div");i.classList.add(a.main.config.optgroup);var s=document.createElement("div");s.classList.add(a.main.config.optgroupLabel),a.main.config.selectByGroup&&a.main.config.isMultiple&&s.classList.add(a.main.config.optgroupLabelSelectable),s.innerHTML=t.label,i.appendChild(s);var n=t.options;if(n){for(var o=0,l=n;o<l.length;o++){var r=l[o];i.appendChild(a.option(r))}if(a.main.config.selectByGroup&&a.main.config.isMultiple){var c=a;s.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();for(var t=0,s=i.children;t<s.length;t++){var n=s[t];-1!==n.className.indexOf(c.main.config.option)&&n.click()}})}}a.list.appendChild(i)}else a.list.appendChild(a.option(e))},a=this,o=0,l=i;o<l.length;o++)n(l[o])},o.prototype.option=function(e){if(e.placeholder){var t=document.createElement("div");return t.classList.add(this.main.config.option),t.classList.add(this.main.config.hide),t}var i=document.createElement("div");i.classList.add(this.main.config.option),e.class&&e.class.split(" ").forEach(function(e){i.classList.add(e)}),e.style&&(i.style.cssText=e.style);var n=this.main.data.getSelected();i.dataset.id=e.id,this.main.config.searchHighlight&&this.main.slim&&e.innerHTML&&""!==this.main.slim.search.input.value.trim()?i.innerHTML=s.highlight(e.innerHTML,this.main.slim.search.input.value,this.main.config.searchHighlighter):e.innerHTML&&(i.innerHTML=e.innerHTML),this.main.config.showOptionTooltips&&i.textContent&&i.setAttribute("title",i.textContent);var a=this;i.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var i=this.dataset.id;if(!0===e.selected&&a.main.config.allowDeselectOption){var s=!1;if(a.main.beforeOnChange&&a.main.config.isMultiple||(s=!0),a.main.beforeOnChange&&a.main.config.isMultiple){for(var o=a.main.data.getSelected(),l=JSON.parse(JSON.stringify(o)),r=0;r<l.length;r++)l[r].id===i&&l.splice(r,1);!1!==a.main.beforeOnChange(l)&&(s=!0)}s&&(a.main.config.isMultiple?(a.main.data.removeFromSelected(i,"id"),a.main.render(),a.main.select.setValue(),a.main.data.onDataChange()):a.main.set(""))}else{if(e.disabled||e.selected)return;if(a.main.config.limit&&Array.isArray(n)&&a.main.config.limit<=n.length)return;if(a.main.beforeOnChange){var c=void 0,d=JSON.parse(JSON.stringify(a.main.data.getObjectFromData(i)));d.selected=!0,a.main.config.isMultiple?(c=JSON.parse(JSON.stringify(n))).push(d):c=JSON.parse(JSON.stringify(d)),!1!==a.main.beforeOnChange(c)&&a.main.set(i,"id",a.main.config.closeOnSelect)}else a.main.set(i,"id",a.main.config.closeOnSelect)}});var o=n&&s.isValueInArrayOfObjects(n,"id",e.id);return(e.disabled||o)&&(i.onclick=null,a.main.config.allowDeselectOption||i.classList.add(this.main.config.disabled),a.main.config.hideSelectedOption&&i.classList.add(this.main.config.hide)),o?i.classList.add(this.main.config.optionSelected):i.classList.remove(this.main.config.optionSelected),i},o);function o(e){this.main=e.main,this.container=this.containerDiv(),this.content=this.contentDiv(),this.search=this.searchDiv(),this.list=this.listDiv(),this.options(),this.singleSelected=null,this.multiSelected=null,this.main.config.isMultiple?(this.multiSelected=this.multiSelectedDiv(),this.multiSelected&&this.container.appendChild(this.multiSelected.container)):(this.singleSelected=this.singleSelectedDiv(),this.container.appendChild(this.singleSelected.container)),this.main.config.addToBody?(this.content.classList.add(this.main.config.id),document.body.appendChild(this.content)):this.container.appendChild(this.content),this.content.appendChild(this.search.container),this.content.appendChild(this.list)}t.Slim=a}],e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)e.d(s,n,function(e){return t[e]}.bind(null,n));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=2).default;function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var t,i});
},{}],"JN7f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.URL=exports.API_KEY=void 0;const e="f205ff9551fdba7fe2c499379d3dfbc2";exports.API_KEY=e;const t="https://api.themoviedb.org";exports.URL=t;
},{}],"ye0o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fetchDataByID=exports.fetchTrending=exports.fetchSearch=exports.fetchGenre=exports.fetchDiscover=exports.fetchData=exports.fetchApi=void 0;var e=require("./consts.js");const t={page:1,genres:"",query:"",lang:"en",movieID:1,markupedMovies:[],async fetchData(t,a,r,...c){c=c.join("");try{const n=await fetch(`${e.URL}/3${t}${a}${r}?api_key=${e.API_KEY}${c}`);if(!n.ok)throw Error(n.statusText);return await n.json()}catch(s){console.log("error",s)}},async fetchDiscover(){let e=`&language=${t.lang}`;let r,c=`&page=${t.page}`;return r=""!==t.genres?`&with_genres=${t.genres}`:"",(await a("/discover","/movie","",e,c,r,"")).results},async fetchGenre(){let e=`&language=${t.lang}`;return(await t.fetchData("/genre","/movie","/list",e)).genres},async fetchSearch(){let e=`&language=${t.lang}`,r=`&page=${t.page}`,c=`&query=${t.query}`;return(await a("/search","/movie","",e,r,c)).results},async fetchTrending(){let e=`&language=${t.lang}`,r=`&page=${t.page}`;return(await a("/trending","/movie","/day",e,r)).results},async fetchDataByID(){const e=`/${t.movieID}`;let r=`&language=${t.lang}`;return await a("","/movie",e,r)}};exports.fetchApi=t;let{fetchData:a,fetchDiscover:r,fetchGenre:c,fetchSearch:s,fetchTrending:n,fetchDataByID:o}=t;exports.fetchDataByID=o,exports.fetchTrending=n,exports.fetchSearch=s,exports.fetchGenre=c,exports.fetchDiscover=r,exports.fetchData=a;
},{"./consts.js":"JN7f"}],"pAws":[function(require,module,exports) {
var define;
var global = arguments[3];
var e,t=arguments[3];!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof e&&e.amd?e([],r):"object"==typeof exports?exports.Handlebars=r():t.Handlebars=r()}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){"use strict";var n=r(1).default,o=r(2).default;t.__esModule=!0;var a=n(r(3)),i=o(r(36)),u=o(r(5)),l=n(r(4)),s=n(r(37)),c=o(r(43));function f(){var e=new a.HandlebarsEnvironment;return l.extend(e,a),e.SafeString=i.default,e.Exception=u.default,e.Utils=l,e.escapeExpression=l.escapeExpression,e.VM=s,e.template=function(t){return s.template(t,e)},e}var p=f();p.create=f,c.default(p),p.default=p,t.default=p,e.exports=t.default},function(e,t){"use strict";t.default=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},t.__esModule=!0},function(e,t){"use strict";t.default=function(e){return e&&e.__esModule?e:{default:e}},t.__esModule=!0},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0,t.HandlebarsEnvironment=c;var o=r(4),a=n(r(5)),i=r(9),u=r(29),l=n(r(31)),s=r(32);t.VERSION="4.7.7";t.COMPILER_REVISION=8;t.LAST_COMPATIBLE_COMPILER_REVISION=7;t.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};function c(e,t,r){this.helpers=e||{},this.partials=t||{},this.decorators=r||{},i.registerDefaultHelpers(this),u.registerDefaultDecorators(this)}c.prototype={constructor:c,logger:l.default,log:l.default.log,registerHelper:function(e,t){if("[object Object]"===o.toString.call(e)){if(t)throw new a.default("Arg not supported with multiple helpers");o.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if("[object Object]"===o.toString.call(e))o.extend(this.partials,e);else{if(void 0===t)throw new a.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,t){if("[object Object]"===o.toString.call(e)){if(t)throw new a.default("Arg not supported with multiple decorators");o.extend(this.decorators,e)}else this.decorators[e]=t},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){s.resetLoggedProperties()}};var f=l.default.log;t.log=f,t.createFrame=o.createFrame,t.logger=l.default},function(e,t){"use strict";t.__esModule=!0,t.extend=i,t.indexOf=function(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1},t.escapeExpression=function(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}if(!o.test(e))return e;return e.replace(n,a)},t.isEmpty=function(e){return!e&&0!==e||!(!s(e)||0!==e.length)},t.createFrame=function(e){var t=i({},e);return t._parent=e,t},t.blockParams=function(e,t){return e.path=t,e},t.appendContextPath=function(e,t){return(e?e+".":"")+t};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},n=/[&<>"'`=]/g,o=/[&<>"'`=]/;function a(e){return r[e]}function i(e){for(var t=1;t<arguments.length;t++)for(var r in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],r)&&(e[r]=arguments[t][r]);return e}var u=Object.prototype.toString;t.toString=u;var l=function(e){return"function"==typeof e};l(/x/)&&(t.isFunction=l=function(e){return"function"==typeof e&&"[object Function]"===u.call(e)}),t.isFunction=l;var s=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===u.call(e)};t.isArray=s},function(e,t,r){"use strict";var n=r(6).default;t.__esModule=!0;var o=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function a(e,t){var r=t&&t.loc,i=void 0,u=void 0,l=void 0,s=void 0;r&&(i=r.start.line,u=r.end.line,l=r.start.column,s=r.end.column,e+=" - "+i+":"+l);for(var c=Error.prototype.constructor.call(this,e),f=0;f<o.length;f++)this[o[f]]=c[o[f]];Error.captureStackTrace&&Error.captureStackTrace(this,a);try{r&&(this.lineNumber=i,this.endLineNumber=u,n?(Object.defineProperty(this,"column",{value:l,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:s,enumerable:!0})):(this.column=l,this.endColumn=s))}catch(p){}}a.prototype=new Error,t.default=a,e.exports=t.default},function(e,t,r){e.exports={default:r(7),__esModule:!0}},function(e,t,r){var n=r(8);e.exports=function(e,t,r){return n.setDesc(e,t,r)}},function(e,t){var r=Object;e.exports={create:r.create,getProto:r.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:r.getOwnPropertyDescriptor,setDesc:r.defineProperty,setDescs:r.defineProperties,getKeys:r.keys,getNames:r.getOwnPropertyNames,getSymbols:r.getOwnPropertySymbols,each:[].forEach}},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0,t.registerDefaultHelpers=function(e){o.default(e),a.default(e),i.default(e),u.default(e),l.default(e),s.default(e),c.default(e)},t.moveHelperToHooks=function(e,t,r){e.helpers[t]&&(e.hooks[t]=e.helpers[t],r||delete e.helpers[t])};var o=n(r(10)),a=n(r(11)),i=n(r(24)),u=n(r(25)),l=n(r(26)),s=n(r(27)),c=n(r(28))},function(e,t,r){"use strict";t.__esModule=!0;var n=r(4);t.default=function(e){e.registerHelper("blockHelperMissing",function(t,r){var o=r.inverse,a=r.fn;if(!0===t)return a(this);if(!1===t||null==t)return o(this);if(n.isArray(t))return t.length>0?(r.ids&&(r.ids=[r.name]),e.helpers.each(t,r)):o(this);if(r.data&&r.ids){var i=n.createFrame(r.data);i.contextPath=n.appendContextPath(r.data.contextPath,r.name),r={data:i}}return a(t,r)})},e.exports=t.default},function(e,t,r){(function(n){"use strict";var o=r(12).default,a=r(2).default;t.__esModule=!0;var i=r(4),u=a(r(5));t.default=function(e){e.registerHelper("each",function(e,t){if(!t)throw new u.default("Must pass iterator to #each");var r,a=t.fn,l=t.inverse,s=0,c="",f=void 0,p=void 0;function d(t,r,n){f&&(f.key=t,f.index=r,f.first=0===r,f.last=!!n,p&&(f.contextPath=p+t)),c+=a(e[t],{data:f,blockParams:i.blockParams([e[t],t],[p+t,null])})}if(t.data&&t.ids&&(p=i.appendContextPath(t.data.contextPath,t.ids[0])+"."),i.isFunction(e)&&(e=e.call(this)),t.data&&(f=i.createFrame(t.data)),e&&"object"==typeof e)if(i.isArray(e))for(var h=e.length;s<h;s++)s in e&&d(s,s,s===e.length-1);else if(n.Symbol&&e[n.Symbol.iterator]){for(var v=[],m=e[n.Symbol.iterator](),g=m.next();!g.done;g=m.next())v.push(g.value);for(h=(e=v).length;s<h;s++)d(s,s,s===e.length-1)}else r=void 0,o(e).forEach(function(e){void 0!==r&&d(r,s-1),r=e,s++}),void 0!==r&&d(r,s-1,!0);return 0===s&&(c=l(this)),c})},e.exports=t.default}).call(t,function(){return this}())},function(e,t,r){e.exports={default:r(13),__esModule:!0}},function(e,t,r){r(14),e.exports=r(20).Object.keys},function(e,t,r){var n=r(15);r(17)("keys",function(e){return function(t){return e(n(t))}})},function(e,t,r){var n=r(16);e.exports=function(e){return Object(n(e))}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(18),o=r(20),a=r(23);e.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],i={};i[e]=t(r),n(n.S+n.F*a(function(){r(1)}),"Object",i)}},function(e,t,r){var n=r(19),o=r(20),a=r(21),i=function(e,t,r){var u,l,s,c=e&i.F,f=e&i.G,p=e&i.S,d=e&i.P,h=e&i.B,v=e&i.W,m=f?o:o[t]||(o[t]={}),g=f?n:p?n[t]:(n[t]||{}).prototype;for(u in f&&(r=t),r)(l=!c&&g&&u in g)&&u in m||(s=l?g[u]:r[u],m[u]=f&&"function"!=typeof g[u]?r[u]:h&&l?a(s,n):v&&g[u]==s?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t.prototype=e.prototype,t}(s):d&&"function"==typeof s?a(Function.call,s):s,d&&((m.prototype||(m.prototype={}))[u]=s))};i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,e.exports=i},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t){var r=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=r)},function(e,t,r){var n=r(22);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0;var o=n(r(5));t.default=function(e){e.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},e.exports=t.default},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0;var o=r(4),a=n(r(5));t.default=function(e){e.registerHelper("if",function(e,t){if(2!=arguments.length)throw new a.default("#if requires exactly one argument");return o.isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||o.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,r){if(2!=arguments.length)throw new a.default("#unless requires exactly one argument");return e.helpers.if.call(this,t,{fn:r.inverse,inverse:r.fn,hash:r.hash})})},e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("log",function(){for(var t=[void 0],r=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)t.push(arguments[n]);var o=1;null!=r.hash.level?o=r.hash.level:r.data&&null!=r.data.level&&(o=r.data.level),t[0]=o,e.log.apply(e,t)})},e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("lookup",function(e,t,r){return e?r.lookupProperty(e,t):e})},e.exports=t.default},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0;var o=r(4),a=n(r(5));t.default=function(e){e.registerHelper("with",function(e,t){if(2!=arguments.length)throw new a.default("#with requires exactly one argument");o.isFunction(e)&&(e=e.call(this));var r=t.fn;if(o.isEmpty(e))return t.inverse(this);var n=t.data;return t.data&&t.ids&&((n=o.createFrame(t.data)).contextPath=o.appendContextPath(t.data.contextPath,t.ids[0])),r(e,{data:n,blockParams:o.blockParams([e],[n&&n.contextPath])})})},e.exports=t.default},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0,t.registerDefaultDecorators=function(e){o.default(e)};var o=n(r(30))},function(e,t,r){"use strict";t.__esModule=!0;var n=r(4);t.default=function(e){e.registerDecorator("inline",function(e,t,r,o){var a=e;return t.partials||(t.partials={},a=function(o,a){var i=r.partials;r.partials=n.extend({},i,t.partials);var u=e(o,a);return r.partials=i,u}),t.partials[o.args[0]]=o.fn,a})},e.exports=t.default},function(e,t,r){"use strict";t.__esModule=!0;var n=r(4),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if("string"==typeof e){var t=n.indexOf(o.methodMap,e.toLowerCase());e=t>=0?t:parseInt(e,10)}return e},log:function(e){if(e=o.lookupLevel(e),"undefined"!=typeof console&&o.lookupLevel(o.level)<=e){var t=o.methodMap[e];console[t]||(t="log");for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];console[t].apply(console,n)}}};t.default=o,e.exports=t.default},function(e,t,r){"use strict";var n=r(33).default,o=r(12).default,a=r(1).default;t.__esModule=!0,t.createProtoAccessControl=function(e){var t=n(null);t.constructor=!1,t.__defineGetter__=!1,t.__defineSetter__=!1,t.__lookupGetter__=!1;var r=n(null);return r.__proto__=!1,{properties:{whitelist:i.createNewLookupObject(r,e.allowedProtoProperties),defaultValue:e.allowProtoPropertiesByDefault},methods:{whitelist:i.createNewLookupObject(t,e.allowedProtoMethods),defaultValue:e.allowProtoMethodsByDefault}}},t.resultIsAllowed=function(e,t,r){return s("function"==typeof e?t.methods:t.properties,r)},t.resetLoggedProperties=function(){o(l).forEach(function(e){delete l[e]})};var i=r(35),u=a(r(31)),l=n(null);function s(e,t){return void 0!==e.whitelist[t]?!0===e.whitelist[t]:void 0!==e.defaultValue?e.defaultValue:(function(e){!0!==l[e]&&(l[e]=!0,u.log("error",'Handlebars: Access has been denied to resolve the property "'+e+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(t),!1)}},function(e,t,r){e.exports={default:r(34),__esModule:!0}},function(e,t,r){var n=r(8);e.exports=function(e,t){return n.create(e,t)}},function(e,t,r){"use strict";var n=r(33).default;t.__esModule=!0,t.createNewLookupObject=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.extend.apply(void 0,[n(null)].concat(t))};var o=r(4)},function(e,t){"use strict";function r(e){this.string=e}t.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},t.default=r,e.exports=t.default},function(e,t,r){"use strict";var n=r(38).default,o=r(12).default,a=r(1).default,i=r(2).default;t.__esModule=!0,t.checkRevision=function(e){var t=e&&e[0]||1,r=s.COMPILER_REVISION;if(t>=s.LAST_COMPATIBLE_COMPILER_REVISION&&t<=s.COMPILER_REVISION)return;if(t<s.LAST_COMPATIBLE_COMPILER_REVISION){var n=s.REVISION_CHANGES[r],o=s.REVISION_CHANGES[t];throw new l.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new l.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")},t.template=function(e,t){if(!t)throw new l.default("No environment passed to template");if(!e||!e.main)throw new l.default("Unknown template object: "+typeof e);e.main.decorator=e.main_d,t.VM.checkRevision(e.compiler);var r=e.compiler&&7===e.compiler[0];var a={strict:function(e,t,r){if(!(e&&t in e))throw new l.default('"'+t+'" not defined in '+e,{loc:r});return a.lookupProperty(e,t)},lookupProperty:function(e,t){var r=e[t];return null==r?r:Object.prototype.hasOwnProperty.call(e,t)?r:p.resultIsAllowed(r,a.protoAccessControl,t)?r:void 0},lookup:function(e,t){for(var r=e.length,n=0;n<r;n++){var o=e[n]&&a.lookupProperty(e[n],t);if(null!=o)return e[n][t]}},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:u.escapeExpression,invokePartial:function(r,n,o){o.hash&&(n=u.extend({},n,o.hash),o.ids&&(o.ids[0]=!0));r=t.VM.resolvePartial.call(this,r,n,o);var a=u.extend({},o,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),i=t.VM.invokePartial.call(this,r,n,a);null==i&&t.compile&&(o.partials[o.name]=t.compile(r,e.compilerOptions,t),i=o.partials[o.name](n,a));if(null!=i){if(o.indent){for(var s=i.split("\n"),c=0,f=s.length;c<f&&(s[c]||c+1!==f);c++)s[c]=o.indent+s[c];i=s.join("\n")}return i}throw new l.default("The partial "+o.name+" could not be compiled when running in runtime-only mode")},fn:function(t){var r=e[t];return r.decorator=e[t+"_d"],r},programs:[],program:function(e,t,r,n,o){var a=this.programs[e],i=this.fn(e);return t||o||n||r?a=d(this,e,i,t,r,n,o):a||(a=this.programs[e]=d(this,e,i)),a},data:function(e,t){for(;e&&t--;)e=e._parent;return e},mergeIfNeeded:function(e,t){var r=e||t;return e&&t&&e!==t&&(r=u.extend({},t,e)),r},nullContext:n({}),noop:t.VM.noop,compilerInfo:e.compiler};function i(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=r.data;i._setup(r),!r.partial&&e.useData&&(n=function(e,t){t&&"root"in t||((t=t?s.createFrame(t):{}).root=e);return t}(t,n));var o=void 0,u=e.useBlockParams?[]:void 0;function l(t){return""+e.main(a,t,a.helpers,a.partials,n,u,o)}return e.useDepths&&(o=r.depths?t!=r.depths[0]?[t].concat(r.depths):r.depths:[t]),(l=v(e.main,l,a,r.depths||[],n,u))(t,r)}return i.isTop=!0,i._setup=function(n){if(n.partial)a.protoAccessControl=n.protoAccessControl,a.helpers=n.helpers,a.partials=n.partials,a.decorators=n.decorators,a.hooks=n.hooks;else{var i=u.extend({},t.helpers,n.helpers);!function(e,t){o(e).forEach(function(r){var n=e[r];e[r]=function(e,t){var r=t.lookupProperty;return f.wrapHelper(e,function(e){return u.extend({lookupProperty:r},e)})}(n,t)})}(i,a),a.helpers=i,e.usePartial&&(a.partials=a.mergeIfNeeded(n.partials,t.partials)),(e.usePartial||e.useDecorators)&&(a.decorators=u.extend({},t.decorators,n.decorators)),a.hooks={},a.protoAccessControl=p.createProtoAccessControl(n);var l=n.allowCallsToHelperMissing||r;c.moveHelperToHooks(a,"helperMissing",l),c.moveHelperToHooks(a,"blockHelperMissing",l)}},i._child=function(t,r,n,o){if(e.useBlockParams&&!n)throw new l.default("must pass block params");if(e.useDepths&&!o)throw new l.default("must pass parent depths");return d(a,t,e[t],r,0,n,o)},i},t.wrapProgram=d,t.resolvePartial=function(e,t,r){e?e.call||r.name||(r.name=e,e=r.partials[e]):e="@partial-block"===r.name?r.data["partial-block"]:r.partials[r.name];return e},t.invokePartial=function(e,t,r){var n=r.data&&r.data["partial-block"];r.partial=!0,r.ids&&(r.data.contextPath=r.ids[0]||r.data.contextPath);var o=void 0;r.fn&&r.fn!==h&&function(){r.data=s.createFrame(r.data);var e=r.fn;o=r.data["partial-block"]=function(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.data=s.createFrame(r.data),r.data["partial-block"]=n,e(t,r)},e.partials&&(r.partials=u.extend({},r.partials,e.partials))}();void 0===e&&o&&(e=o);if(void 0===e)throw new l.default("The partial "+r.name+" could not be found");if(e instanceof Function)return e(t,r)},t.noop=h;var u=a(r(4)),l=i(r(5)),s=r(3),c=r(9),f=r(42),p=r(32);function d(e,t,r,n,o,a,i){function u(t){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],u=i;return!i||t==i[0]||t===e.nullContext&&null===i[0]||(u=[t].concat(i)),r(e,t,e.helpers,e.partials,o.data||n,a&&[o.blockParams].concat(a),u)}return(u=v(r,u,e,i,n,a)).program=t,u.depth=i?i.length:0,u.blockParams=o||0,u}function h(){return""}function v(e,t,r,n,o,a){if(e.decorator){var i={};t=e.decorator(t,i,r,n&&n[0],o,a,n),u.extend(t,i)}return t}},function(e,t,r){e.exports={default:r(39),__esModule:!0}},function(e,t,r){r(40),e.exports=r(20).Object.seal},function(e,t,r){var n=r(41);r(17)("seal",function(e){return function(t){return e&&n(t)?e(t):t}})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){"use strict";t.__esModule=!0,t.wrapHelper=function(e,t){if("function"!=typeof e)return e;return function(){var r=arguments[arguments.length-1];return arguments[arguments.length-1]=t(r),e.apply(this,arguments)}}},function(e,t){(function(r){"use strict";t.__esModule=!0,t.default=function(e){var t=void 0!==r?r:window,n=t.Handlebars;e.noConflict=function(){return t.Handlebars===e&&(t.Handlebars=n),e}},e.exports=t.default}).call(t,function(){return this}())}])});
},{}],"fFoL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var l=e(require("handlebars/dist/handlebars.runtime"));function e(l){return l&&l.__esModule?l:{default:l}}const n=l.default.template({1:function(l,e,n,a,t){var o,r=null!=e?e:l.nullContext||{},s=l.hooks.helperMissing,i="function",c=l.escapeExpression,u=l.lookupProperty||function(l,e){if(Object.prototype.hasOwnProperty.call(l,e))return l[e]};return"  <li class='gallery__item gallery-js' id='"+c(typeof(o=null!=(o=u(n,"id")||(null!=e?u(e,"id"):e))?o:s)===i?o.call(r,{name:"id",hash:{},data:t,loc:{start:{line:2,column:43},end:{line:2,column:49}}}):o)+"'>\n    <a class='gallery__link link link-js' href='#/'>\n      <div class='gallery__thumb-image'>\n        <img\n          class='gallery__image'\n          src='https://image.tmdb.org/t/p/w500"+c(typeof(o=null!=(o=u(n,"poster_path")||(null!=e?u(e,"poster_path"):e))?o:s)===i?o.call(r,{name:"poster_path",hash:{},data:t,loc:{start:{line:7,column:46},end:{line:7,column:61}}}):o)+"'\n          alt='No poster for movie "+c(typeof(o=null!=(o=u(n,"title")||(null!=e?u(e,"title"):e))?o:s)===i?o.call(r,{name:"title",hash:{},data:t,loc:{start:{line:8,column:35},end:{line:8,column:44}}}):o)+"'\n        />\n      </div>\n      <div class='gallery__title-wrap'>\n        <h2 class='gallery__title'> "+c(typeof(o=null!=(o=u(n,"title")||(null!=e?u(e,"title"):e))?o:s)===i?o.call(r,{name:"title",hash:{},data:t,loc:{start:{line:12,column:36},end:{line:12,column:45}}}):o)+" </h2>\n        <p class='gallery__accent'><span class='gallery__genres'>\n            "+c(typeof(o=null!=(o=u(n,"genres")||(null!=e?u(e,"genres"):e))?o:s)===i?o.call(r,{name:"genres",hash:{},data:t,loc:{start:{line:14,column:12},end:{line:14,column:22}}}):o)+"\n          </span><span class='gallery__date'>|\n            "+c(typeof(o=null!=(o=u(n,"release_date")||(null!=e?u(e,"release_date"):e))?o:s)===i?o.call(r,{name:"release_date",hash:{},data:t,loc:{start:{line:16,column:12},end:{line:16,column:28}}}):o)+"\n          </span><span class='vote vote--margin-left'>"+c(typeof(o=null!=(o=u(n,"vote_average")||(null!=e?u(e,"vote_average"):e))?o:s)===i?o.call(r,{name:"vote_average",hash:{},data:t,loc:{start:{line:17,column:54},end:{line:17,column:70}}}):o)+"</span>\n        </p>\n      </div>\n    </a>\n  </li>\n"},compiler:[8,">= 4.3.0"],main:function(l,e,n,a,t){var o;return null!=(o=(l.lookupProperty||function(l,e){if(Object.prototype.hasOwnProperty.call(l,e))return l[e]})(n,"each").call(null!=e?e:l.nullContext||{},e,{name:"each",hash:{},fn:l.program(1,t,0),inverse:l.noop,data:t,loc:{start:{line:1,column:0},end:{line:22,column:9}}}))?o:""},useData:!0});var a=n;exports.default=a;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"ZO32":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setGenresList=s,exports.filterMarkup=f,exports.filterSelect=void 0;var e=n(require("slim-select")),t=require("../fetch-api.js"),r=require("../container/mainMarkup"),a=n(require("../../templates/film-card.hbs")),i=n(require("../refs"));function n(e){return e&&e.__esModule?e:{default:e}}let l=new e.default({select:"#multiple",closeOnSelect:!1,placeholder:"Filter by genres",onChange:c});async function c(e){{t.fetchApi.page=1,i.default.gallery.innerHTML="",t.fetchApi.query="",t.fetchApi.markupedMovies=[];let a=e.map(e=>e.value);const n=await(0,t.fetchGenre)();let l=a.map(e=>n.find(t=>t.name===e).id);t.fetchApi.genres=l.join(","),""!==t.fetchApi.genres?f():""===t.fetchApi.query&&(t.fetchApi.page=1,(0,r.mainMarkup)())}}async function s(){let e=(await(0,t.fetchGenre)()).map(e=>(e.text=e.name,delete e.id,delete e.name,e));l.setData(e)}async function f(){document.querySelector(".header-form__form").reset(),i.default.gallery.insertAdjacentHTML("beforeend",(0,a.default)(await(0,r.addGenresToData)(await(0,t.fetchDiscover)())))}exports.filterSelect=l,s();
},{"slim-select":"a5Nu","../fetch-api.js":"ye0o","../container/mainMarkup":"u2ZQ","../../templates/film-card.hbs":"fFoL","../refs":"VyiV"}],"XwMB":[function(require,module,exports) {
!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={overlayBackgroundColor:"#666666",overlayOpacity:.6,spinnerIcon:"ball-circus",spinnerColor:"#000",spinnerSize:"3x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetY:0,offsetX:0,lockScroll:!1,containerID:null,spinnerZIndex:99999,overlayZIndex:99998},this.stylesheetBaseURL="https://cdn.jsdelivr.net/npm/load-awesome@1.1.0/css/",this.spinner=null,this.spinnerStylesheetURL=null,this.numberOfEmptyDivForSpinner={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":1,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1}}var t,o;return t=e,(o=[{key:"show",value:function(e){this.setOptions(e),this.addSpinnerStylesheet(),this.generateSpinnerElement(),this.options.lockScroll&&(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),this.generateAndAddOverlayElement()}},{key:"hide",value:function(){this.options.lockScroll&&(document.body.style.overflow="",document.documentElement.style.overflow="");var e=document.getElementById("loading-overlay-stylesheet");e&&(e.disabled=!0,e.parentNode.removeChild(e),document.getElementById(this.options.overlayIDName).remove(),document.getElementById(this.options.spinnerIDName).remove())}},{key:"setOptions",value:function(e){if(void 0!==e)for(var t in e)this.options[t]=e[t]}},{key:"generateAndAddOverlayElement",value:function(){var e="50%";0!==this.options.offsetX&&(e="calc(50% + "+this.options.offsetX+")");var t="50%";if(0!==this.options.offsetY&&(t="calc(50% + "+this.options.offsetY+")"),this.options.containerID&&document.body.contains(document.getElementById(this.options.containerID))){var n='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: absolute; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,'; z-index: 50; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: absolute; top: ').concat(t,"; left: ").concat(e,'; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: 9999;">').concat(this.spinner,"</div>"),o=document.getElementById(this.options.containerID);return o.style.position="relative",void o.insertAdjacentHTML("beforeend",n)}var i='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: fixed; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,"; z-index: ").concat(this.options.overlayZIndex,'; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: fixed; top: ').concat(t,"; left: ").concat(e,"; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: ").concat(this.options.spinnerZIndex,';">').concat(this.spinner,"</div>");document.body.insertAdjacentHTML("beforeend",i)}},{key:"generateSpinnerElement",value:function(){var e=this,t=Object.keys(this.numberOfEmptyDivForSpinner).find(function(t){return t===e.options.spinnerIcon}),n=this.generateEmptyDivElement(this.numberOfEmptyDivForSpinner[t]);this.spinner='<div style="color: '.concat(this.options.spinnerColor,'" class="la-').concat(this.options.spinnerIcon," la-").concat(this.options.spinnerSize,'">').concat(n,"</div>")}},{key:"addSpinnerStylesheet",value:function(){this.setSpinnerStylesheetURL();var e=document.createElement("link");e.setAttribute("id","loading-overlay-stylesheet"),e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",this.spinnerStylesheetURL),document.getElementsByTagName("head")[0].appendChild(e)}},{key:"setSpinnerStylesheetURL",value:function(){this.spinnerStylesheetURL=this.stylesheetBaseURL+this.options.spinnerIcon+".min.css"}},{key:"generateEmptyDivElement",value:function(e){for(var t="",n=1;n<=e;n++)t+="<div></div>";return t}}])&&n(t.prototype,o),e}();window.JsLoadingOverlay=new o,e.exports=JsLoadingOverlay}]);
},{}],"PZFh":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3],e="Expected a function",n=NaN,r="[object Symbol]",i=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,f=/^0o[0-7]+$/i,c=parseInt,a="object"==typeof t&&t&&t.Object===Object&&t,s="object"==typeof self&&self&&self.Object===Object&&self,v=a||s||Function("return this")(),l=Object.prototype,p=l.toString,b=Math.max,m=Math.min,y=function(){return v.Date.now()};function d(t,n,r){var i,o,u,f,c,a,s=0,v=!1,l=!1,p=!0;if("function"!=typeof t)throw new TypeError(e);function d(e){var n=i,r=o;return i=o=void 0,s=e,f=t.apply(r,n)}function g(t){var e=t-a;return void 0===a||e>=n||e<0||l&&t-s>=u}function O(){var t=y();if(g(t))return x(t);c=setTimeout(O,function(t){var e=n-(t-a);return l?m(e,u-(t-s)):e}(t))}function x(t){return c=void 0,p&&i?d(t):(i=o=void 0,f)}function T(){var t=y(),e=g(t);if(i=arguments,o=this,a=t,e){if(void 0===c)return function(t){return s=t,c=setTimeout(O,n),v?d(t):f}(a);if(l)return c=setTimeout(O,n),d(a)}return void 0===c&&(c=setTimeout(O,n)),f}return n=h(n)||0,j(r)&&(v=!!r.leading,u=(l="maxWait"in r)?b(h(r.maxWait)||0,n):u,p="trailing"in r?!!r.trailing:p),T.cancel=function(){void 0!==c&&clearTimeout(c),s=0,i=a=o=c=void 0},T.flush=function(){return void 0===c?f:x(y())},T}function j(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){return!!t&&"object"==typeof t}function O(t){return"symbol"==typeof t||g(t)&&p.call(t)==r}function h(t){if("number"==typeof t)return t;if(O(t))return n;if(j(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=j(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var r=u.test(t);return r||f.test(t)?c(t.slice(2),r?2:8):o.test(t)?n:+t}module.exports=d;
},{}],"ja4j":[function(require,module,exports) {
var define;
var global = arguments[3];
var t,e=arguments[3];!function(e,i){"function"==typeof t&&t.amd?t([],function(){return i(e)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=i(e):e.Notiflix=i(e)}(void 0===e?"undefined"==typeof window?this:window:e,function(t){"use strict";if(void 0===t&&void 0===t.document)return!1;var e,i,a,n,o,r="\n\nVisit documentation page to learn more: https://notiflix.github.io/documentation",s='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif',l={wrapID:"NotiflixNotifyWrap",overlayID:"NotiflixNotifyOverlay",width:"280px",position:"right-top",distance:"10px",opacity:1,borderRadius:"5px",rtl:!1,timeout:3e3,messageMaxLength:110,backOverlay:!1,backOverlayColor:"rgba(0,0,0,0.5)",plainText:!0,showOnlyTheLastOne:!1,clickToClose:!1,pauseOnHover:!0,ID:"NotiflixNotify",className:"notiflix-notify",zindex:4001,fontFamily:"Quicksand",fontSize:"13px",cssAnimation:!0,cssAnimationDuration:400,cssAnimationStyle:"fade",closeButton:!1,useIcon:!0,useFontAwesome:!1,fontAwesomeIconStyle:"basic",fontAwesomeIconSize:"34px",success:{background:"#32c682",textColor:"#fff",childClassName:"notiflix-notify-success",notiflixIconColor:"rgba(0,0,0,0.2)",fontAwesomeClassName:"fas fa-check-circle",fontAwesomeIconColor:"rgba(0,0,0,0.2)",backOverlayColor:"rgba(50,198,130,0.2)"},failure:{background:"#ff5549",textColor:"#fff",childClassName:"notiflix-notify-failure",notiflixIconColor:"rgba(0,0,0,0.2)",fontAwesomeClassName:"fas fa-times-circle",fontAwesomeIconColor:"rgba(0,0,0,0.2)",backOverlayColor:"rgba(255,85,73,0.2)"},warning:{background:"#eebf31",textColor:"#fff",childClassName:"notiflix-notify-warning",notiflixIconColor:"rgba(0,0,0,0.2)",fontAwesomeClassName:"fas fa-exclamation-circle",fontAwesomeIconColor:"rgba(0,0,0,0.2)",backOverlayColor:"rgba(238,191,49,0.2)"},info:{background:"#26c0d3",textColor:"#fff",childClassName:"notiflix-notify-info",notiflixIconColor:"rgba(0,0,0,0.2)",fontAwesomeClassName:"fas fa-info-circle",fontAwesomeIconColor:"rgba(0,0,0,0.2)",backOverlayColor:"rgba(38,192,211,0.2)"}},c={ID:"NotiflixReportWrap",className:"notiflix-report",width:"320px",backgroundColor:"#f8f8f8",borderRadius:"25px",rtl:!1,zindex:4002,backOverlay:!0,backOverlayColor:"rgba(0,0,0,0.5)",fontFamily:"Quicksand",svgSize:"110px",plainText:!0,titleFontSize:"16px",titleMaxLength:34,messageFontSize:"13px",messageMaxLength:400,buttonFontSize:"14px",buttonMaxLength:34,cssAnimation:!0,cssAnimationDuration:360,cssAnimationStyle:"fade",success:{svgColor:"#32c682",titleColor:"#1e1e1e",messageColor:"#242424",buttonBackground:"#32c682",buttonColor:"#fff",backOverlayColor:"rgba(50,198,130,0.2)"},failure:{svgColor:"#ff5549",titleColor:"#1e1e1e",messageColor:"#242424",buttonBackground:"#ff5549",buttonColor:"#fff",backOverlayColor:"rgba(255,85,73,0.2)"},warning:{svgColor:"#eebf31",titleColor:"#1e1e1e",messageColor:"#242424",buttonBackground:"#eebf31",buttonColor:"#fff",backOverlayColor:"rgba(238,191,49,0.2)"},info:{svgColor:"#26c0d3",titleColor:"#1e1e1e",messageColor:"#242424",buttonBackground:"#26c0d3",buttonColor:"#fff",backOverlayColor:"rgba(38,192,211,0.2)"}},m={ID:"NotiflixConfirmWrap",className:"notiflix-confirm",width:"300px",zindex:4003,position:"center",distance:"10px",backgroundColor:"#f8f8f8",borderRadius:"25px",backOverlay:!0,backOverlayColor:"rgba(0,0,0,0.5)",rtl:!1,fontFamily:"Quicksand",cssAnimation:!0,cssAnimationDuration:300,cssAnimationStyle:"fade",plainText:!0,titleColor:"#32c682",titleFontSize:"16px",titleMaxLength:34,messageColor:"#1e1e1e",messageFontSize:"14px",messageMaxLength:110,buttonsFontSize:"15px",buttonsMaxLength:34,okButtonColor:"#f8f8f8",okButtonBackground:"#32c682",cancelButtonColor:"#f8f8f8",cancelButtonBackground:"#a9a9a9"},f={ID:"NotiflixLoadingWrap",className:"notiflix-loading",zindex:4e3,backgroundColor:"rgba(0,0,0,0.8)",rtl:!1,fontFamily:"Quicksand",cssAnimation:!0,cssAnimationDuration:400,clickToClose:!1,customSvgUrl:null,svgSize:"80px",svgColor:"#32c682",messageID:"NotiflixLoadingMessage",messageFontSize:"15px",messageMaxLength:34,messageColor:"#dcdcdc"},p={ID:"NotiflixBlockWrap",querySelectorLimit:200,className:"notiflix-block",position:"absolute",zindex:1e3,backgroundColor:"rgba(255,255,255,0.9)",rtl:!1,fontFamily:"Quicksand",cssAnimation:!0,cssAnimationDuration:300,svgSize:"45px",svgColor:"#383838",messageFontSize:"14px",messageMaxLength:34,messageColor:"#383838"},x=function(t){return console.error("%c Notiflix Error ","padding:2px;border-radius:20px;color:#fff;background:#ff5549","\n"+t+r)},d=function(t){return console.log("%c Notiflix Info ","padding:2px;border-radius:20px;color:#fff;background:#26c0d3","\n"+t+r)},u=function(e){return e||(e="head"),null!==t.document[e]||(x('\nNotiflix needs to be appended to the "<'+e+'>" element, but you called it before the "<'+e+'>" element has been created.'),!1)},b=function(e,i){if(!u("head"))return!1;if(null!==e()&&!t.document.getElementById(i)){var a=t.document.createElement("style");a.id=i,a.innerHTML=e(),t.document.head.appendChild(a)}},g=function(){var t={},e=!1,i=0;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],i++);for(var a=function(i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=e&&"[object Object]"===Object.prototype.toString.call(i[a])?g(t[a],i[a]):i[a])};i<arguments.length;i++)a(arguments[i]);return t},y=function(e){var i=t.document.createElement("div");return i.innerHTML=e,i.textContent||i.innerText||""},k=function(t,e){return t||(t="60px"),e||(e="#32c682"),'<svg xmlns="http://www.w3.org/2000/svg" stroke="'+e+'" width="'+t+'" height="'+t+'" transform="scale(.8)" viewBox="0 0 38 38"><g fill="none" fill-rule="evenodd" stroke-width="2" transform="translate(1 1)"><circle cx="18" cy="18" r="18" stroke-opacity=".25"/><path d="M36 18c0-9.94-8.06-18-18-18"><animateTransform attributeName="transform" dur="1s" from="0 18 18" repeatCount="indefinite" to="360 18 18" type="rotate"/></path></g></svg>'},w=function(t,e){return t||(t="60px"),e||(e="#32c682"),'<svg xmlns="http://www.w3.org/2000/svg" id="NXLoadingHourglass" fill="'+e+'" width="'+t+'" height="'+t+'" viewBox="0 0 200 200"><style>@-webkit-keyframes NXhourglass5-animation{0%{-webkit-transform:scale(1,1);transform:scale(1,1)}16.67%{-webkit-transform:scale(1,.8);transform:scale(1,.8)}33.33%{-webkit-transform:scale(.88,.6);transform:scale(.88,.6)}37.5%{-webkit-transform:scale(.85,.55);transform:scale(.85,.55)}41.67%{-webkit-transform:scale(.8,.5);transform:scale(.8,.5)}45.83%{-webkit-transform:scale(.75,.45);transform:scale(.75,.45)}50%{-webkit-transform:scale(.7,.4);transform:scale(.7,.4)}54.17%{-webkit-transform:scale(.6,.35);transform:scale(.6,.35)}58.33%{-webkit-transform:scale(.5,.3);transform:scale(.5,.3)}83.33%,to{-webkit-transform:scale(.2,0);transform:scale(.2,0)}}@keyframes NXhourglass5-animation{0%{-webkit-transform:scale(1,1);transform:scale(1,1)}16.67%{-webkit-transform:scale(1,.8);transform:scale(1,.8)}33.33%{-webkit-transform:scale(.88,.6);transform:scale(.88,.6)}37.5%{-webkit-transform:scale(.85,.55);transform:scale(.85,.55)}41.67%{-webkit-transform:scale(.8,.5);transform:scale(.8,.5)}45.83%{-webkit-transform:scale(.75,.45);transform:scale(.75,.45)}50%{-webkit-transform:scale(.7,.4);transform:scale(.7,.4)}54.17%{-webkit-transform:scale(.6,.35);transform:scale(.6,.35)}58.33%{-webkit-transform:scale(.5,.3);transform:scale(.5,.3)}83.33%,to{-webkit-transform:scale(.2,0);transform:scale(.2,0)}}@-webkit-keyframes NXhourglass3-animation{0%{-webkit-transform:scale(1,.02);transform:scale(1,.02)}79.17%,to{-webkit-transform:scale(1,1);transform:scale(1,1)}}@keyframes NXhourglass3-animation{0%{-webkit-transform:scale(1,.02);transform:scale(1,.02)}79.17%,to{-webkit-transform:scale(1,1);transform:scale(1,1)}}@-webkit-keyframes NXhourglass1-animation{0%,83.33%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}@keyframes NXhourglass1-animation{0%,83.33%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}#NXLoadingHourglass *{-webkit-animation-duration:1.2s;animation-duration:1.2s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:cubic-bezier(0,0,1,1);animation-timing-function:cubic-bezier(0,0,1,1)}</style><g data-animator-group="true" data-animator-type="1" style="-webkit-animation-name:NXhourglass1-animation;animation-name:NXhourglass1-animation;-webkit-transform-origin:50% 50%;transform-origin:50% 50%;transform-box:fill-box"><g id="NXhourglass2" fill="inherit"><g data-animator-group="true" data-animator-type="2" style="-webkit-animation-name:NXhourglass3-animation;animation-name:NXhourglass3-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1);-webkit-transform-origin:50% 100%;transform-origin:50% 100%;transform-box:fill-box" opacity=".4"><path id="NXhourglass4" d="M100 100l-34.38 32.08v31.14h68.76v-31.14z"/></g><g data-animator-group="true" data-animator-type="2" style="-webkit-animation-name:NXhourglass5-animation;animation-name:NXhourglass5-animation;-webkit-transform-origin:50% 100%;transform-origin:50% 100%;transform-box:fill-box" opacity=".4"><path id="NXhourglass6" d="M100 100L65.62 67.92V36.78h68.76v31.14z"/></g><path d="M51.14 38.89h8.33v14.93c0 15.1 8.29 28.99 23.34 39.1 1.88 1.25 3.04 3.97 3.04 7.08s-1.16 5.83-3.04 7.09c-15.05 10.1-23.34 23.99-23.34 39.09v14.93h-8.33a4.859 4.859 0 1 0 0 9.72h97.72a4.859 4.859 0 1 0 0-9.72h-8.33v-14.93c0-15.1-8.29-28.99-23.34-39.09-1.88-1.26-3.04-3.98-3.04-7.09s1.16-5.83 3.04-7.08c15.05-10.11 23.34-24 23.34-39.1V38.89h8.33a4.859 4.859 0 1 0 0-9.72H51.14a4.859 4.859 0 1 0 0 9.72zm79.67 14.93c0 15.87-11.93 26.25-19.04 31.03-4.6 3.08-7.34 8.75-7.34 15.15 0 6.41 2.74 12.07 7.34 15.15 7.11 4.78 19.04 15.16 19.04 31.03v14.93H69.19v-14.93c0-15.87 11.93-26.25 19.04-31.02 4.6-3.09 7.34-8.75 7.34-15.16 0-6.4-2.74-12.07-7.34-15.15-7.11-4.78-19.04-15.16-19.04-31.03V38.89h61.62v14.93z"/></g></g></svg>'},h=function(t,e){return t||(t="60px"),e||(e="#32c682"),'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+t+'" viewBox="25 25 50 50" style="-webkit-animation:rotate 2s linear infinite;animation:rotate 2s linear infinite;height:'+t+";-webkit-transform-origin:center center;-ms-transform-origin:center center;transform-origin:center center;width:"+t+';position:absolute;top:0;left:0;margin:auto"><style>@-webkit-keyframes rotate{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35}to{stroke-dasharray:89,200;stroke-dashoffset:-124}}@keyframes dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35}to{stroke-dasharray:89,200;stroke-dashoffset:-124}}</style><circle cx="50" cy="50" r="20" fill="none" stroke="'+e+'" stroke-width="2" style="-webkit-animation:dash 1.5s ease-in-out infinite,color 1.5s ease-in-out infinite;animation:dash 1.5s ease-in-out infinite,color 1.5s ease-in-out infinite" stroke-dasharray="150 200" stroke-dashoffset="-10" stroke-linecap="round"/></svg>'},v=function(t,e){return t||(t="60px"),e||(e="#32c682"),'<svg xmlns="http://www.w3.org/2000/svg" fill="'+e+'" width="'+t+'" height="'+t+'" viewBox="0 0 128 128"><g><path fill="inherit" d="M109.25 55.5h-36l12-12a29.54 29.54 0 0 0-49.53 12H18.75A46.04 46.04 0 0 1 96.9 31.84l12.35-12.34v36zm-90.5 17h36l-12 12a29.54 29.54 0 0 0 49.53-12h16.97A46.04 46.04 0 0 1 31.1 96.16L18.74 108.5v-36z"/><animateTransform attributeName="transform" dur="1.5s" from="0 64 64" repeatCount="indefinite" to="360 64 64" type="rotate"/></g></svg>'},N=function(t,e){return t||(t="60px"),e||(e="#32c682"),'<svg xmlns="http://www.w3.org/2000/svg" fill="'+e+'" width="'+t+'" height="'+t+'" viewBox="0 0 100 100"><g transform="translate(25 50)"><circle r="9" fill="inherit" transform="scale(.239)"><animateTransform attributeName="transform" begin="-0.266s" calcMode="spline" dur="0.8s" keySplines="0.3 0 0.7 1;0.3 0 0.7 1" keyTimes="0;0.5;1" repeatCount="indefinite" type="scale" values="0;1;0"/></circle></g><g transform="translate(50 50)"><circle r="9" fill="inherit" transform="scale(.00152)"><animateTransform attributeName="transform" begin="-0.133s" calcMode="spline" dur="0.8s" keySplines="0.3 0 0.7 1;0.3 0 0.7 1" keyTimes="0;0.5;1" repeatCount="indefinite" type="scale" values="0;1;0"/></circle></g><g transform="translate(75 50)"><circle r="9" fill="inherit" transform="scale(.299)"><animateTransform attributeName="transform" begin="0s" calcMode="spline" dur="0.8s" keySplines="0.3 0 0.7 1;0.3 0 0.7 1" keyTimes="0;0.5;1" repeatCount="indefinite" type="scale" values="0;1;0"/></circle></g></svg>'},z=function(t,e){return t||(t="60px"),e||(e="#32c682"),'<svg xmlns="http://www.w3.org/2000/svg" stroke="'+e+'" width="'+t+'" height="'+t+'" viewBox="0 0 44 44"><g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" calcMode="spline" dur="1.8s" keySplines="0.165, 0.84, 0.44, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 20"/><animate attributeName="stroke-opacity" begin="0s" calcMode="spline" dur="1.8s" keySplines="0.3, 0.61, 0.355, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 0"/></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" calcMode="spline" dur="1.8s" keySplines="0.165, 0.84, 0.44, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 20"/><animate attributeName="stroke-opacity" begin="-0.9s" calcMode="spline" dur="1.8s" keySplines="0.3, 0.61, 0.355, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 0"/></circle></g></svg>'},C=function(){return'[id^=NotiflixNotifyWrap]{pointer-events:none;position:fixed;z-index:4001;opacity:1;right:10px;top:10px;width:280px;max-width:96%;-webkit-box-sizing:border-box;box-sizing:border-box;background:transparent}[id^=NotiflixNotifyWrap].nx-flex-center-center{max-height:calc(100vh - 20px);overflow-x:hidden;overflow-y:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;margin:auto}[id^=NotiflixNotifyWrap]::-webkit-scrollbar{width:0;height:0}[id^=NotiflixNotifyWrap]::-webkit-scrollbar-thumb{background:transparent}[id^=NotiflixNotifyWrap]::-webkit-scrollbar-track{background:transparent}[id^=NotiflixNotifyWrap] *{-webkit-box-sizing:border-box;box-sizing:border-box}[id^=NotiflixNotifyOverlay]{-webkit-transition:background .3s ease-in-out;-o-transition:background .3s ease-in-out;transition:background .3s ease-in-out}[id^=NotiflixNotifyWrap]>div{pointer-events:all;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;width:100%;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;position:relative;margin:0 0 10px;border-radius:5px;background:#1e1e1e;color:#fff;padding:10px 12px;font-size:14px;line-height:1.4}[id^=NotiflixNotifyWrap]>div:last-child{margin:0}[id^=NotiflixNotifyWrap]>div.nx-with-callback{cursor:pointer}[id^=NotiflixNotifyWrap]>div.nx-with-icon{padding:8px;min-height:56px}[id^=NotiflixNotifyWrap]>div.nx-paused{cursor:auto}[id^=NotiflixNotifyWrap]>div.nx-click-to-close{cursor:pointer}[id^=NotiflixNotifyWrap]>div.nx-with-close-button{padding:10px 36px 10px 12px}[id^=NotiflixNotifyWrap]>div.nx-with-icon.nx-with-close-button{padding:6px 36px 6px 6px}[id^=NotiflixNotifyWrap]>div>span.nx-message{cursor:inherit;font-weight:normal;font-family:inherit!important;word-break:break-all;word-break:break-word}[id^=NotiflixNotifyWrap]>div>span.nx-close-button{cursor:pointer;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out;position:absolute;right:8px;top:0;bottom:0;margin:auto;color:inherit;width:20px;height:20px}[id^=NotiflixNotifyWrap]>div>span.nx-close-button:hover{-webkit-transform:rotate(90deg);transform:rotate(90deg)}[id^=NotiflixNotifyWrap]>div>span.nx-close-button>svg{position:absolute;width:16px;height:16px;right:2px;top:2px}[id^=NotiflixNotifyWrap]>div>.nx-message-icon{position:absolute;width:40px;height:40px;font-size:30px;line-height:40px;text-align:center;left:8px;top:0;bottom:0;margin:auto;border-radius:inherit}[id^=NotiflixNotifyWrap]>div>.nx-message-icon-fa.nx-message-icon-fa-shadow{color:inherit;background:rgba(0,0,0,.15);-webkit-box-shadow:inset 0 0 34px rgba(0,0,0,.2);box-shadow:inset 0 0 34px rgba(0,0,0,.2);text-shadow:0 0 10px rgba(0,0,0,.3)}[id^=NotiflixNotifyWrap]>div>span.nx-with-icon{position:relative;float:left;width:calc(100% - 40px);margin:0 0 0 40px;padding:0 0 0 10px;-webkit-box-sizing:border-box;box-sizing:border-box}[id^=NotiflixNotifyWrap]>div.nx-rtl-on>.nx-message-icon{left:auto;right:8px}[id^=NotiflixNotifyWrap]>div.nx-rtl-on>span.nx-with-icon{padding:0 10px 0 0;margin:0 40px 0 0}[id^=NotiflixNotifyWrap]>div.nx-rtl-on>span.nx-close-button{right:auto;left:8px}[id^=NotiflixNotifyWrap]>div.nx-with-icon.nx-with-close-button.nx-rtl-on{padding:6px 6px 6px 36px}[id^=NotiflixNotifyWrap]>div.nx-with-close-button.nx-rtl-on{padding:10px 12px 10px 36px}[id^=NotiflixNotifyOverlay].nx-with-animation,[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-fade{-webkit-animation:notify-animation-fade .3s ease-in-out 0s normal;animation:notify-animation-fade .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-fade{0%{opacity:0}100%{opacity:1}}@keyframes notify-animation-fade{0%{opacity:0}100%{opacity:1}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-zoom{-webkit-animation:notify-animation-zoom .3s ease-in-out 0s normal;animation:notify-animation-zoom .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-zoom{0%{-webkit-transform:scale(0);transform:scale(0)}50%{-webkit-transform:scale(1.05);transform:scale(1.05)}100%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes notify-animation-zoom{0%{-webkit-transform:scale(0);transform:scale(0)}50%{-webkit-transform:scale(1.05);transform:scale(1.05)}100%{-webkit-transform:scale(1);transform:scale(1)}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-right{-webkit-animation:notify-animation-from-right .3s ease-in-out 0s normal;animation:notify-animation-from-right .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-from-right{0%{right:-300px;opacity:0}50%{right:8px;opacity:1}100%{right:0;opacity:1}}@keyframes notify-animation-from-right{0%{right:-300px;opacity:0}50%{right:8px;opacity:1}100%{right:0;opacity:1}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-left{-webkit-animation:notify-animation-from-left .3s ease-in-out 0s normal;animation:notify-animation-from-left .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-from-left{0%{left:-300px;opacity:0}50%{left:8px;opacity:1}100%{left:0;opacity:1}}@keyframes notify-animation-from-left{0%{left:-300px;opacity:0}50%{left:8px;opacity:1}100%{left:0;opacity:1}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-top{-webkit-animation:notify-animation-from-top .3s ease-in-out 0s normal;animation:notify-animation-from-top .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-from-top{0%{top:-50px;opacity:0}50%{top:8px;opacity:1}100%{top:0;opacity:1}}@keyframes notify-animation-from-top{0%{top:-50px;opacity:0}50%{top:8px;opacity:1}100%{top:0;opacity:1}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-bottom{-webkit-animation:notify-animation-from-bottom .3s ease-in-out 0s normal;animation:notify-animation-from-bottom .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-from-bottom{0%{bottom:-50px;opacity:0}50%{bottom:8px;opacity:1}100%{bottom:0;opacity:1}}@keyframes notify-animation-from-bottom{0%{bottom:-50px;opacity:0}50%{bottom:8px;opacity:1}100%{bottom:0;opacity:1}}[id^=NotiflixNotifyOverlay].nx-with-animation.nx-remove,[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-fade.nx-remove{opacity:0;-webkit-animation:notify-remove-fade .3s ease-in-out 0s normal;animation:notify-remove-fade .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-fade{0%{opacity:1}100%{opacity:0}}@keyframes notify-remove-fade{0%{opacity:1}100%{opacity:0}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-zoom.nx-remove{-webkit-transform:scale(0);transform:scale(0);-webkit-animation:notify-remove-zoom .3s ease-in-out 0s normal;animation:notify-remove-zoom .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-zoom{0%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.05);transform:scale(1.05)}100%{-webkit-transform:scale(0);transform:scale(0)}}@keyframes notify-remove-zoom{0%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.05);transform:scale(1.05)}100%{-webkit-transform:scale(0);transform:scale(0)}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-top.nx-remove{opacity:0;-webkit-animation:notify-remove-to-top .3s ease-in-out 0s normal;animation:notify-remove-to-top .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-to-top{0%{top:0;opacity:1}50%{top:8px;opacity:1}100%{top:-50px;opacity:0}}@keyframes notify-remove-to-top{0%{top:0;opacity:1}50%{top:8px;opacity:1}100%{top:-50px;opacity:0}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-right.nx-remove{opacity:0;-webkit-animation:notify-remove-to-right .3s ease-in-out 0s normal;animation:notify-remove-to-right .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-to-right{0%{right:0;opacity:1}50%{right:8px;opacity:1}100%{right:-300px;opacity:0}}@keyframes notify-remove-to-right{0%{right:0;opacity:1}50%{right:8px;opacity:1}100%{right:-300px;opacity:0}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-bottom.nx-remove{opacity:0;-webkit-animation:notify-remove-to-bottom .3s ease-in-out 0s normal;animation:notify-remove-to-bottom .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-to-bottom{0%{bottom:0;opacity:1}50%{bottom:8px;opacity:1}100%{bottom:-50px;opacity:0}}@keyframes notify-remove-to-bottom{0%{bottom:0;opacity:1}50%{bottom:8px;opacity:1}100%{bottom:-50px;opacity:0}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-left.nx-remove{opacity:0;-webkit-animation:notify-remove-to-left .3s ease-in-out 0s normal;animation:notify-remove-to-left .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-to-left{0%{left:0;opacity:1}50%{left:8px;opacity:1}100%{left:-300px;opacity:0}}@keyframes notify-remove-to-left{0%{left:0;opacity:1}50%{left:8px;opacity:1}100%{left:-300px;opacity:0}}'},L=0,W=function(i,a,n,o){if(!u("body"))return!1;e||E.Notify.init({});var r=g(!0,e,{});if("object"==typeof a&&!Array.isArray(a)||"object"==typeof n&&!Array.isArray(n)){var c={};"object"==typeof a?c=a:"object"==typeof n&&(c=n),e=g(!0,e,c)}var m=e[o.toLocaleLowerCase("en")];L++,"string"!=typeof i&&(i="Notiflix "+o),e.plainText&&(i=y(i)),!e.plainText&&i.length>e.messageMaxLength&&(e=g(!0,e,{closeButton:!0,messageMaxLength:150}),i='Possible HTML Tags Error: The "plainText" option is "false" and the notification content length is more than the "messageMaxLength" option.'),i.length>e.messageMaxLength&&(i=i.substring(0,e.messageMaxLength)+"..."),"shadow"===e.fontAwesomeIconStyle&&(m.fontAwesomeIconColor=m.background),e.cssAnimation||(e.cssAnimationDuration=0);var f=t.document.getElementById(l.wrapID)||t.document.createElement("div");if(f.id=l.wrapID,f.style.width=e.width,f.style.zIndex=e.zindex,f.style.opacity=e.opacity,"center-center"===e.position?(f.style.left=e.distance,f.style.top=e.distance,f.style.right=e.distance,f.style.bottom=e.distance,f.style.margin="auto",f.classList.add("nx-flex-center-center"),f.style.maxHeight="calc((100vh - "+e.distance+") - "+e.distance+")",f.style.display="flex",f.style.flexWrap="wrap",f.style.flexDirection="column",f.style.justifyContent="center",f.style.alignItems="center",f.style.pointerEvents="none"):"center-top"===e.position?(f.style.left=e.distance,f.style.right=e.distance,f.style.top=e.distance,f.style.bottom="auto",f.style.margin="auto"):"center-bottom"===e.position?(f.style.left=e.distance,f.style.right=e.distance,f.style.bottom=e.distance,f.style.top="auto",f.style.margin="auto"):"right-bottom"===e.position?(f.style.right=e.distance,f.style.bottom=e.distance,f.style.top="auto",f.style.left="auto"):"left-top"===e.position?(f.style.left=e.distance,f.style.top=e.distance,f.style.right="auto",f.style.bottom="auto"):"left-bottom"===e.position?(f.style.left=e.distance,f.style.bottom=e.distance,f.style.top="auto",f.style.right="auto"):(f.style.right=e.distance,f.style.top=e.distance,f.style.left="auto",f.style.bottom="auto"),e.backOverlay){var p=t.document.getElementById(l.overlayID)||t.document.createElement("div");p.id=l.overlayID,p.style.width="100%",p.style.height="100%",p.style.position="fixed",p.style.zIndex=e.zindex-1,p.style.left=0,p.style.top=0,p.style.right=0,p.style.bottom=0,p.style.background=m.backOverlayColor||e.backOverlayColor,p.className=e.cssAnimation?"nx-with-animation":"",p.style.animationDuration=e.cssAnimation?e.cssAnimationDuration+"ms":"",t.document.getElementById(l.overlayID)||t.document.body.appendChild(p)}t.document.getElementById(l.wrapID)||t.document.body.appendChild(f);var x=t.document.createElement("div");x.id=e.ID+"-"+L,x.className=e.className+" "+m.childClassName+" "+(e.cssAnimation?"nx-with-animation":"")+" "+(e.useIcon?"nx-with-icon":"")+" nx-"+e.cssAnimationStyle+" "+(e.closeButton&&"function"!=typeof a?"nx-with-close-button":"")+" "+("function"==typeof a?"nx-with-callback":"")+" "+(e.clickToClose?"nx-click-to-close":""),x.style.fontSize=e.fontSize,x.style.color=m.textColor,x.style.background=m.background,x.style.borderRadius=e.borderRadius,x.style.pointerEvents="all",e.rtl&&(x.setAttribute("dir","rtl"),x.classList.add("nx-rtl-on")),x.style.fontFamily='"'+e.fontFamily+'", '+s,e.cssAnimation&&(x.style.animationDuration=e.cssAnimationDuration+"ms");var d="";if(e.closeButton&&"function"!=typeof a&&(d='<span class="nx-close-button"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g><path fill="'+m.notiflixIconColor+'" d="M0.38 2.19l7.8 7.81 -7.8 7.81c-0.51,0.5 -0.51,1.31 -0.01,1.81 0.25,0.25 0.57,0.38 0.91,0.38 0.34,0 0.67,-0.14 0.91,-0.38l7.81 -7.81 7.81 7.81c0.24,0.24 0.57,0.38 0.91,0.38 0.34,0 0.66,-0.14 0.9,-0.38 0.51,-0.5 0.51,-1.31 0,-1.81l-7.81 -7.81 7.81 -7.81c0.51,-0.5 0.51,-1.31 0,-1.82 -0.5,-0.5 -1.31,-0.5 -1.81,0l-7.81 7.81 -7.81 -7.81c-0.5,-0.5 -1.31,-0.5 -1.81,0 -0.51,0.51 -0.51,1.32 0,1.82z"/></g></svg></span>'),e.useIcon)if(e.useFontAwesome)x.innerHTML='<i style="color:'+m.fontAwesomeIconColor+"; font-size:"+e.fontAwesomeIconSize+';" class="nx-message-icon nx-message-icon-fa '+m.fontAwesomeClassName+" "+("shadow"===e.fontAwesomeIconStyle?"nx-message-icon-fa-shadow":"nx-message-icon-fa-basic")+'"></i><span class="nx-message nx-with-icon">'+i+"</span>"+(e.closeButton?d:"");else{var b="";"Success"===o?b='<svg class="nx-message-icon" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><g><path fill="'+m.notiflixIconColor+'" d="M20 0c11.03,0 20,8.97 20,20 0,11.03 -8.97,20 -20,20 -11.03,0 -20,-8.97 -20,-20 0,-11.03 8.97,-20 20,-20zm0 37.98c9.92,0 17.98,-8.06 17.98,-17.98 0,-9.92 -8.06,-17.98 -17.98,-17.98 -9.92,0 -17.98,8.06 -17.98,17.98 0,9.92 8.06,17.98 17.98,17.98zm-2.4 -13.29l11.52 -12.96c0.37,-0.41 1.01,-0.45 1.42,-0.08 0.42,0.37 0.46,1 0.09,1.42l-12.16 13.67c-0.19,0.22 -0.46,0.34 -0.75,0.34 -0.23,0 -0.45,-0.07 -0.63,-0.22l-7.6 -6.07c-0.43,-0.35 -0.5,-0.99 -0.16,-1.42 0.35,-0.43 0.99,-0.5 1.42,-0.16l6.85 5.48z"/></g></svg>':"Failure"===o?b='<svg class="nx-message-icon" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><g><path fill="'+m.notiflixIconColor+'" d="M20 0c11.03,0 20,8.97 20,20 0,11.03 -8.97,20 -20,20 -11.03,0 -20,-8.97 -20,-20 0,-11.03 8.97,-20 20,-20zm0 37.98c9.92,0 17.98,-8.06 17.98,-17.98 0,-9.92 -8.06,-17.98 -17.98,-17.98 -9.92,0 -17.98,8.06 -17.98,17.98 0,9.92 8.06,17.98 17.98,17.98zm1.42 -17.98l6.13 6.12c0.39,0.4 0.39,1.04 0,1.43 -0.19,0.19 -0.45,0.29 -0.71,0.29 -0.27,0 -0.53,-0.1 -0.72,-0.29l-6.12 -6.13 -6.13 6.13c-0.19,0.19 -0.44,0.29 -0.71,0.29 -0.27,0 -0.52,-0.1 -0.71,-0.29 -0.39,-0.39 -0.39,-1.03 0,-1.43l6.13 -6.12 -6.13 -6.13c-0.39,-0.39 -0.39,-1.03 0,-1.42 0.39,-0.39 1.03,-0.39 1.42,0l6.13 6.12 6.12 -6.12c0.4,-0.39 1.04,-0.39 1.43,0 0.39,0.39 0.39,1.03 0,1.42l-6.13 6.13z"/></g></svg>':"Warning"===o?b='<svg class="nx-message-icon" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><g><path fill="'+m.notiflixIconColor+'" d="M21.91 3.48l17.8 30.89c0.84,1.46 -0.23,3.25 -1.91,3.25l-35.6 0c-1.68,0 -2.75,-1.79 -1.91,-3.25l17.8 -30.89c0.85,-1.47 2.97,-1.47 3.82,0zm16.15 31.84l-17.8 -30.89c-0.11,-0.2 -0.41,-0.2 -0.52,0l-17.8 30.89c-0.12,0.2 0.05,0.4 0.26,0.4l35.6 0c0.21,0 0.38,-0.2 0.26,-0.4zm-19.01 -4.12l0 -1.05c0,-0.53 0.42,-0.95 0.95,-0.95 0.53,0 0.95,0.42 0.95,0.95l0 1.05c0,0.53 -0.42,0.95 -0.95,0.95 -0.53,0 -0.95,-0.42 -0.95,-0.95zm0 -4.66l0 -13.39c0,-0.52 0.42,-0.95 0.95,-0.95 0.53,0 0.95,0.43 0.95,0.95l0 13.39c0,0.53 -0.42,0.96 -0.95,0.96 -0.53,0 -0.95,-0.43 -0.95,-0.96z"/></g></svg>':"Info"==o&&(b='<svg class="nx-message-icon" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><g><path fill="'+m.notiflixIconColor+'" d="M20 0c11.03,0 20,8.97 20,20 0,11.03 -8.97,20 -20,20 -11.03,0 -20,-8.97 -20,-20 0,-11.03 8.97,-20 20,-20zm0 37.98c9.92,0 17.98,-8.06 17.98,-17.98 0,-9.92 -8.06,-17.98 -17.98,-17.98 -9.92,0 -17.98,8.06 -17.98,17.98 0,9.92 8.06,17.98 17.98,17.98zm-0.99 -23.3c0,-0.54 0.44,-0.98 0.99,-0.98 0.55,0 0.99,0.44 0.99,0.98l0 15.86c0,0.55 -0.44,0.99 -0.99,0.99 -0.55,0 -0.99,-0.44 -0.99,-0.99l0 -15.86zm0 -5.22c0,-0.55 0.44,-0.99 0.99,-0.99 0.55,0 0.99,0.44 0.99,0.99l0 1.09c0,0.54 -0.44,0.99 -0.99,0.99 -0.55,0 -0.99,-0.45 -0.99,-0.99l0 -1.09z"/></g></svg>'),x.innerHTML=b+'<span class="nx-message nx-with-icon">'+i+"</span>"+(e.closeButton?d:"")}else x.innerHTML='<span class="nx-message">'+i+"</span>"+(e.closeButton?d:"");if("left-bottom"===e.position||"right-bottom"===e.position){var k=t.document.getElementById(l.wrapID);k.insertBefore(x,k.firstChild)}else t.document.getElementById(l.wrapID).appendChild(x);var w=t.document.getElementById(x.id);if(w){var h,v,N=function(){w.classList.add("nx-remove");var e=t.document.getElementById(l.overlayID);e&&0>=f.childElementCount&&e.classList.add("nx-remove"),clearTimeout(h)},z=function(){if(w&&null!==w.parentNode&&w.parentNode.removeChild(w),0>=f.childElementCount&&null!==f.parentNode){f.parentNode.removeChild(f);var e=t.document.getElementById(l.overlayID);e&&null!==e.parentNode&&e.parentNode.removeChild(e)}clearTimeout(v)};if(e.closeButton&&"function"!=typeof a)t.document.getElementById(x.id).querySelector("span.nx-close-button").addEventListener("click",function(){N();var t=setTimeout(function(){z(),clearTimeout(t)},e.cssAnimationDuration)});if(("function"==typeof a||e.clickToClose)&&w.addEventListener("click",function(){"function"==typeof a&&a(),N();var t=setTimeout(function(){z(),clearTimeout(t)},e.cssAnimationDuration)}),!e.closeButton&&"function"!=typeof a){var C=function(){h=setTimeout(function(){N()},e.timeout),v=setTimeout(function(){z()},e.timeout+e.cssAnimationDuration)};C(),e.pauseOnHover&&(w.addEventListener("mouseenter",function(){w.classList.add("nx-paused"),clearTimeout(h),clearTimeout(v)}),w.addEventListener("mouseleave",function(){w.classList.remove("nx-paused"),C()}))}}if(e.showOnlyTheLastOne&&0<L)for(var W,S=t.document.querySelectorAll("[id^="+e.ID+"-]:not([id="+e.ID+"-"+L+"])"),I=0;I<S.length;I++)null!==(W=S[I]).parentNode&&W.parentNode.removeChild(W);e=g(!0,e,r)},S=function(){return'[id^=NotiflixReportWrap]{position:fixed;z-index:4002;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;left:0;top:0;padding:10px;color:#1e1e1e;border-radius:25px;background:transparent;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}[id^=NotiflixReportWrap] *{-webkit-box-sizing:border-box;box-sizing:border-box}[id^=NotiflixReportWrap]>div[class*="-overlay"]{width:100%;height:100%;left:0;top:0;background:rgba(255,255,255,.5);position:fixed;z-index:0}[id^=NotiflixReportWrap]>div[class*="-content"]{width:320px;max-width:100%;max-height:96vh;overflow-x:hidden;overflow-y:auto;border-radius:inherit;padding:10px;-webkit-filter:drop-shadow(0 0 5px rgba(0,0,0,0.05));filter:drop-shadow(0 0 5px rgba(0, 0, 0, .05));border:1px solid rgba(0,0,0,.03);background:#f8f8f8;position:relative;z-index:1}[id^=NotiflixReportWrap]>div[class*="-content"]::-webkit-scrollbar{width:0;height:0}[id^=NotiflixReportWrap]>div[class*="-content"]::-webkit-scrollbar-thumb{background:transparent}[id^=NotiflixReportWrap]>div[class*="-content"]::-webkit-scrollbar-track{background:transparent}[id^=NotiflixReportWrap]>div[class*="-content"]>div[class$="-icon"]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:110px;height:110px;display:block;margin:6px auto 12px}[id^=NotiflixReportWrap]>div[class*="-content"]>div[class$="-icon"] svg{min-width:100%;max-width:100%;height:auto}[id^=NotiflixReportWrap]>*>h5{word-break:break-all;word-break:break-word;font-family:inherit!important;font-size:16px;font-weight:500;line-height:1.4;margin:0 0 10px;padding:0 0 10px;border-bottom:1px solid rgba(0,0,0,.1);float:left;width:100%;text-align:center}[id^=NotiflixReportWrap]>*>p{word-break:break-all;word-break:break-word;font-family:inherit!important;font-size:13px;line-height:1.4;font-weight:normal;float:left;width:100%;padding:0 10px;margin:0 0 10px}[id^=NotiflixReportWrap] a#NXReportButton{word-break:break-all;word-break:break-word;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-family:inherit!important;-webkit-transition:all .25s ease-in-out;-o-transition:all .25s ease-in-out;transition:all .25s ease-in-out;cursor:pointer;float:right;padding:7px 17px;background:#32c682;font-size:14px;line-height:1.4;font-weight:500;border-radius:inherit!important;color:#fff}[id^=NotiflixReportWrap] a#NXReportButton:hover{-webkit-box-shadow:inset 0 -60px 5px -5px rgba(0,0,0,.25);box-shadow:inset 0 -60px 5px -5px rgba(0,0,0,.25)}[id^=NotiflixReportWrap].nx-rtl-on a#NXReportButton{float:left}[id^=NotiflixReportWrap]>div[class*="-overlay"].nx-with-animation{-webkit-animation:report-overlay-animation .3s ease-in-out 0s normal;animation:report-overlay-animation .3s ease-in-out 0s normal}@-webkit-keyframes report-overlay-animation{0%{opacity:0}100%{opacity:1}}@keyframes report-overlay-animation{0%{opacity:0}100%{opacity:1}}[id^=NotiflixReportWrap]>div[class*="-content"].nx-with-animation.nx-fade{-webkit-animation:report-animation-fade .3s ease-in-out 0s normal;animation:report-animation-fade .3s ease-in-out 0s normal}@-webkit-keyframes report-animation-fade{0%{opacity:0}100%{opacity:1}}@keyframes report-animation-fade{0%{opacity:0}100%{opacity:1}}[id^=NotiflixReportWrap]>div[class*="-content"].nx-with-animation.nx-zoom{-webkit-animation:report-animation-zoom .3s ease-in-out 0s normal;animation:report-animation-zoom .3s ease-in-out 0s normal}@-webkit-keyframes report-animation-zoom{0%{opacity:0;-webkit-transform:scale(.5);transform:scale(.5)}50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@keyframes report-animation-zoom{0%{opacity:0;-webkit-transform:scale(.5);transform:scale(.5)}50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}[id^=NotiflixReportWrap].nx-remove>div[class*="-overlay"].nx-with-animation{opacity:0;-webkit-animation:report-overlay-animation-remove .3s ease-in-out 0s normal;animation:report-overlay-animation-remove .3s ease-in-out 0s normal}@-webkit-keyframes report-overlay-animation-remove{0%{opacity:1}100%{opacity:0}}@keyframes report-overlay-animation-remove{0%{opacity:1}100%{opacity:0}}[id^=NotiflixReportWrap].nx-remove>div[class*="-content"].nx-with-animation.nx-fade{opacity:0;-webkit-animation:report-animation-fade-remove .3s ease-in-out 0s normal;animation:report-animation-fade-remove .3s ease-in-out 0s normal}@-webkit-keyframes report-animation-fade-remove{0%{opacity:1}100%{opacity:0}}@keyframes report-animation-fade-remove{0%{opacity:1}100%{opacity:0}}[id^=NotiflixReportWrap].nx-remove>div[class*="-content"].nx-with-animation.nx-zoom{opacity:0;-webkit-animation:report-animation-zoom-remove .3s ease-in-out 0s normal;animation:report-animation-zoom-remove .3s ease-in-out 0s normal}@-webkit-keyframes report-animation-zoom-remove{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}50%{opacity:.5;-webkit-transform:scale(1.05);transform:scale(1.05)}100%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}@keyframes report-animation-zoom-remove{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}50%{opacity:.5;-webkit-transform:scale(1.05);transform:scale(1.05)}100%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}'},I=function(e,a,n,o,r,l){if(!u("body"))return!1;i||E.Report.init({});var m={};if("object"==typeof o&&!Array.isArray(o)||"object"==typeof r&&!Array.isArray(r)){var f={};"object"==typeof o?f=o:"object"==typeof r&&(f=r),m=g(!0,i,{}),i=g(!0,i,f)}var p=i[l.toLocaleLowerCase("en")];"string"!=typeof e&&(e="Notiflix "+l),"string"!=typeof a&&("Success"===l?a='"Do not try to become a person of success but try to become a person of value." <br><br>- Albert Einstein':"Failure"===l?a='"Failure is simply the opportunity to begin again, this time more intelligently." <br><br>- Henry Ford':"Warning"===l?a='"The peoples who want to live comfortably without producing and fatigue; they are doomed to lose their dignity, then liberty, and then independence and destiny." <br><br>- Mustafa Kemal Ataturk':"Info"==l&&(a='"Knowledge rests not upon truth alone, but upon error also." <br><br>- Carl Gustav Jung')),"string"!=typeof n&&(n="Okay"),i.plainText&&(e=y(e),a=y(a),n=y(n)),i.plainText||(e.length>i.titleMaxLength&&(e="Possible HTML Tags Error",a='The "plainText" option is "false" and the title content length is more than the "titleMaxLength" option.',n="Okay"),a.length>i.messageMaxLength&&(e="Possible HTML Tags Error",a='The "plainText" option is "false" and the message content length is more than the "messageMaxLength" option.',n="Okay"),n.length>i.buttonMaxLength&&(e="Possible HTML Tags Error",a='The "plainText" option is "false" and the button content length is more than the "buttonMaxLength" option.',n="Okay")),e.length>i.titleMaxLength&&(e=e.substring(0,i.titleMaxLength)+"..."),a.length>i.messageMaxLength&&(a=a.substring(0,i.messageMaxLength)+"..."),n.length>i.buttonMaxLength&&(n=n.substring(0,i.buttonMaxLength)+"..."),i.cssAnimation||(i.cssAnimationDuration=0);var x=t.document.createElement("div");x.id=c.ID,x.className=i.className,x.style.zIndex=i.zindex,x.style.borderRadius=i.borderRadius,x.style.fontFamily='"'+i.fontFamily+'", '+s,i.rtl&&(x.setAttribute("dir","rtl"),x.classList.add("nx-rtl-on")),x.style.display="flex",x.style.flexWrap="wrap",x.style.flexDirection="column",x.style.alignItems="center",x.style.justifyContent="center";var d="";i.backOverlay&&(d='<div class="'+i.className+"-overlay"+(i.cssAnimation?" nx-with-animation":"")+'" style="background:'+(p.backOverlayColor||i.backOverlayColor)+";animation-duration:"+i.cssAnimationDuration+'ms;"></div>');var b="";if("Success"===l?b=function(t,e){return t||(t="110px"),e||(e="#32c682"),'<svg xmlns="http://www.w3.org/2000/svg" id="NXReportSuccess" width="'+t+'" height="'+t+'" fill="'+e+'" viewBox="0 0 120 120"><style>@-webkit-keyframes NXReportSuccess1-animation{0%{-webkit-transform:translate(60px,57.7px) scale(.5,.5) translate(-60px,-57.7px);transform:translate(60px,57.7px) scale(.5,.5) translate(-60px,-57.7px)}50%,to{-webkit-transform:translate(60px,57.7px) scale(1,1) translate(-60px,-57.7px);transform:translate(60px,57.7px) scale(1,1) translate(-60px,-57.7px)}60%{-webkit-transform:translate(60px,57.7px) scale(.95,.95) translate(-60px,-57.7px);transform:translate(60px,57.7px) scale(.95,.95) translate(-60px,-57.7px)}}@keyframes NXReportSuccess1-animation{0%{-webkit-transform:translate(60px,57.7px) scale(.5,.5) translate(-60px,-57.7px);transform:translate(60px,57.7px) scale(.5,.5) translate(-60px,-57.7px)}50%,to{-webkit-transform:translate(60px,57.7px) scale(1,1) translate(-60px,-57.7px);transform:translate(60px,57.7px) scale(1,1) translate(-60px,-57.7px)}60%{-webkit-transform:translate(60px,57.7px) scale(.95,.95) translate(-60px,-57.7px);transform:translate(60px,57.7px) scale(.95,.95) translate(-60px,-57.7px)}}@-webkit-keyframes NXReportSuccess4-animation{0%{opacity:0}50%,to{opacity:1}}@keyframes NXReportSuccess4-animation{0%{opacity:0}50%,to{opacity:1}}@-webkit-keyframes NXReportSuccess3-animation{0%{opacity:0}40%,to{opacity:1}}@keyframes NXReportSuccess3-animation{0%{opacity:0}40%,to{opacity:1}}@-webkit-keyframes NXReportSuccess2-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}40%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}@keyframes NXReportSuccess2-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}40%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}#NXReportSuccess *{-webkit-animation-duration:1.2s;animation-duration:1.2s;-webkit-animation-timing-function:cubic-bezier(0,0,1,1);animation-timing-function:cubic-bezier(0,0,1,1)}</style><g style="-webkit-animation-name:NXReportSuccess2-animation;animation-name:NXReportSuccess2-animation;-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1)"><path d="M60 115.38C29.46 115.38 4.62 90.54 4.62 60 4.62 29.46 29.46 4.62 60 4.62c30.54 0 55.38 24.84 55.38 55.38 0 30.54-24.84 55.38-55.38 55.38zM60 0C26.92 0 0 26.92 0 60s26.92 60 60 60 60-26.92 60-60S93.08 0 60 0z" style="-webkit-animation-name:NXReportSuccess3-animation;animation-name:NXReportSuccess3-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1)" fill="inherit" data-animator-group="true" data-animator-type="2"/></g><g style="-webkit-animation-name:NXReportSuccess1-animation;animation-name:NXReportSuccess1-animation;-webkit-transform:translate(60px,57.7px) scale(1,1) translate(-60px,-57.7px);-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1)"><path d="M88.27 35.39L52.8 75.29 31.43 58.2c-.98-.81-2.44-.63-3.24.36-.79.99-.63 2.44.36 3.24l23.08 18.46c.43.34.93.51 1.44.51.64 0 1.27-.26 1.74-.78l36.91-41.53a2.3 2.3 0 0 0-.19-3.26c-.95-.86-2.41-.77-3.26.19z" style="-webkit-animation-name:NXReportSuccess4-animation;animation-name:NXReportSuccess4-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1)" fill="inherit" data-animator-group="true" data-animator-type="2"/></g></svg>'}(i.svgSize,p.svgColor):"Failure"===l?b=function(t,e){return t||(t="110px"),e||(e="#ff5549"),'<svg xmlns="http://www.w3.org/2000/svg" id="NXReportFailure" width="'+t+'" height="'+t+'" fill="'+e+'" viewBox="0 0 120 120"><style>@-webkit-keyframes NXReportFailure2-animation{0%{opacity:0}40%,to{opacity:1}}@keyframes NXReportFailure2-animation{0%{opacity:0}40%,to{opacity:1}}@-webkit-keyframes NXReportFailure1-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}40%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}@keyframes NXReportFailure1-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}40%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}@-webkit-keyframes NXReportFailure3-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}50%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}@keyframes NXReportFailure3-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}50%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}@-webkit-keyframes NXReportFailure4-animation{0%{opacity:0}50%,to{opacity:1}}@keyframes NXReportFailure4-animation{0%{opacity:0}50%,to{opacity:1}}#NXReportFailure *{-webkit-animation-duration:1.2s;animation-duration:1.2s;-webkit-animation-timing-function:cubic-bezier(0,0,1,1);animation-timing-function:cubic-bezier(0,0,1,1)}</style><g style="-webkit-animation-name:NXReportFailure1-animation;animation-name:NXReportFailure1-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1);-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)"><path d="M4.35 34.95c0-16.82 13.78-30.6 30.6-30.6h50.1c16.82 0 30.6 13.78 30.6 30.6v50.1c0 16.82-13.78 30.6-30.6 30.6h-50.1c-16.82 0-30.6-13.78-30.6-30.6v-50.1zM34.95 120h50.1c19.22 0 34.95-15.73 34.95-34.95v-50.1C120 15.73 104.27 0 85.05 0h-50.1C15.73 0 0 15.73 0 34.95v50.1C0 104.27 15.73 120 34.95 120z" style="-webkit-animation-name:NXReportFailure2-animation;animation-name:NXReportFailure2-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1)" fill="inherit" data-animator-group="true" data-animator-type="2"/></g><g style="-webkit-animation-name:NXReportFailure3-animation;animation-name:NXReportFailure3-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1);-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)"><path d="M82.4 37.6c-.9-.9-2.37-.9-3.27 0L60 56.73 40.86 37.6a2.306 2.306 0 0 0-3.26 3.26L56.73 60 37.6 79.13c-.9.9-.9 2.37 0 3.27.45.45 1.04.68 1.63.68.59 0 1.18-.23 1.63-.68L60 63.26 79.13 82.4c.45.45 1.05.68 1.64.68.58 0 1.18-.23 1.63-.68.9-.9.9-2.37 0-3.27L63.26 60 82.4 40.86c.9-.91.9-2.36 0-3.26z" style="-webkit-animation-name:NXReportFailure4-animation;animation-name:NXReportFailure4-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1)" fill="inherit" data-animator-group="true" data-animator-type="2"/></g></svg>'}(i.svgSize,p.svgColor):"Warning"===l?b=function(t,e){return t||(t="110px"),e||(e="#eebf31"),'<svg xmlns="http://www.w3.org/2000/svg" id="NXReportWarning" width="'+t+'" height="'+t+'" fill="'+e+'" viewBox="0 0 120 120"><style>@-webkit-keyframes NXReportWarning2-animation{0%{opacity:0}40%,to{opacity:1}}@keyframes NXReportWarning2-animation{0%{opacity:0}40%,to{opacity:1}}@-webkit-keyframes NXReportWarning1-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}40%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}@keyframes NXReportWarning1-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}40%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}@-webkit-keyframes NXReportWarning3-animation{0%{-webkit-transform:translate(60px,66.6px) scale(.5,.5) translate(-60px,-66.6px);transform:translate(60px,66.6px) scale(.5,.5) translate(-60px,-66.6px)}50%,to{-webkit-transform:translate(60px,66.6px) scale(1,1) translate(-60px,-66.6px);transform:translate(60px,66.6px) scale(1,1) translate(-60px,-66.6px)}60%{-webkit-transform:translate(60px,66.6px) scale(.95,.95) translate(-60px,-66.6px);transform:translate(60px,66.6px) scale(.95,.95) translate(-60px,-66.6px)}}@keyframes NXReportWarning3-animation{0%{-webkit-transform:translate(60px,66.6px) scale(.5,.5) translate(-60px,-66.6px);transform:translate(60px,66.6px) scale(.5,.5) translate(-60px,-66.6px)}50%,to{-webkit-transform:translate(60px,66.6px) scale(1,1) translate(-60px,-66.6px);transform:translate(60px,66.6px) scale(1,1) translate(-60px,-66.6px)}60%{-webkit-transform:translate(60px,66.6px) scale(.95,.95) translate(-60px,-66.6px);transform:translate(60px,66.6px) scale(.95,.95) translate(-60px,-66.6px)}}@-webkit-keyframes NXReportWarning4-animation{0%{opacity:0}50%,to{opacity:1}}@keyframes NXReportWarning4-animation{0%{opacity:0}50%,to{opacity:1}}#NXReportWarning *{-webkit-animation-duration:1.2s;animation-duration:1.2s;-webkit-animation-timing-function:cubic-bezier(0,0,1,1);animation-timing-function:cubic-bezier(0,0,1,1)}</style><g style="-webkit-animation-name:NXReportWarning1-animation;animation-name:NXReportWarning1-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1);-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)"><path d="M115.46 106.15l-54.04-93.8c-.61-1.06-2.23-1.06-2.84 0l-54.04 93.8c-.62 1.07.21 2.29 1.42 2.29h108.08c1.21 0 2.04-1.22 1.42-2.29zM65.17 10.2l54.04 93.8c2.28 3.96-.65 8.78-5.17 8.78H5.96c-4.52 0-7.45-4.82-5.17-8.78l54.04-93.8c2.28-3.95 8.03-4 10.34 0z" style="-webkit-animation-name:NXReportWarning2-animation;animation-name:NXReportWarning2-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1)" fill="inherit" data-animator-group="true" data-animator-type="2"/></g><g style="-webkit-animation-name:NXReportWarning3-animation;animation-name:NXReportWarning3-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1);-webkit-transform:translate(60px,66.6px) scale(1,1) translate(-60px,-66.6px)"><path d="M57.83 94.01c0 1.2.97 2.17 2.17 2.17s2.17-.97 2.17-2.17v-3.2c0-1.2-.97-2.17-2.17-2.17s-2.17.97-2.17 2.17v3.2zm0-14.15c0 1.2.97 2.17 2.17 2.17s2.17-.97 2.17-2.17V39.21c0-1.2-.97-2.17-2.17-2.17s-2.17.97-2.17 2.17v40.65z" style="-webkit-animation-name:NXReportWarning4-animation;animation-name:NXReportWarning4-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1)" fill="inherit" data-animator-group="true" data-animator-type="2"/></g></svg>'}(i.svgSize,p.svgColor):"Info"==l&&(b=function(t,e){return t||(t="110px"),e||(e="#26c0d3"),'<svg xmlns="http://www.w3.org/2000/svg" id="NXReportInfo" width="'+t+'" height="'+t+'" fill="'+e+'" viewBox="0 0 120 120"><style>@-webkit-keyframes NXReportInfo4-animation{0%{opacity:0}50%,to{opacity:1}}@keyframes NXReportInfo4-animation{0%{opacity:0}50%,to{opacity:1}}@-webkit-keyframes NXReportInfo3-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}50%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}@keyframes NXReportInfo3-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}50%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}@-webkit-keyframes NXReportInfo2-animation{0%{opacity:0}40%,to{opacity:1}}@keyframes NXReportInfo2-animation{0%{opacity:0}40%,to{opacity:1}}@-webkit-keyframes NXReportInfo1-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}40%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}@keyframes NXReportInfo1-animation{0%{-webkit-transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px);transform:translate(60px,60px) scale(.5,.5) translate(-60px,-60px)}40%,to{-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px);transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)}60%{-webkit-transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px);transform:translate(60px,60px) scale(.95,.95) translate(-60px,-60px)}}#NXReportInfo *{-webkit-animation-duration:1.2s;animation-duration:1.2s;-webkit-animation-timing-function:cubic-bezier(0,0,1,1);animation-timing-function:cubic-bezier(0,0,1,1)}</style><g style="-webkit-animation-name:NXReportInfo1-animation;animation-name:NXReportInfo1-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1);-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)"><path d="M60 115.38C29.46 115.38 4.62 90.54 4.62 60 4.62 29.46 29.46 4.62 60 4.62c30.54 0 55.38 24.84 55.38 55.38 0 30.54-24.84 55.38-55.38 55.38zM60 0C26.92 0 0 26.92 0 60s26.92 60 60 60 60-26.92 60-60S93.08 0 60 0z" style="-webkit-animation-name:NXReportInfo2-animation;animation-name:NXReportInfo2-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1)" fill="inherit" data-animator-group="true" data-animator-type="2"/></g><g style="-webkit-animation-name:NXReportInfo3-animation;animation-name:NXReportInfo3-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1);-webkit-transform:translate(60px,60px) scale(1,1) translate(-60px,-60px)"><path d="M57.75 43.85c0-1.24 1.01-2.25 2.25-2.25s2.25 1.01 2.25 2.25v48.18c0 1.24-1.01 2.25-2.25 2.25s-2.25-1.01-2.25-2.25V43.85zm0-15.88c0-1.24 1.01-2.25 2.25-2.25s2.25 1.01 2.25 2.25v3.32c0 1.25-1.01 2.25-2.25 2.25s-2.25-1-2.25-2.25v-3.32z" style="-webkit-animation-name:NXReportInfo4-animation;animation-name:NXReportInfo4-animation;-webkit-animation-timing-function:cubic-bezier(.42,0,.58,1);animation-timing-function:cubic-bezier(.42,0,.58,1)" fill="inherit" data-animator-group="true" data-animator-type="2"/></g></svg>'}(i.svgSize,p.svgColor)),x.innerHTML=d+'<div class="'+i.className+"-content"+(i.cssAnimation?" nx-with-animation ":"")+" nx-"+i.cssAnimationStyle+'" style="width:'+i.width+"; background:"+i.backgroundColor+"; animation-duration:"+i.cssAnimationDuration+'ms;"><div style="width:'+i.svgSize+"; height:"+i.svgSize+';" class="'+i.className+'-icon">'+b+'</div><h5 class="'+i.className+'-title" style="font-weight:500; font-size:'+i.titleFontSize+"; color:"+p.titleColor+';">'+e+'</h5><p class="'+i.className+'-message" style="font-size:'+i.messageFontSize+"; color:"+p.messageColor+';">'+a+'</p><a id="NXReportButton" class="'+i.className+'-button" style="font-weight:500; font-size:'+i.buttonFontSize+"; background:"+p.buttonBackground+"; color:"+p.buttonColor+';">'+n+"</a></div>",!t.document.getElementById(x.id)){t.document.body.appendChild(x);var k=t.document.getElementById(x.id);t.document.getElementById("NXReportButton").addEventListener("click",function(){"function"==typeof o&&o(),k.classList.add("nx-remove");var t=setTimeout(function(){null!==k.parentNode&&k.parentNode.removeChild(k),clearTimeout(t)},i.cssAnimationDuration)})}i=g(!0,i,m)},R=function(){return'[id^=NotiflixConfirmWrap]{position:fixed;z-index:4003;width:100%;height:100%;left:0;top:0;padding:10px;-webkit-box-sizing:border-box;box-sizing:border-box;background:transparent;font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}[id^=NotiflixConfirmWrap].nx-position-center-top{-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start}[id^=NotiflixConfirmWrap].nx-position-center-bottom{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}[id^=NotiflixConfirmWrap].nx-position-left-top{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start}[id^=NotiflixConfirmWrap].nx-position-left-center{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start}[id^=NotiflixConfirmWrap].nx-position-left-bottom{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}[id^=NotiflixConfirmWrap].nx-position-right-top{-webkit-box-align:end;-webkit-align-items:flex-end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start}[id^=NotiflixConfirmWrap].nx-position-right-center{-webkit-box-align:end;-webkit-align-items:flex-end;-ms-flex-align:end;align-items:flex-end}[id^=NotiflixConfirmWrap].nx-position-right-bottom{-webkit-box-align:end;-webkit-align-items:flex-end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}[id^=NotiflixConfirmWrap] *{-webkit-box-sizing:border-box;box-sizing:border-box}[id^=NotiflixConfirmWrap]>div[class*="-overlay"]{width:100%;height:100%;left:0;top:0;background:rgba(255,255,255,.5);position:fixed;z-index:0}[id^=NotiflixConfirmWrap]>div[class*="-overlay"].nx-with-animation{-webkit-animation:confirm-overlay-animation .3s ease-in-out 0s normal;animation:confirm-overlay-animation .3s ease-in-out 0s normal}@-webkit-keyframes confirm-overlay-animation{0%{opacity:0}100%{opacity:1}}@keyframes confirm-overlay-animation{0%{opacity:0}100%{opacity:1}}[id^=NotiflixConfirmWrap].nx-remove>div[class*="-overlay"].nx-with-animation{opacity:0;-webkit-animation:confirm-overlay-animation-remove .3s ease-in-out 0s normal;animation:confirm-overlay-animation-remove .3s ease-in-out 0s normal}@-webkit-keyframes confirm-overlay-animation-remove{0%{opacity:1}100%{opacity:0}}@keyframes confirm-overlay-animation-remove{0%{opacity:1}100%{opacity:0}}[id^=NotiflixConfirmWrap]>div[class*="-content"]{width:300px;max-width:100%;max-height:96vh;overflow-x:hidden;overflow-y:auto;border-radius:25px;padding:10px;margin:0;-webkit-filter:drop-shadow(0 0 5px rgba(0,0,0,0.05));filter:drop-shadow(0 0 5px rgba(0, 0, 0, .05));background:#f8f8f8;color:#1e1e1e;position:relative;z-index:1;text-align:center}[id^=NotiflixConfirmWrap]>div[class*="-content"]::-webkit-scrollbar{width:0;height:0}[id^=NotiflixConfirmWrap]>div[class*="-content"]::-webkit-scrollbar-thumb{background:transparent}[id^=NotiflixConfirmWrap]>div[class*="-content"]::-webkit-scrollbar-track{background:transparent}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-head"]{float:left;width:100%;text-align:inherit}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-head"]>h5{float:left;width:100%;margin:0;padding:0 0 10px;border-bottom:1px solid rgba(0,0,0,.1);color:#32c682;font-family:inherit!important;font-size:16px;line-height:1.4;font-weight:500;text-align:inherit}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div{font-family:inherit!important;margin:15px 0 20px;padding:0 10px;float:left;width:100%;font-size:14px;line-height:1.4;font-weight:normal;color:inherit;text-align:inherit}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div{font-family:inherit!important;float:left;width:100%;margin:15px 0 0;padding:0}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div>input{font-family:inherit!important;float:left;width:100%;height:40px;margin:0;padding:0 15px;border:1px solid rgba(0,0,0,.1);border-radius:25px;font-size:14px;font-weight:normal;line-height:1;-webkit-transition:all .25s ease-in-out;-o-transition:all .25s ease-in-out;transition:all .25s ease-in-out;text-align:left}[id^=NotiflixConfirmWrap].nx-rtl-on>div[class*="-content"]>div[class*="-head"]>div>div>input{text-align:right}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div>input:hover{border-color:rgba(0,0,0,.1)}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div>input:focus{border-color:rgba(0,0,0,.3)}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div>input.nx-validation-failure{border-color:#ff5549}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div>input.nx-validation-success{border-color:#32c682}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-radius:inherit;float:left;width:100%;text-align:inherit}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]>a{cursor:pointer;font-family:inherit!important;-webkit-transition:all .25s ease-in-out;-o-transition:all .25s ease-in-out;transition:all .25s ease-in-out;float:left;width:48%;padding:9px 5px;border-radius:inherit!important;font-weight:500;font-size:15px;line-height:1.4;color:#f8f8f8;text-align:inherit}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]>a.nx-confirm-button-ok{margin:0 2% 0 0;background:#32c682}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]>a.nx-confirm-button-cancel{margin:0 0 0 2%;background:#a9a9a9}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]>a.nx-full{margin:0;width:100%}[id^=NotiflixConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]>a:hover{-webkit-box-shadow:inset 0 -60px 5px -5px rgba(0,0,0,.25);box-shadow:inset 0 -60px 5px -5px rgba(0,0,0,.25)}[id^=NotiflixConfirmWrap].nx-rtl-on>div[class*="-content"]>div[class*="-buttons"],[id^=NotiflixConfirmWrap].nx-rtl-on>div[class*="-content"]>div[class*="-buttons"]>a{-webkit-transform:rotateY(180deg);transform:rotateY(180deg)}[id^=NotiflixConfirmWrap].nx-with-animation.nx-fade>div[class*="-content"]{-webkit-animation:confirm-animation-fade .3s ease-in-out 0s normal;animation:confirm-animation-fade .3s ease-in-out 0s normal}@-webkit-keyframes confirm-animation-fade{0%{opacity:0}100%{opacity:1}}@keyframes confirm-animation-fade{0%{opacity:0}100%{opacity:1}}[id^=NotiflixConfirmWrap].nx-with-animation.nx-zoom>div[class*="-content"]{-webkit-animation:confirm-animation-zoom .3s ease-in-out 0s normal;animation:confirm-animation-zoom .3s ease-in-out 0s normal}@-webkit-keyframes confirm-animation-zoom{0%{opacity:0;-webkit-transform:scale(.5);transform:scale(.5)}50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@keyframes confirm-animation-zoom{0%{opacity:0;-webkit-transform:scale(.5);transform:scale(.5)}50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}[id^=NotiflixConfirmWrap].nx-with-animation.nx-fade.nx-remove>div[class*="-content"]{opacity:0;-webkit-animation:confirm-animation-fade-remove .3s ease-in-out 0s normal;animation:confirm-animation-fade-remove .3s ease-in-out 0s normal}@-webkit-keyframes confirm-animation-fade-remove{0%{opacity:1}100%{opacity:0}}@keyframes confirm-animation-fade-remove{0%{opacity:1}100%{opacity:0}}[id^=NotiflixConfirmWrap].nx-with-animation.nx-zoom.nx-remove>div[class*="-content"]{opacity:0;-webkit-animation:confirm-animation-zoom-remove .3s ease-in-out 0s normal;animation:confirm-animation-zoom-remove .3s ease-in-out 0s normal}@-webkit-keyframes confirm-animation-zoom-remove{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}50%{opacity:.5;-webkit-transform:scale(1.05);transform:scale(1.05)}100%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}@keyframes confirm-animation-zoom-remove{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}50%{opacity:.5;-webkit-transform:scale(1.05);transform:scale(1.05)}100%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}'},A=function(e,i,n,o,r,l,c,f,p){if(!u("body"))return!1;a||E.Confirm.init({});var x=g(!0,a,{});"object"!=typeof c||Array.isArray(c)||(a=g(!0,a,c)),"string"!=typeof e&&(e="Notiflix Confirm"),"string"!=typeof i&&(i="Do you agree with me?"),"string"!=typeof n&&(n="Yes"),"string"!=typeof o&&(o="No"),"function"!=typeof r&&(r=void 0),"function"!=typeof l&&(l=void 0),a.plainText&&(e=y(e),i=y(i),n=y(n),o=y(o)),a.plainText||(e.length>a.titleMaxLength&&(e="Possible HTML Tags Error",i='The "plainText" option is "false" and the title content length is more than "titleMaxLength" option.',n="Okay",o="..."),i.length>a.messageMaxLength&&(e="Possible HTML Tags Error",i='The "plainText" option is "false" and the message content length is more than "messageMaxLength" option.',n="Okay",o="..."),(n.length||o.length)>a.buttonsMaxLength&&(e="Possible HTML Tags Error",i='The "plainText" option is "false" and the buttons content length is more than "buttonsMaxLength" option.',n="Okay",o="...")),e.length>a.titleMaxLength&&(e=e.substring(0,a.titleMaxLength)+"..."),i.length>a.messageMaxLength&&(i=i.substring(0,a.messageMaxLength)+"..."),n.length>a.buttonsMaxLength&&(n=n.substring(0,a.buttonsMaxLength)+"..."),o.length>a.buttonsMaxLength&&(o=o.substring(0,a.buttonsMaxLength)+"..."),a.cssAnimation||(a.cssAnimationDuration=0);var d=t.document.createElement("div");d.id=m.ID,d.className=a.className+(a.cssAnimation?" nx-with-animation nx-"+a.cssAnimationStyle:""),d.style.zIndex=a.zindex,d.style.padding=a.distance,a.rtl&&(d.setAttribute("dir","rtl"),d.classList.add("nx-rtl-on"));var b="string"==typeof a.position?a.position.trim():"center";d.classList.add("nx-position-"+b),d.style.fontFamily='"'+a.fontFamily+'", '+s;var k="";a.backOverlay&&(k='<div class="'+a.className+"-overlay"+(a.cssAnimation?" nx-with-animation":"")+'" style="background:'+a.backOverlayColor+";animation-duration:"+a.cssAnimationDuration+'ms;"></div>');var w="";"function"==typeof r&&(w='<a id="NXConfirmButtonCancel" class="nx-confirm-button-cancel" style="color:'+a.cancelButtonColor+";background:"+a.cancelButtonBackground+";font-size:"+a.buttonsFontSize+';">'+o+"</a>");var h="",v=null;if(f&&"string"==typeof p&&0<p.length&&(v=p,h='<div><input id="NXConfirmValidationInput" type="text" style="font-size:'+a.messageFontSize+";border-radius: "+a.borderRadius+';" maxlength="'+v.length+'" autocomplete="off" spellcheck="false" autocapitalize="none" /></div>'),d.innerHTML=k+'<div class="'+a.className+'-content" style="width:'+a.width+"; background:"+a.backgroundColor+"; animation-duration:"+a.cssAnimationDuration+"ms; border-radius: "+a.borderRadius+';"><div class="'+a.className+'-head"><h5 style="color:'+a.titleColor+";font-size:"+a.titleFontSize+';">'+e+'</h5><div style="color:'+a.messageColor+";font-size:"+a.messageFontSize+';">'+i+h+'</div></div><div class="'+a.className+'-buttons"><a id="NXConfirmButtonOk" class="nx-confirm-button-ok'+("function"==typeof r?"":" nx-full")+'" style="color:'+a.okButtonColor+";background:"+a.okButtonBackground+";font-size:"+a.buttonsFontSize+';">'+n+"</a>"+w+"</div></div>",!t.document.getElementById(d.id)){t.document.body.appendChild(d);var N=t.document.getElementById(d.id),z=t.document.getElementById("NXConfirmButtonOk"),C=t.document.getElementById("NXConfirmValidationInput");if(C&&(C.focus(),C.addEventListener("keyup",function(t){(t.target.value||"").toString()!==v?(C.classList.add("nx-validation-failure"),C.classList.remove("nx-validation-success")):(C.classList.remove("nx-validation-failure"),C.classList.add("nx-validation-success"),("enter"===(t.key||"").toLocaleLowerCase("en")||13===t.keyCode)&&z.dispatchEvent(new Event("click")))})),z.addEventListener("click",function(t){if(f&&v&&C){if((C.value||"").toString()!==v)return C.focus(),C.classList.add("nx-validation-failure"),t.stopPropagation(),t.preventDefault(),t.returnValue=!1,t.cancelBubble=!0,!1;C.classList.remove("nx-validation-failure")}"function"==typeof r&&r(),N.classList.add("nx-remove");var e=setTimeout(function(){null!==N.parentNode&&(N.parentNode.removeChild(N),clearTimeout(e))},a.cssAnimationDuration)}),"function"==typeof r)t.document.getElementById("NXConfirmButtonCancel").addEventListener("click",function(){"function"==typeof l&&l(),N.classList.add("nx-remove");var t=setTimeout(function(){null!==N.parentNode&&(N.parentNode.removeChild(N),clearTimeout(t))},a.cssAnimationDuration)})}a=g(!0,a,x)},M=function(){return'[id^=NotiflixLoadingWrap]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:fixed;z-index:4000;width:100%;height:100%;left:0;top:0;right:0;bottom:0;margin:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box;background:rgba(0,0,0,.8);font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif}[id^=NotiflixLoadingWrap] *{-webkit-box-sizing:border-box;box-sizing:border-box}[id^=NotiflixLoadingWrap].nx-click-to-close{cursor:pointer}[id^=NotiflixLoadingWrap]>div[class*="-icon"]{width:60px;height:60px;position:relative;-webkit-transition:top .2s ease-in-out;-o-transition:top .2s ease-in-out;transition:top .2s ease-in-out;margin:0 auto}[id^=NotiflixLoadingWrap]>div[class*="-icon"] img,[id^=NotiflixLoadingWrap]>div[class*="-icon"] svg{max-width:unset;max-height:unset;width:100%;height:100%;position:absolute;left:0;top:0}[id^=NotiflixLoadingWrap]>p{position:relative;margin:10px auto 0;font-family:inherit!important;font-weight:normal;font-size:15px;line-height:1.4;padding:0 10px;width:100%;text-align:center}[id^=NotiflixLoadingWrap].nx-with-animation{-webkit-animation:loading-animation-fade .3s ease-in-out 0s normal;animation:loading-animation-fade .3s ease-in-out 0s normal}@-webkit-keyframes loading-animation-fade{0%{opacity:0}100%{opacity:1}}@keyframes loading-animation-fade{0%{opacity:0}100%{opacity:1}}[id^=NotiflixLoadingWrap].nx-with-animation.nx-remove{opacity:0;-webkit-animation:loading-animation-fade-remove .3s ease-in-out 0s normal;animation:loading-animation-fade-remove .3s ease-in-out 0s normal}@-webkit-keyframes loading-animation-fade-remove{0%{opacity:1}100%{opacity:0}}@keyframes loading-animation-fade-remove{0%{opacity:1}100%{opacity:0}}[id^=NotiflixLoadingWrap]>p.nx-loading-message-new{-webkit-animation:loading-new-message-fade .3s ease-in-out 0s normal;animation:loading-new-message-fade .3s ease-in-out 0s normal}@-webkit-keyframes loading-new-message-fade{0%{opacity:0}100%{opacity:1}}@keyframes loading-new-message-fade{0%{opacity:0}100%{opacity:1}}'},B=function(e,i,a,o,r){if(!u("body"))return!1;n||E.Loading.init({});var l=g(!0,n,{});if("object"==typeof e&&!Array.isArray(e)||"object"==typeof i&&!Array.isArray(i)){var c={};"object"==typeof e?c=e:"object"==typeof i&&(c=i),n=g(!0,n,c)}var m="";if("string"==typeof e&&0<e.length&&(m=e),o){var p="";0<(m=m.length>n.messageMaxLength?y(m).toString().substring(0,n.messageMaxLength)+"...":y(m).toString()).length&&(p='<p id="'+n.messageID+'" class="nx-loading-message" style="color:'+n.messageColor+";font-size:"+n.messageFontSize+';">'+m+"</p>"),n.cssAnimation||(n.cssAnimationDuration=0);var d="";if("standard"===a)d=k(n.svgSize,n.svgColor);else if("hourglass"===a)d=w(n.svgSize,n.svgColor);else if("circle"===a)d=h(n.svgSize,n.svgColor);else if("arrows"===a)d=v(n.svgSize,n.svgColor);else if("dots"===a)d=N(n.svgSize,n.svgColor);else if("pulse"===a)d=z(n.svgSize,n.svgColor);else if("custom"===a&&null!==n.customSvgUrl)d='<img class="nx-custom-loading-icon" width="'+n.svgSize+'" height="'+n.svgSize+'" src="'+n.customSvgUrl+'" alt="Notiflix">';else{if("custom"===a&&null===n.customSvgUrl)return x('You have to set a static SVG url to "customSvgUrl" option to use Loading Custom.'),!1;d=function(t,e,i){return t||(t="60px"),e||(e="#f8f8f8"),i||(i="#32c682"),'<svg xmlns="http://www.w3.org/2000/svg" id="NXLoadingNotiflixLib" width="'+t+'" height="'+t+'" viewBox="0 0 200 200"><defs><style>@keyframes notiflix-n{0%{stroke-dashoffset:1000}to{stroke-dashoffset:0}}@keyframes notiflix-x{0%{stroke-dashoffset:1000}to{stroke-dashoffset:0}}@keyframes notiflix-dot{0%,to{stroke-width:0}50%{stroke-width:12}}.nx-icon-line{stroke:'+e+';stroke-width:12;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:22;fill:none}</style></defs><path d="M47.97 135.05a6.5 6.5 0 1 1 0 13 6.5 6.5 0 0 1 0-13z" style="animation-name:notiflix-dot;animation-timing-function:ease-in-out;animation-duration:1.25s;animation-iteration-count:infinite;animation-direction:normal" fill="'+i+'" stroke="'+i+'" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="22" stroke-width="12"/><path class="nx-icon-line" d="M10.14 144.76V87.55c0-5.68-4.54-41.36 37.83-41.36 42.36 0 37.82 35.68 37.82 41.36v57.21" style="animation-name:notiflix-n;animation-timing-function:linear;animation-duration:2.5s;animation-delay:0s;animation-iteration-count:infinite;animation-direction:normal" stroke-dasharray="500"/><path class="nx-icon-line" d="M115.06 144.49c24.98-32.68 49.96-65.35 74.94-98.03M114.89 46.6c25.09 32.58 50.19 65.17 75.29 97.75" style="animation-name:notiflix-x;animation-timing-function:linear;animation-duration:2.5s;animation-delay:.2s;animation-iteration-count:infinite;animation-direction:normal" stroke-dasharray="500"/></svg>'}(n.svgSize,"#f8f8f8","#32c682")}var b=parseInt((n.svgSize||"").replace(/[^0-9]/g,"")),C=t.innerWidth,L=b>=C?C-40+"px":b+"px",W='<div style="width:'+L+"; height:"+L+';" class="'+n.className+"-icon"+(0<m.length?" nx-with-message":"")+'">'+d+"</div>",S=t.document.createElement("div");if(S.id=f.ID,S.className=n.className+(n.cssAnimation?" nx-with-animation":"")+(n.clickToClose?" nx-click-to-close":""),S.style.zIndex=n.zindex,S.style.background=n.backgroundColor,S.style.animationDuration=n.cssAnimationDuration+"ms",S.style.fontFamily='"'+n.fontFamily+'", '+s,S.style.display="flex",S.style.flexWrap="wrap",S.style.flexDirection="column",S.style.alignItems="center",S.style.justifyContent="center",n.rtl&&(S.setAttribute("dir","rtl"),S.classList.add("nx-rtl-on")),S.innerHTML=W+p,!t.document.getElementById(S.id)&&(t.document.body.appendChild(S),n.clickToClose))t.document.getElementById(S.id).addEventListener("click",function(){S.classList.add("nx-remove");var t=setTimeout(function(){null!==S.parentNode&&(S.parentNode.removeChild(S),clearTimeout(t))},n.cssAnimationDuration)})}else if(t.document.getElementById(f.ID))var I=t.document.getElementById(f.ID),R=setTimeout(function(){I.classList.add("nx-remove");var t=setTimeout(function(){null!==I.parentNode&&(I.parentNode.removeChild(I),clearTimeout(t))},n.cssAnimationDuration);clearTimeout(R)},r);n=g(!0,n,l)},T=function(e){"string"!=typeof e&&(e="");var i=t.document.getElementById(f.ID);if(i)if(0<e.length){e=e.length>n.messageMaxLength?y(e).substring(0,n.messageMaxLength)+"...":y(e);var a=i.getElementsByTagName("p")[0];if(a)a.innerHTML=e;else{var o=t.document.createElement("p");o.id=n.messageID,o.className="nx-loading-message nx-loading-message-new",o.style.color=n.messageColor,o.style.fontSize=n.messageFontSize,o.innerHTML=e,i.appendChild(o)}}else x("Where is the new message?")},X=function(){return'[id^=NotiflixBlockWrap]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1000;font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;background:rgba(255,255,255,.9);text-align:center;animation-duration:.4s;width:100%;height:100%;left:0;top:0;border-radius:inherit;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}[id^=NotiflixBlockWrap] *{-webkit-box-sizing:border-box;box-sizing:border-box}[id^=NotiflixBlockWrap]>span[class*="-icon"]{display:block;width:45px;height:45px;position:relative;margin:0 auto}[id^=NotiflixBlockWrap]>span[class*="-icon"] svg{width:inherit;height:inherit}[id^=NotiflixBlockWrap]>span[class*="-message"]{position:relative;display:block;width:100%;margin:10px auto 0;padding:0 10px;font-family:inherit!important;font-weight:normal;font-size:14px;line-height:1.4}[id^=NotiflixBlockWrap].nx-with-animation{-webkit-animation:block-animation-fade .3s ease-in-out 0s normal;animation:block-animation-fade .3s ease-in-out 0s normal}@-webkit-keyframes block-animation-fade{0%{opacity:0}100%{opacity:1}}@keyframes block-animation-fade{0%{opacity:0}100%{opacity:1}}[id^=NotiflixBlockWrap].nx-with-animation.nx-remove{opacity:0;-webkit-animation:block-animation-fade-remove .3s ease-in-out 0s normal;animation:block-animation-fade-remove .3s ease-in-out 0s normal}@-webkit-keyframes block-animation-fade-remove{0%{opacity:1}100%{opacity:0}}@keyframes block-animation-fade-remove{0%{opacity:1}100%{opacity:0}}'},D=0,F=function(e,i,a,n,r,l){var c;if(Array.isArray(i)){if(1>i.length)return x("Array of HTMLElements should contains at least one HTMLElement."),!1;c=i}else if(Object.prototype.isPrototypeOf.call(NodeList.prototype,i)){if(1>i.length)return x("NodeListOf<HTMLElement> should contains at least one HTMLElement."),!1;c=Array.prototype.slice.call(i)}else{if("string"!=typeof i||1>(i||"").length||1===(i||"").length&&("#"===(i||"")[0]||"."===(i||"")[0]))return x("The selector parameter must be a string and matches a specified CSS selector(s)."),!1;var m=t.document.querySelectorAll(i);if(1>m.length)return x('You called the "Notiflix.Block..." function with "'+i+'" selector, but there is no such element(s) in the document.'),!1;c=m}o||E.Block.init({});var f=g(!0,o,{});if("object"==typeof n&&!Array.isArray(n)||"object"==typeof r&&!Array.isArray(r)){var b={};"object"==typeof n?b=n:"object"==typeof r&&(b=r),o=g(!0,o,b)}var C="";"string"==typeof n&&0<n.length&&(C=n),o.cssAnimation||(o.cssAnimationDuration=0);var L="notiflix-block";"string"==typeof o.className&&(L=o.className.trim());var W="number"==typeof o.querySelectorLimit?o.querySelectorLimit:200,S=(c||[]).length>=W?W:c.length;if(e){for(var I,R=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","html","head","title","script","style","iframe"],A=0;A<S;A++)if(I=c[A]){if(-1<R.indexOf(I.tagName.toLocaleLowerCase("en")))break;var M=I.querySelectorAll("[id^="+p.ID+"]");if(1>M.length){var B="";a&&(B="hourglass"===a?w(o.svgSize,o.svgColor):"circle"===a?h(o.svgSize,o.svgColor):"arrows"===a?v(o.svgSize,o.svgColor):"dots"===a?N(o.svgSize,o.svgColor):"pulse"===a?z(o.svgSize,o.svgColor):k(o.svgSize,o.svgColor));var T='<span class="'+L+'-icon" style="width:'+o.svgSize+";height:"+o.svgSize+';">'+B+"</span>",X="";0<C.length&&(C=C.length>o.messageMaxLength?y(C).substring(0,o.messageMaxLength)+"...":y(C),X='<span style="font-size:'+o.messageFontSize+";color:"+o.messageColor+';" class="'+L+'-message">'+C+"</span>"),D++;var F=t.document.createElement("div");F.id=p.ID+"-"+D,F.className=L+"-wrap"+(o.cssAnimation?" nx-with-animation":""),F.style.position=o.position,F.style.zIndex=o.zindex,F.style.background=o.backgroundColor,F.style.animationDuration=o.cssAnimationDuration+"ms",F.style.fontFamily='"'+o.fontFamily+'", '+s,F.style.display="flex",F.style.flexWrap="wrap",F.style.flexDirection="column",F.style.alignItems="center",F.style.justifyContent="center",o.rtl&&(F.setAttribute("dir","rtl"),F.classList.add("nx-rtl-on")),F.innerHTML=T+X;var j=t.getComputedStyle(I).getPropertyValue("position"),O="string"==typeof j?j.toLocaleLowerCase("en"):"relative",H=Math.round(1.25*parseInt(o.svgSize))+40,V="";H>(I.offsetHeight||0)&&(V="min-height:"+H+"px;");var P;P=I.getAttribute("id")?"#"+I.getAttribute("id"):I.classList[0]?"."+I.classList[0]:(I.tagName||"").toLocaleLowerCase("en");var U="",Q=-1>=["absolute","relative","fixed","sticky"].indexOf(O);if(Q||0<V.length){if(!u("head"))return!1;Q&&(U="position:relative!important;");var Y='<style id="Style-'+p.ID+"-"+D+'">'+P+"."+L+"-position{"+U+V+"}</style>",q=t.document.createRange();q.selectNode(t.document.head);var G=q.createContextualFragment(Y);t.document.head.appendChild(G),I.classList.add(L+"-position")}I.appendChild(F)}}}else var K=function(e){var i=setTimeout(function(){null!==e.parentNode&&e.parentNode.removeChild(e);var a=e.getAttribute("id"),n=t.document.getElementById("Style-"+a);n&&null!==n.parentNode&&n.parentNode.removeChild(n),clearTimeout(i)},o.cssAnimationDuration)},$=function(t){if(t&&0<t.length)for(var e,a=0;a<t.length;a++)(e=t[a])&&(e.classList.add("nx-remove"),K(e));else d("string"==typeof i?'"Notiflix.Block.remove();" function called with "'+i+'" selector, but this selector does not have a "Block" element to remove.':'"Notiflix.Block.remove();" function called with "'+i+'", but this "Array<HTMLElement>" or "NodeListOf<HTMLElement>" does not have a "Block" element to remove.')},J=function(t){var e=setTimeout(function(){var i=L+"-position";t.classList.remove(i),clearTimeout(e)},o.cssAnimationDuration+300)},Z=setTimeout(function(){for(var t,e=0;e<S;e++)(t=c[e])&&(J(t),M=t.querySelectorAll("[id^="+p.ID+"]"),$(M));clearTimeout(Z)},l);o=g(!0,o,f)},E={Notify:{init:function(t){e=g(!0,l,t),b(C,"NotiflixNotifyInternalCSS")},merge:function(t){return e?void(e=g(!0,e,t)):(x("You have to initialize the Notify module before call Merge function."),!1)},success:function(t,e,i){W(t,e,i,"Success")},failure:function(t,e,i){W(t,e,i,"Failure")},warning:function(t,e,i){W(t,e,i,"Warning")},info:function(t,e,i){W(t,e,i,"Info")}},Report:{init:function(t){i=g(!0,c,t),b(S,"NotiflixReportInternalCSS")},merge:function(t){return i?void(i=g(!0,i,t)):(x("You have to initialize the Report module before call Merge function."),!1)},success:function(t,e,i,a,n){I(t,e,i,a,n,"Success")},failure:function(t,e,i,a,n){I(t,e,i,a,n,"Failure")},warning:function(t,e,i,a,n){I(t,e,i,a,n,"Warning")},info:function(t,e,i,a,n){I(t,e,i,a,n,"Info")}},Confirm:{init:function(t){a=g(!0,m,t),b(R,"NotiflixConfirmInternalCSS")},merge:function(t){return a?void(a=g(!0,a,t)):(x("You have to initialize the Confirm module before call Merge function."),!1)},show:function(t,e,i,a,n,o,r){A(t,e,i,a,n,o,r,!1,!1)},ask:function(t,e,i,a,n,o,r,s){A(t,e,a,n,o,r,s,!0,i)}},Loading:{init:function(t){n=g(!0,f,t),b(M,"NotiflixLoadingInternalCSS")},merge:function(t){return n?void(n=g(!0,n,t)):(x("You have to initialize the Loading module before call Merge function."),!1)},standard:function(t,e){B(t,e,"standard",!0,0)},hourglass:function(t,e){B(t,e,"hourglass",!0,0)},circle:function(t,e){B(t,e,"circle",!0,0)},arrows:function(t,e){B(t,e,"arrows",!0,0)},dots:function(t,e){B(t,e,"dots",!0,0)},pulse:function(t,e){B(t,e,"pulse",!0,0)},custom:function(t,e){B(t,e,"custom",!0,0)},notiflix:function(t,e){B(t,e,"notiflix",!0,0)},remove:function(t){"number"!=typeof t&&(t=0),B(null,null,null,!1,t)},change:function(t){T(t)}},Block:{init:function(t){o=g(!0,p,t),b(X,"NotiflixBlockInternalCSS")},merge:function(t){return o?void(o=g(!0,o,t)):(x('You have to initialize the "Notiflix.Block" module before call Merge function.'),!1)},standard:function(t,e,i){F(!0,t,"standard",e,i)},hourglass:function(t,e,i){F(!0,t,"hourglass",e,i)},circle:function(t,e,i){F(!0,t,"circle",e,i)},arrows:function(t,e,i){F(!0,t,"arrows",e,i)},dots:function(t,e,i){F(!0,t,"dots",e,i)},pulse:function(t,e,i){F(!0,t,"pulse",e,i)},remove:function(t,e){"number"!=typeof e&&(e=0),F(!1,t,null,null,null,e)}}};return"object"==typeof t.Notiflix?g(!0,t.Notiflix,{Notify:E.Notify,Report:E.Report,Confirm:E.Confirm,Loading:E.Loading,Block:E.Block}):{Notify:E.Notify,Report:E.Report,Confirm:E.Confirm,Loading:E.Loading,Block:E.Block}});
},{}],"nUSU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.changeLanguage=a,exports.notifyMovieFound=c,exports.notifyLoginRu=d,exports.notifyAccept=y,exports.notifyLoggedIn=p,exports.notifyLoggedOut=g,exports.notifyAvailabe=h,exports.notifyMovieQueue=N,exports.notifyErrData=m,exports.notifySearchError=x,exports.notifyMovie=v,exports.notifyWarning=w,exports.notifyDeleteMovie=L,exports.notifyDeleteQueue=b;var e=require("./fetch-api"),t=require("./header/filter"),o=u(require("notiflix"));function u(e){return e&&e.__esModule?e:{default:e}}e.fetchApi.lang="ru";const i={home:{en:"home",ru:"Главная"},library:{en:"My library",ru:"Моя библиотека"},input:{en:"Search movies...",ru:"Поиск..."},watch:{en:"Watched",ru:"Просмотренные"},queue:{en:"queue",ru:"на очереди"},reserved:{en:"All Rights Reserved",ru:"Все права защищены"},develop:{en:"Developed with",ru:"Разработано с"},login:{en:"Login",ru:"Войти"},password:{en:"Password",ru:"Пароль"},log:{en:"Log out",ru:"Выйти"},loginRu:{en:"Login",ru:"Регистрация"},form:{en:"Form",ru:""},loginUp:{en:"Login",ru:"Логин"},signUp:{en:"Sign Up",ru:"Войти"}},n=["en","ru"],f=document.querySelector(".select");function s(e){let t=f.value;location.href=window.location.pathname+"#"+t,location.reload()}function a(){let o=window.location.hash;o=o.substr(1),n.includes(o)||(location.href=window.location.pathname+"#en",location.reload()),e.fetchApi.lang=o,(0,t.setGenresList)(),f.value=o;for(let e in i){let t=document.querySelector(".lang-"+e);t&&(t.innerHTML=i[e][o])}}function r(){"ru"===e.fetchApi.lang&&(t.filterSelect.config.placeholderText="Фильтр по жанрам")}f.addEventListener("change",s),a(),(0,t.setGenresList)(),o.default.Notify.init({className:"notiflix-notify",timeout:3e3,width:"220px",position:"right-bottom",distance:"50px",closeButton:!1}),r();const l="en"===e.fetchApi.lang;function c(){l?o.default.Notify.failure("You have no saved movies"):o.default.Notify.failure("У вас еще нет сохраненных фильмов")}function d(){l?o.default.Notify.failure("You are not logged in"):o.default.Notify.failure("Вы не авторизованы")}function y(){l?o.default.Report.success("You are successfully signed up"):o.default.Report.success("Вы успешно зарегистрировались")}function p(){l?o.default.Report.success("You are successfully logged in"):o.default.Report.success("Вы успешно вошли в систему")}function g(){l?o.default.Notify.success("You are successfully logged out"):o.default.Notify.success("Вы успешно вышли из системы")}function h(){l?o.default.Notify.failure("No data available"):o.default.Notify.failure("Данные недоступны")}function N(){l?o.default.Notify.success("The movie successfully added to the queue"):o.default.Notify.success("Фильм успешно добавлен в очередь")}function v(){l?o.default.Notify.success("The movie successfully added to watched"):o.default.Notify.success("Фильм успешно добавлен в просмотренные")}function m(){l?o.default.Notify.failure("Error adding to database: "):o.default.Notify.failure("Ошибка добавления в базу данных: ")}function x(){l?o.default.Notify.failure("No results for your request"):o.default.Notify.failure("Нет результатов по вашему запросу")}function w(){l?o.default.Notify.warning("You should log in to be able to add a movie to a library"):o.default.Notify.warning("Вы должны войти в систему, чтобы добавить фильм в библиотеку.")}function L(e){l?o.default.Notify.success("The movie was deleted from watched"):o.default.Notify.success("Фильм удален из списка просмотренных")}function b(e){l?o.default.Notify.success("The movie was deleted from queue"):o.default.Notify.success("Фильм удален из очереди")}
},{"./fetch-api":"ye0o","./header/filter":"ZO32","notiflix":"ja4j"}],"N8YO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.initScrollBtn=d,exports.checkIsTop=n;var o=e(require("./refs"));function e(o){return o&&o.__esModule?o:{default:o}}let t,s=!0,l=!1;function r(){s?window.scrollTo({top:t,behavior:"smooth"}):(t=window.scrollY,window.scrollTo({top:0,behavior:"smooth"}))}function n(){i(),window.scrollY<1e3?(s=!0,l||o.default.scrollBtn.classList.add("is-hidden")):(s=!1,o.default.scrollBtn.classList.remove("is-hidden"))}function i(){s?o.default.scrollBtn.classList.add("arrow-down"):o.default.scrollBtn.classList.remove("arrow-down","is-hidden")}function d(){i(),o.default.scrollBtn.addEventListener("click",()=>{l=!0,r()})}
},{"./refs":"VyiV"}],"u2ZQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.otherGenresLang=f,exports.onSpinerFunction=c,exports.mainMarkup=d,exports.addGenresToData=m;var e=require("../header/filter"),t=require("../fetch-api.js");require("js-loading-overlay");var r=o(require("../../templates/film-card.hbs")),n=o(require("lodash.debounce")),i=o(require("../refs")),a=require("../translate"),s=require("../scroll");function o(e){return e&&e.__esModule?e:{default:e}}function c(e){p(),setTimeout(()=>{e&&JsLoadingOverlay.hide()},250)}function l(r){r.preventDefault(),i.default.gallery.innerHTML="",e.filterSelect.set([]),t.fetchApi.page=1,t.fetchApi.query=r.target.elements.query.value,t.fetchApi.markupedMovies=[],c(u())}async function u(){0===(await(0,t.fetchSearch)()).length&&1===t.fetchApi.page&&(0,a.notifySearchError)(),i.default.gallery.insertAdjacentHTML("beforeend",(0,r.default)(await m(await(0,t.fetchSearch)())))}function f(){return"en"===t.fetchApi.lang?", Other":", другие"}async function d(){i.default.gallery.insertAdjacentHTML("beforeend",(0,r.default)(await m(await(0,t.fetchTrending)())))}function p(){JsLoadingOverlay.show({spinnerIcon:"ball-spin",overlayBackgroundColor:"#666666",overlayOpacity:.2,spinnerColor:"#fff",spinnerSize:"2x",overlayIDName:"overlay",spinnerIDName:"spinner"})}function h(){document.documentElement.getBoundingClientRect().bottom<document.documentElement.clientHeight+150&&(t.fetchApi.page++,p(),setTimeout(()=>{i.default.searchForm.classList.contains("is-hidden")||(""===t.fetchApi.query&&""===t.fetchApi.genres?d():""!==t.fetchApi.query?u():(0,e.filterMarkup)()),JsLoadingOverlay.hide()},250))}t.fetchApi.markupedMovies=[],c(d()),i.default.searchForm.addEventListener("submit",l),(0,a.changeLanguage)();let g=(0,n.default)(h,250);async function m(e){const r=await(0,t.fetchGenre)();return e.filter((e,n,i)=>{if(e.genres=e.genre_ids.map(e=>r.find(t=>t.id===e).name),0===e.genres.length){const t=f();e.genres=t.slice(2)}else e.genres.length>3?e.genres=e.genres.splice(0,2).join(", ")+f():e.genres=e.genres.join(", ");if(e.release_date=e.release_date&&e.release_date.slice(0,4),1===t.fetchApi.page&&t.fetchApi.markupedMovies.push(e),t.fetchApi.page>1){if(t.fetchApi.markupedMovies.find(t=>t.id===e.id))return!1;t.fetchApi.markupedMovies.push(e)}return e})}(0,s.checkIsTop)(),(0,s.initScrollBtn)(),window.addEventListener("scroll",()=>{g(),(0,s.checkIsTop)()});
},{"../header/filter":"ZO32","../fetch-api.js":"ye0o","js-loading-overlay":"XwMB","../../templates/film-card.hbs":"fFoL","lodash.debounce":"PZFh","../refs":"VyiV","../translate":"nUSU","../scroll":"N8YO"}],"N0LX":[function(require,module,exports) {
"use strict";var e=d(require("../refs")),a=require("../container/mainMarkup"),r=require("../header/filter");function d(e){return e&&e.__esModule?e:{default:e}}function i(d){d.preventDefault(),e.default.gallery.innerHTML="",e.default.searchInput.value="",r.filterSelect.set([]),(0,a.onSpinerFunction)((0,a.mainMarkup)()),e.default.libraryBtns.classList.add("is-hidden"),e.default.searchForm.classList.remove("is-hidden"),e.default.filter.classList.remove("is-hidden"),e.default.headerBackground.classList.remove("header-background--library"),e.default.headerBackground.classList.add("header-background--home"),e.default.libraryLink.classList.remove("header-links__link--current"),e.default.homeLink.classList.add("header-links__link--current")}function s(a){a.preventDefault(),e.default.libraryBtns.classList.remove("is-hidden"),e.default.searchForm.classList.add("is-hidden"),e.default.filter.classList.add("is-hidden"),e.default.headerBackground.classList.remove("header-background--home"),e.default.headerBackground.classList.add("header-background--library"),e.default.homeLink.classList.remove("header-links__link--current"),e.default.libraryLink.classList.add("header-links__link--current")}e.default.homeLink.addEventListener("click",i),e.default.libraryLink.addEventListener("click",s);
},{"../refs":"VyiV","../container/mainMarkup":"u2ZQ","../header/filter":"ZO32"}],"ToPQ":[function(require,module,exports) {
const e={LIGHT:"light-theme",DARK:"dark-theme"},t=document.body.classList,c=document.querySelector("#theme-switch-toggle");function a(c){if(c.target.checked)return t.replace(e.LIGHT,e.DARK),void localStorage.setItem("theme",e.DARK);t.replace(e.DARK,e.LIGHT),localStorage.setItem("theme",e.LIGHT)}t.add(null===localStorage.getItem("theme")?e.LIGHT:localStorage.getItem("theme")),t.value===e.DARK&&(c.checked=!0),c.addEventListener("change",a);
},{}],"YrcB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var l=n(require("handlebars/dist/handlebars.runtime"));function n(l){return l&&l.__esModule?l:{default:l}}const a=l.default.template({1:function(l,n,a,e,t){var o,s=null!=n?n:l.nullContext||{},i=l.hooks.helperMissing,c="function",m=l.escapeExpression,u=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return"      <li class='team-modal__item'>\n        <div class='team-modal__thumb'>\n          <div class='img__thumb'><img\n              class='team-modal__img'\n              src='"+m(typeof(o=null!=(o=u(a,"foto")||(null!=n?u(n,"foto"):n))?o:i)===c?o.call(s,{name:"foto",hash:{},data:t,loc:{start:{line:9,column:19},end:{line:9,column:27}}}):o)+"'\n              alt='"+m(typeof(o=null!=(o=u(a,"name")||(null!=n?u(n,"name"):n))?o:i)===c?o.call(s,{name:"name",hash:{},data:t,loc:{start:{line:10,column:19},end:{line:10,column:27}}}):o)+"'\n            /></div>\n          <div class='overlay'>\n            <div class='team-modal__content'>\n              <h3 class='team-modal___title-overlay'>"+m(typeof(o=null!=(o=u(a,"location")||(null!=n?u(n,"location"):n))?o:i)===c?o.call(s,{name:"location",hash:{},data:t,loc:{start:{line:14,column:53},end:{line:14,column:65}}}):o)+"</h3>\n              <div class='team-modal_contacts'>\n                <a class='team-modal__tel link' href='tel:"+m(typeof(o=null!=(o=u(a,"tel")||(null!=n?u(n,"tel"):n))?o:i)===c?o.call(s,{name:"tel",hash:{},data:t,loc:{start:{line:16,column:58},end:{line:16,column:65}}}):o)+"'>"+m(typeof(o=null!=(o=u(a,"tel")||(null!=n?u(n,"tel"):n))?o:i)===c?o.call(s,{name:"tel",hash:{},data:t,loc:{start:{line:16,column:67},end:{line:16,column:74}}}):o)+"</a>\n                <br />\n                <a\n                  class='team-modal__email link'\n                  href='mailto:"+m(typeof(o=null!=(o=u(a,"mail")||(null!=n?u(n,"mail"):n))?o:i)===c?o.call(s,{name:"mail",hash:{},data:t,loc:{start:{line:20,column:31},end:{line:20,column:39}}}):o)+"'\n                >"+m(typeof(o=null!=(o=u(a,"mail")||(null!=n?u(n,"mail"):n))?o:i)===c?o.call(s,{name:"mail",hash:{},data:t,loc:{start:{line:21,column:17},end:{line:21,column:25}}}):o)+"</a>\n              </div>\n              <div class='social'>\n                <ul class='social__list'>\n                  <li class='social__item'>\n                    <a\n                      href='"+m(typeof(o=null!=(o=u(a,"linkedin")||(null!=n?u(n,"linkedin"):n))?o:i)===c?o.call(s,{name:"linkedin",hash:{},data:t,loc:{start:{line:27,column:28},end:{line:27,column:40}}}):o)+"'\n                      class='social__link'\n                      target='_blank'\n                      rel='noopener noreferrer'\n                    ><svg class='social__logo' viewBox='0 0 24 24'>\n                        <path\n                          d='M19 3A2 2 0 0 1 21 5V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H19M18.5 18.5V13.2A3.26 3.26 0 0 0 15.24 9.94C14.39 9.94 13.4 10.46 12.92 11.24V10.13H10.13V18.5H12.92V13.57C12.92 12.8 13.54 12.17 14.31 12.17A1.4 1.4 0 0 1 15.71 13.57V18.5H18.5M6.88 8.56A1.68 1.68 0 0 0 8.56 6.88C8.56 5.95 7.81 5.19 6.88 5.19A1.69 1.69 0 0 0 5.19 6.88C5.19 7.81 5.95 8.56 6.88 8.56M8.27 18.5V10.13H5.5V18.5H8.27Z'\n                        ></path>\n                      </svg></a>\n                  </li>\n                  <li class='social__item'>\n                    <a\n                      href='"+m(typeof(o=null!=(o=u(a,"github")||(null!=n?u(n,"github"):n))?o:i)===c?o.call(s,{name:"github",hash:{},data:t,loc:{start:{line:39,column:28},end:{line:39,column:38}}}):o)+"'\n                      class='social__link social__link--git'\n                      target='_blank'\n                      rel='noopener noreferrer'\n                    ><svg\n                        class='social__logo social__logo--git'\n                        viewBox='0 0 24 24'\n                      >\n                        <path\n                          d='M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z'\n                        ></path>\n                      </svg></a>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class='info'>\n          <span class='message'>\n            <a href='#'><i class='fas fa-envelope-open'></i></a>\n          </span>\n          <h3 class='team-modal__name'>"+m(typeof(o=null!=(o=u(a,"name")||(null!=n?u(n,"name"):n))?o:i)===c?o.call(s,{name:"name",hash:{},data:t,loc:{start:{line:61,column:39},end:{line:61,column:47}}}):o)+"</h3>\n          <p class='team-modal__role'>"+m(typeof(o=null!=(o=u(a,"role")||(null!=n?u(n,"role"):n))?o:i)===c?o.call(s,{name:"role",hash:{},data:t,loc:{start:{line:62,column:38},end:{line:62,column:46}}}):o)+"</p>\n        </div>\n      </li>\n"},compiler:[8,">= 4.3.0"],main:function(l,n,a,e,t){var o;return"<div class='team-modal'>\n  <h1 class='team-modal__heading'>Our <span>Team</span></h1>\n  <ul class='team-modal__list'>\n"+(null!=(o=(l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]})(a,"each").call(null!=n?n:l.nullContext||{},n,{name:"each",hash:{},fn:l.program(1,t,0),inverse:l.noop,data:t,loc:{start:{line:4,column:4},end:{line:65,column:13}}}))?o:"")+"  </ul>\n</div>"},useData:!0});var e=a;exports.default=e;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"s2Sp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var l=n(require("handlebars/dist/handlebars.runtime"));function n(l){return l&&l.__esModule?l:{default:l}}const a=l.default.template({1:function(l,n,a,e,t){var o,s=null!=n?n:l.nullContext||{},i=l.hooks.helperMissing,c="function",m=l.escapeExpression,u=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return"      <li class='team-modal__item'>\n        <div class='team-modal__thumb'>\n          <div class='img__thumb'><img\n              class='team-modal__img'\n              src='"+m(typeof(o=null!=(o=u(a,"foto")||(null!=n?u(n,"foto"):n))?o:i)===c?o.call(s,{name:"foto",hash:{},data:t,loc:{start:{line:9,column:19},end:{line:9,column:27}}}):o)+"'\n              alt='"+m(typeof(o=null!=(o=u(a,"name")||(null!=n?u(n,"name"):n))?o:i)===c?o.call(s,{name:"name",hash:{},data:t,loc:{start:{line:10,column:19},end:{line:10,column:27}}}):o)+"'\n            /></div>\n          <div class='overlay'>\n            <div class='team-modal__content'>\n              <h3 class='team-modal___title-overlay'>"+m(typeof(o=null!=(o=u(a,"location")||(null!=n?u(n,"location"):n))?o:i)===c?o.call(s,{name:"location",hash:{},data:t,loc:{start:{line:14,column:53},end:{line:14,column:65}}}):o)+"</h3>\n              <div class='team-modal_contacts'>\n                <a class='team-modal__tel link' href='tel:"+m(typeof(o=null!=(o=u(a,"tel")||(null!=n?u(n,"tel"):n))?o:i)===c?o.call(s,{name:"tel",hash:{},data:t,loc:{start:{line:16,column:58},end:{line:16,column:65}}}):o)+"'>"+m(typeof(o=null!=(o=u(a,"tel")||(null!=n?u(n,"tel"):n))?o:i)===c?o.call(s,{name:"tel",hash:{},data:t,loc:{start:{line:16,column:67},end:{line:16,column:74}}}):o)+"</a>\n                <br />\n                <a\n                  class='team-modal__email link'\n                  href='mailto:"+m(typeof(o=null!=(o=u(a,"mail")||(null!=n?u(n,"mail"):n))?o:i)===c?o.call(s,{name:"mail",hash:{},data:t,loc:{start:{line:20,column:31},end:{line:20,column:39}}}):o)+"'\n                >"+m(typeof(o=null!=(o=u(a,"mail")||(null!=n?u(n,"mail"):n))?o:i)===c?o.call(s,{name:"mail",hash:{},data:t,loc:{start:{line:21,column:17},end:{line:21,column:25}}}):o)+"</a>\n              </div>\n              <div class='social'>\n                <ul class='social__list'>\n                  <li class='social__item'>\n                    <a\n                      href='"+m(typeof(o=null!=(o=u(a,"linkedin")||(null!=n?u(n,"linkedin"):n))?o:i)===c?o.call(s,{name:"linkedin",hash:{},data:t,loc:{start:{line:27,column:28},end:{line:27,column:40}}}):o)+"'\n                      class='social__link'\n                      target='_blank'\n                      rel='noopener noreferrer'\n                    ><svg class='social__logo' viewBox='0 0 24 24'>\n                        <path\n                          d='M19 3A2 2 0 0 1 21 5V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H19M18.5 18.5V13.2A3.26 3.26 0 0 0 15.24 9.94C14.39 9.94 13.4 10.46 12.92 11.24V10.13H10.13V18.5H12.92V13.57C12.92 12.8 13.54 12.17 14.31 12.17A1.4 1.4 0 0 1 15.71 13.57V18.5H18.5M6.88 8.56A1.68 1.68 0 0 0 8.56 6.88C8.56 5.95 7.81 5.19 6.88 5.19A1.69 1.69 0 0 0 5.19 6.88C5.19 7.81 5.95 8.56 6.88 8.56M8.27 18.5V10.13H5.5V18.5H8.27Z'\n                        ></path>\n                      </svg></a>\n                  </li>\n                  <li class='social__item'>\n                    <a\n                      href='"+m(typeof(o=null!=(o=u(a,"github")||(null!=n?u(n,"github"):n))?o:i)===c?o.call(s,{name:"github",hash:{},data:t,loc:{start:{line:39,column:28},end:{line:39,column:38}}}):o)+"'\n                      class='social__link social__link--git'\n                      target='_blank'\n                      rel='noopener noreferrer'\n                    ><svg\n                        class='social__logo social__logo--git'\n                        viewBox='0 0 24 24'\n                      >\n                        <path\n                          d='M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z'\n                        ></path>\n                      </svg></a>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class='info'>\n          <span class='message'>\n            <a href='#'><i class='fas fa-envelope-open'></i></a>\n          </span>\n          <h3 class='team-modal__name'>"+m(typeof(o=null!=(o=u(a,"name")||(null!=n?u(n,"name"):n))?o:i)===c?o.call(s,{name:"name",hash:{},data:t,loc:{start:{line:61,column:39},end:{line:61,column:47}}}):o)+"</h3>\n          <p class='team-modal__role'>"+m(typeof(o=null!=(o=u(a,"role")||(null!=n?u(n,"role"):n))?o:i)===c?o.call(s,{name:"role",hash:{},data:t,loc:{start:{line:62,column:38},end:{line:62,column:46}}}):o)+"</p>\n        </div>\n      </li>\n"},compiler:[8,">= 4.3.0"],main:function(l,n,a,e,t){var o;return"<div class='team-modal'>\n  <h1 class='team-modal__heading'>Наша <span>Команда</span></h1>\n  <ul class='team-modal__list'>\n"+(null!=(o=(l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]})(a,"each").call(null!=n?n:l.nullContext||{},n,{name:"each",hash:{},fn:l.program(1,t,0),inverse:l.noop,data:t,loc:{start:{line:4,column:4},end:{line:65,column:13}}}))?o:"")+"  </ul>\n</div>"},useData:!0});var e=a;exports.default=e;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"BjeX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=n(require("handlebars/dist/handlebars.runtime"));function n(t){return t&&t.__esModule?t:{default:t}}const l=t.default.template({1:function(t,n,l,e,o){var a=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return"              "+t.escapeExpression(t.lambda(null!=n?a(n,"name"):n,n))+"\n"},compiler:[8,">= 4.3.0"],main:function(t,n,l,e,o){var a,i,s=t.escapeExpression,d=null!=n?n:t.nullContext||{},u=t.hooks.helperMissing,m="function",r=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return"<div class='modal-movie'>\n  <div class='wrapper-image'>\n    <img\n      class='modal-movie__poster'\n      src='https://image.tmdb.org/t/p/w500"+s(t.lambda(null!=n?r(n,"poster_path"):n,n))+"'\n      alt='No poster for movie "+s(typeof(i=null!=(i=r(l,"title")||(null!=n?r(n,"title"):n))?i:u)===m?i.call(d,{name:"title",hash:{},data:o,loc:{start:{line:6,column:31},end:{line:6,column:40}}}):i)+"'\n    />\n  </div>\n  <div class='modal-movie__right-content'>\n    <p class='modal-movie__name'>"+s(typeof(i=null!=(i=r(l,"title")||(null!=n?r(n,"title"):n))?i:u)===m?i.call(d,{name:"title",hash:{},data:o,loc:{start:{line:10,column:33},end:{line:10,column:42}}}):i)+"</p>\n    <div class='modal-movie__data'>\n\n      <table class='modal-movie__table'>\n        <tr>\n          <td class='modal-movie__indicators--item'>Vote / Votes</td>\n          <td class='modal-movie__votes'><span\n              class='vote'\n            >"+s(typeof(i=null!=(i=r(l,"vote_average")||(null!=n?r(n,"vote_average"):n))?i:u)===m?i.call(d,{name:"vote_average",hash:{},data:o,loc:{start:{line:18,column:13},end:{line:18,column:29}}}):i)+"</span><span class='modal-movie__slash'> /</span>\n            "+s(typeof(i=null!=(i=r(l,"vote_count")||(null!=n?r(n,"vote_count"):n))?i:u)===m?i.call(d,{name:"vote_count",hash:{},data:o,loc:{start:{line:19,column:12},end:{line:19,column:26}}}):i)+"</td>\n        </tr>\n        <tr>\n          <td class='modal-movie__indicators--item'>Popularity</td>\n          <td class='modal-movie__popularity'>"+s(typeof(i=null!=(i=r(l,"popularity")||(null!=n?r(n,"popularity"):n))?i:u)===m?i.call(d,{name:"popularity",hash:{},data:o,loc:{start:{line:23,column:46},end:{line:23,column:60}}}):i)+"</td>\n        </tr>\n        <tr>\n          <td class='modal-movie__indicators--item'>Original Title</td>\n          <td class='modal-movie__title'>"+s(typeof(i=null!=(i=r(l,"original_title")||(null!=n?r(n,"original_title"):n))?i:u)===m?i.call(d,{name:"original_title",hash:{},data:o,loc:{start:{line:27,column:41},end:{line:27,column:59}}}):i)+"</td>\n        </tr>\n        <tr>\n          <td\n            class='modal-movie__indicators--item modal-movie__indicators--last-item'\n          >Genre</td>\n          <td class='modal-movie__genre'>\n"+(null!=(a=r(l,"each").call(d,null!=n?r(n,"genres"):n,{name:"each",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o,loc:{start:{line:34,column:12},end:{line:36,column:21}}}))?a:"")+"          </td>\n        </tr>\n\n      </table>\n\n    </div>\n    <p class='modal-movie__about'>About</p>\n    <p class='modal-movie__description'>\n      "+s(typeof(i=null!=(i=r(l,"overview")||(null!=n?r(n,"overview"):n))?i:u)===m?i.call(d,{name:"overview",hash:{},data:o,loc:{start:{line:45,column:6},end:{line:45,column:18}}}):i)+"\n    </p>\n    <div class='modal-movie__buttons'>\n      <button class='modal-movie__buttons--delete-watched modal-movie__button button button--orange lang-add visually-hidden'>\n        remove from Watched\n      </button>\n      <button class='modal-movie__buttons--watched modal-movie__button button button--orange lang-add'>\n        add to Watched\n      </button>\n      <button class='modal-movie__buttons--delete-queue modal-movie__button button button--black visually-hidden'>\n        remove from queue\n      </button>\n      <button class='modal-movie__buttons--queue modal-movie__button button button--black'>\n        add to queue\n      </button>      \n  </div>\n</div>"},useData:!0});var e=l;exports.default=e;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"IKki":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=t(require("handlebars/dist/handlebars.runtime"));function t(n){return n&&n.__esModule?n:{default:n}}const l=n.default.template({1:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return"              "+n.escapeExpression(n.lambda(null!=t?a(t,"name"):t,t))+"\n"},compiler:[8,">= 4.3.0"],main:function(n,t,l,e,o){var a,i,s=n.escapeExpression,u=null!=t?t:n.nullContext||{},d=n.hooks.helperMissing,m="function",r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return"<div class='modal-movie'>\n  <div class='wrapper-image'>\n    <img\n      class='modal-movie__poster'\n      src='https://image.tmdb.org/t/p/w500"+s(n.lambda(null!=t?r(t,"poster_path"):t,t))+"'\n      alt='No poster for movie "+s(typeof(i=null!=(i=r(l,"title")||(null!=t?r(t,"title"):t))?i:d)===m?i.call(u,{name:"title",hash:{},data:o,loc:{start:{line:6,column:31},end:{line:6,column:40}}}):i)+"'\n    />\n  </div>\n  <div class='modal-movie__right-content'>\n    <p class='modal-movie__name'>"+s(typeof(i=null!=(i=r(l,"title")||(null!=t?r(t,"title"):t))?i:d)===m?i.call(u,{name:"title",hash:{},data:o,loc:{start:{line:10,column:33},end:{line:10,column:42}}}):i)+"</p>\n    <div class='modal-movie__data'>\n\n      <table class='modal-movie__table'>\n        <tr>\n          <td class='modal-movie__indicators--item'>Рейтинг / Голоса</td>\n          <td class='modal-movie__votes'><span\n              class='vote'\n            >"+s(typeof(i=null!=(i=r(l,"vote_average")||(null!=t?r(t,"vote_average"):t))?i:d)===m?i.call(u,{name:"vote_average",hash:{},data:o,loc:{start:{line:18,column:13},end:{line:18,column:29}}}):i)+"</span><span class='modal-movie__slash'> /</span>\n            "+s(typeof(i=null!=(i=r(l,"vote_count")||(null!=t?r(t,"vote_count"):t))?i:d)===m?i.call(u,{name:"vote_count",hash:{},data:o,loc:{start:{line:19,column:12},end:{line:19,column:26}}}):i)+"</td>\n        </tr>\n        <tr>\n          <td class='modal-movie__indicators--item'>Популярность</td>\n          <td class='modal-movie__popularity'>"+s(typeof(i=null!=(i=r(l,"popularity")||(null!=t?r(t,"popularity"):t))?i:d)===m?i.call(u,{name:"popularity",hash:{},data:o,loc:{start:{line:23,column:46},end:{line:23,column:60}}}):i)+"</td>\n        </tr>\n        <tr>\n          <td class='modal-movie__indicators--item'>Оригинальное название</td>\n          <td class='modal-movie__title'>"+s(typeof(i=null!=(i=r(l,"original_title")||(null!=t?r(t,"original_title"):t))?i:d)===m?i.call(u,{name:"original_title",hash:{},data:o,loc:{start:{line:27,column:41},end:{line:27,column:59}}}):i)+"</td>\n        </tr>\n        <tr>\n          <td\n            class='modal-movie__indicators--item modal-movie__indicators--last-item'\n          >Жанры</td>\n          <td class='modal-movie__genre'>\n"+(null!=(a=r(l,"each").call(u,null!=t?r(t,"genres"):t,{name:"each",hash:{},fn:n.program(1,o,0),inverse:n.noop,data:o,loc:{start:{line:34,column:12},end:{line:36,column:21}}}))?a:"")+"          </td>\n        </tr>\n\n      </table>\n\n    </div>\n    <p class='modal-movie__about'>О фильме</p>\n    <p class='modal-movie__description'>\n      "+s(typeof(i=null!=(i=r(l,"overview")||(null!=t?r(t,"overview"):t))?i:d)===m?i.call(u,{name:"overview",hash:{},data:o,loc:{start:{line:45,column:6},end:{line:45,column:18}}}):i)+"\n    </p>\n    <div class='modal-movie__buttons modal-movie__buttons--rus'>\n      <button\n        class='modal-movie__buttons--watched modal-movie__button button button--orange'\n      >\n        В просмотренные\n      </button>\n      <button class='modal-movie__buttons--delete-watched modal-movie__button button button--orange lang-add visually-hidden'>\n        удалить из просмотренного\n      </button>\n      <button\n        class='modal-movie__buttons--queue modal-movie__button button button--black'\n      >\n        В очередь\n      </button>\n      <button class='modal-movie__buttons--delete-queue modal-movie__button button button--black visually-hidden'>\n        удалить из очереди\n      </button>\n  </div>\n</div>"},useData:!0});var e=l;exports.default=e;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"yOA5":[function(require,module,exports) {
module.exports=[{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Ftatjana_borisova.jpg?alt=media&token=4f7f9863-75c8-4cb6-b15b-bd9774422e23",name:"Борисова Татьяна",location:"Берлин, Германия",tel:"+4915140003182",mail:"0102tb@gmail.com",linkedin:"https://www.linkedin.com/in/tatiana-borisova-54b374223/",github:"https://github.com/tatiana-borisova",role:"Тимлид"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fpolina_dudchenko.jpg?alt=media&token=f8acd66d-f9f4-4bf9-ac78-7549130d89d0",name:"Дудченко Полина",location:"Гейдельберг, Германия",tel:"+491636938134",mail:"pv.dudchenko@gmail.com",linkedin:"https://www.linkedin.com/in/polina-dudchenko-08a0a998/",github:"https://github.com/polinadudchenko",role:"Скрам мастер, разработчик"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fkaterina_belka.jpg?alt=media&token=1dc1a3f8-31e8-40b7-88ae-608be5c8a0fc",name:"Белка Екатерина",location:"Киев, Украина",tel:"+380954206828",mail:"loskaa@i.ua",linkedin:"https://www.linkedin.com/in/%D0%B5%D0%BA%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%BD%D0%B0-%D0%B1%D0%B5%D0%BB%D0%BA%D0%B0-23671b61/",github:"https://github.com/BielkaKate",role:"Разработчик"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fvladimir_kulagin.jpg?alt=media&token=30525c31-7695-4415-acc8-260a293f11e3",name:"Кулагин Владимир",location:"Киев, Украина",tel:"+380637665744",mail:"vladimyrkulagin@gmail.com",linkedin:"https://www.linkedin.com/in/%D0%B2%D0%BB%D0%B0%D0%B4%D0%B8%D0%BC%D0%B8%D1%80-%D0%BA%D1%83%D0%BB%D0%B0%D0%B3%D0%B8%D0%BD-300b74100/",github:"https://github.com/VladimyrK",role:"Разработчик"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fvlad_diorditsa.jpg?alt=media&token=8513a5a7-e1d1-42ca-ae73-8f8ceba64d69",name:"Диордица Владислав",location:"Сумы, Украина",tel:"+380668457397",mail:"doctorfat13@gmail.com",linkedin:"https://www.linkedin.com/in/diorditsa-vlad-177988211/",github:"https://github.com/DiorditsaVlad",role:"Разработчик"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fantonina_ziuz.jpg?alt=media&token=941908b9-ce48-4a5b-bbe1-630765f7f596",name:"Зюзь Антонина",location:"Кельце, Польша",tel:"+48883487852",mail:"1993ziuz@gmail.com",linkedin:"https://www.linkedin.com/in/toni-stark-06121b223/",github:"https://github.com/Toni1993",role:"Разработчик"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fbohdan_klymenko.jpg?alt=media&token=79ddd5e7-87e2-4694-89bb-7bfe018b50c0",name:"Клименко Богдан",location:"Киев, Украина",tel:"+380630216454",mail:"bgdn789@gmail.com ",linkedin:"https://www.linkedin.com/in/bohdan-klymenko-1a6147223   ",github:"https://github.com/BohdanKlymenko",role:"Разработчик"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fyana_necheeva.jpg?alt=media&token=9cb364ac-4958-404a-8673-b3e7f6222441",name:"Нечвеева Яна",location:"Киев, Украина",tel:"+380983023214",mail:"yana1112pstr@gmail.com",linkedin:"https://www.linkedin.com/in/yana-nechveeva-657442207/",github:"https://github.com/Yana1112pstr",role:"Разработчик"}];
},{}],"loKf":[function(require,module,exports) {
module.exports=[{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Ftatjana_borisova.jpg?alt=media&token=4f7f9863-75c8-4cb6-b15b-bd9774422e23",name:"Tatiana Borisova",location:"Berlin, Germany",tel:"+4915140003182",mail:"0102tb@gmail.com",linkedin:"https://www.linkedin.com/in/tatiana-borisova-54b374223/",github:"https://github.com/tatiana-borisova",role:"Team lead"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fpolina_dudchenko.jpg?alt=media&token=f8acd66d-f9f4-4bf9-ac78-7549130d89d0",name:"Polina Dudchenko",location:"Heidelberg, Germany",tel:"+491636938134",mail:"pv.dudchenko@gmail.com",linkedin:"https://www.linkedin.com/in/polina-dudchenko-08a0a998/",github:"https://github.com/polinadudchenko",role:"Scrum master, developer"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fkaterina_belka.jpg?alt=media&token=1dc1a3f8-31e8-40b7-88ae-608be5c8a0fc",name:"Kateryna Bielka",location:"Kyiv, Ukraine",tel:"+380954206828",mail:"loskaa@i.ua",linkedin:"https://www.linkedin.com/in/%D0%B5%D0%BA%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%BD%D0%B0-%D0%B1%D0%B5%D0%BB%D0%BA%D0%B0-23671b61/",github:"https://github.com/BielkaKate",role:"Developer"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fvladimir_kulagin.jpg?alt=media&token=30525c31-7695-4415-acc8-260a293f11e3",name:"Vladimir Kulagin",location:"Kyiv, Ukraine",tel:"+380637665744",mail:"vladimyrkulagin@gmail.com",linkedin:"https://www.linkedin.com/in/%D0%B2%D0%BB%D0%B0%D0%B4%D0%B8%D0%BC%D0%B8%D1%80-%D0%BA%D1%83%D0%BB%D0%B0%D0%B3%D0%B8%D0%BD-300b74100/",github:"https://github.com/VladimyrK",role:"Developer"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fvlad_diorditsa.jpg?alt=media&token=8513a5a7-e1d1-42ca-ae73-8f8ceba64d69",name:"Vladislav Diorditsa",location:"Sumy, Ukraine",tel:"+380668457397",mail:"doctorfat13@gmail.com",linkedin:"https://www.linkedin.com/in/diorditsa-vlad-177988211/",github:"https://github.com/DiorditsaVlad",role:"Developer"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fantonina_ziuz.jpg?alt=media&token=941908b9-ce48-4a5b-bbe1-630765f7f596",name:"Antonina Ziuz",location:"Kielce, Poland",tel:"+48883487852",mail:"1993ziuz@gmail.com",linkedin:"https://www.linkedin.com/in/toni-stark-06121b223/",github:"https://github.com/Toni1993",role:"Developer"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fbohdan_klymenko.jpg?alt=media&token=79ddd5e7-87e2-4694-89bb-7bfe018b50c0",name:"Bohdan Klymenko",location:"Kyiv, Ukraine",tel:"+380630216454",mail:"bgdn789@gmail.com ",linkedin:"https://www.linkedin.com/in/bohdan-klymenko-1a6147223   ",github:"https://github.com/BohdanKlymenko",role:"Developer"},{foto:"https://firebasestorage.googleapis.com/v0/b/team-project-js-f466b.appspot.com/o/team-foto%2Fyana_necheeva.jpg?alt=media&token=9cb364ac-4958-404a-8673-b3e7f6222441",name:"Yana Nechveeva",location:"Kyiv, Ukraine",tel:"+380983023214",mail:"yana1112pstr@gmail.com",linkedin:"https://www.linkedin.com/in/yana-nechveeva-657442207/",github:"https://github.com/Yana1112pstr",role:"Developer"}];
},{}],"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=i,exports.__awaiter=c,exports.__generator=u,exports.__exportStar=l,exports.__values=s,exports.__read=p,exports.__spread=y,exports.__spreadArrays=h,exports.__spreadArray=d,exports.__await=_,exports.__asyncGenerator=v,exports.__asyncDelegator=b,exports.__asyncValues=w,exports.__makeTemplateObject=x,exports.__importStar=O,exports.__importDefault=g,exports.__classPrivateFieldGet=j,exports.__classPrivateFieldSet=P,exports.__createBinding=exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};function e(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{u(n.next(t))}catch(e){a(e)}}function c(t){try{u(n.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,c)}u((n=n.apply(t,e||[])).next())})}function u(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(c){a=[6,c],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}exports.__assign=r;var f=Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]};function l(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||f(e,t,r)}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function h(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function d(t,e,r){if(r||2===arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function v(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||c(t,e)})})}function c(t,e){try{(r=o[t](e)).value instanceof _?Promise.resolve(r.value.v).then(u,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function u(t){c("next",t)}function f(t){c("throw",t)}function l(t,e){t(e),a.shift(),a.length&&c(a[0][0],a[0][1])}}function b(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:_(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof s?s(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function x(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}exports.__createBinding=f;var m=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function O(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&f(e,t,r);return m(e,t),e}function g(t){return t&&t.__esModule?t:{default:t}}function j(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}function P(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r}
},{}],"chA2":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.areCookiesEnabled=T,exports.async=tt,exports.calculateBackoffMillis=dt,exports.contains=F,exports.createMockUserToken=d,exports.createSubscribe=Y,exports.deepCopy=u,exports.deepEqual=H,exports.deepExtend=f,exports.errorPrefix=st,exports.extractQuerystring=X,exports.getGlobal=D,exports.getModularInstance=yt,exports.getUA=b,exports.isBrowser=x,exports.isBrowserExtension=g,exports.isElectron=v,exports.isEmpty=$,exports.isIE=A,exports.isIndexedDBAvailable=C,exports.isMobileCordova=_,exports.isNode=y,exports.isNodeSdk=S,exports.isReactNative=E,exports.isSafari=O,exports.isUWP=m,exports.jsonEval=I,exports.map=J,exports.ordinal=bt,exports.querystring=G,exports.querystringDecode=K,exports.safeGet=z,exports.stringify=P,exports.validateCallback=it,exports.validateContextObject=ct,exports.validateIndexedDBOpenable=w,exports.validateNamespace=nt,exports.validateArgCount=exports.stringToByteArray=exports.stringLength=exports.issuedAtTime=exports.isValidTimestamp=exports.isValidFormat=exports.isAdmin=exports.decode=exports.base64urlEncodeWithoutPadding=exports.base64Encode=exports.base64Decode=exports.base64=exports.assertionError=exports.assert=exports.Sha1=exports.RANDOM_FACTOR=exports.MAX_VALUE_MILLIS=exports.FirebaseError=exports.ErrorFactory=exports.Deferred=exports.CONSTANTS=void 0;const e={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};exports.CONSTANTS=e;const r=function(t,e){if(!t)throw o(e)};exports.assert=r;const o=function(t){return new Error("Firebase Database ("+e.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};exports.assertionError=o;const s=function(t){const e=[];let r=0;for(let o=0;o<t.length;o++){let s=t.charCodeAt(o);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=63&s|128):55296==(64512&s)&&o+1<t.length&&56320==(64512&t.charCodeAt(o+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++o)),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=63&s|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=63&s|128)}return e},n=function(t){const e=[];let r=0,o=0;for(;r<t.length;){const s=t[r++];if(s<128)e[o++]=String.fromCharCode(s);else if(s>191&&s<224){const n=t[r++];e[o++]=String.fromCharCode((31&s)<<6|63&n)}else if(s>239&&s<365){const n=((7&s)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536;e[o++]=String.fromCharCode(55296+(n>>10)),e[o++]=String.fromCharCode(56320+(1023&n))}else{const n=t[r++],i=t[r++];e[o++]=String.fromCharCode((15&s)<<12|(63&n)<<6|63&i)}}return e.join("")},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let s=0;s<t.length;s+=3){const e=t[s],n=s+1<t.length,i=n?t[s+1]:0,c=s+2<t.length,a=c?t[s+2]:0,h=e>>2,u=(3&e)<<4|i>>4;let f=(15&i)<<2|a>>6,l=63&a;c||(l=64,n||(f=64)),o.push(r[h],r[u],r[f],r[l])}return o.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):n(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let s=0;s<t.length;){const e=r[t.charAt(s++)],n=s<t.length?r[t.charAt(s)]:0,i=++s<t.length?r[t.charAt(s)]:64,c=++s<t.length?r[t.charAt(s)]:64;if(++s,null==e||null==n||null==i||null==c)throw Error();const a=e<<2|n>>4;if(o.push(a),64!==i){const t=n<<4&240|i>>2;if(o.push(t),64!==c){const t=i<<6&192|c;o.push(t)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};exports.base64=i;const c=function(t){const e=s(t);return i.encodeByteArray(e,!0)};exports.base64Encode=c;const a=function(t){return c(t).replace(/\./g,"")};exports.base64urlEncodeWithoutPadding=a;const h=function(t){try{return i.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function u(t){return f(void 0,t)}function f(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const r in e)e.hasOwnProperty(r)&&l(r)&&(t[r]=f(t[r],e[r]));return t}function l(t){return"__proto__"!==t}exports.base64Decode=h;class p{constructor(){this.reject=(()=>{}),this.resolve=(()=>{}),this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}function d(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",o=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const n=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(n)),""].join(".")}function b(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function _(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(b())}function y(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}}function x(){return"object"==typeof self&&self.self===self}function g(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function E(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function v(){return b().indexOf("Electron/")>=0}function A(){const t=b();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function m(){return b().indexOf("MSAppHost/")>=0}function S(){return!0===e.NODE_CLIENT||!0===e.NODE_ADMIN}function O(){return!y()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function C(){return"object"==typeof indexedDB}function w(){return new Promise((t,e)=>{try{let o=!0;const s="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(s);n.onsuccess=(()=>{n.result.close(),o||self.indexedDB.deleteDatabase(s),t(!0)}),n.onupgradeneeded=(()=>{o=!1}),n.onerror=(()=>{var t;e((null===(t=n.error)||void 0===t?void 0:t.message)||"")})}catch(r){e(r)}})}function T(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}function D(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}exports.Deferred=p;const N="FirebaseError";class M extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=N,Object.setPrototypeOf(this,M.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,j.prototype.create)}}exports.FirebaseError=M;class j{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},o=`${this.service}/${t}`,s=this.errors[t],n=s?k(s,r):"Error",i=`${this.serviceName}: ${n} (${o}).`;return new M(o,i,r)}}function k(t,e){return t.replace(B,(t,r)=>{const o=e[r];return null!=o?String(o):`<${r}?>`})}exports.ErrorFactory=j;const B=/\{\$([^}]+)}/g;function I(t){return JSON.parse(t)}function P(t){return JSON.stringify(t)}const L=function(t){let e={},r={},o={},s="";try{const i=t.split(".");e=I(h(i[0])||""),r=I(h(i[1])||""),s=i[2],o=r.d||{},delete r.d}catch(n){}return{header:e,claims:r,data:o,signature:s}};exports.decode=L;const V=function(t){const e=L(t).claims,r=Math.floor((new Date).getTime()/1e3);let o=0,s=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?o=e.nbf:e.hasOwnProperty("iat")&&(o=e.iat),s=e.hasOwnProperty("exp")?e.exp:o+86400),!!r&&!!o&&!!s&&r>=o&&r<=s};exports.isValidTimestamp=V;const R=function(t){const e=L(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null};exports.issuedAtTime=R;const W=function(t){const e=L(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")};exports.isValidFormat=W;const U=function(t){const e=L(t).claims;return"object"==typeof e&&!0===e.admin};function F(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function z(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function $(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function J(t,e,r){const o={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]=e.call(r,t[s],s,t));return o}function H(t,e){if(t===e)return!0;const r=Object.keys(t),o=Object.keys(e);for(const s of r){if(!o.includes(s))return!1;const r=t[s],n=e[s];if(q(r)&&q(n)){if(!H(r,n))return!1}else if(r!==n)return!1}for(const s of o)if(!r.includes(s))return!1;return!0}function q(t){return null!==t&&"object"==typeof t}function G(t){const e=[];for(const[r,o]of Object.entries(t))Array.isArray(o)?o.forEach(t=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function K(t){const e={};return t.replace(/^\?/,"").split("&").forEach(t=>{if(t){const[r,o]=t.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function X(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}exports.isAdmin=U;class Q{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const r=this.W_;if("string"==typeof t)for(let u=0;u<16;u++)r[u]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let u=0;u<16;u++)r[u]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let u=16;u<80;u++){const t=r[u-3]^r[u-8]^r[u-14]^r[u-16];r[u]=4294967295&(t<<1|t>>>31)}let o,s,n=this.chain_[0],i=this.chain_[1],c=this.chain_[2],a=this.chain_[3],h=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(o=a^i&(c^a),s=1518500249):(o=i^c^a,s=1859775393):u<60?(o=i&c|a&(i|c),s=2400959708):(o=i^c^a,s=3395469782);const t=(n<<5|n>>>27)+o+h+s+r[u]&4294967295;h=a,a=c,c=4294967295&(i<<30|i>>>2),i=n,n=t}this.chain_[0]=this.chain_[0]+n&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const r=e-this.blockSize;let o=0;const s=this.buf_;let n=this.inbuf_;for(;o<e;){if(0===n)for(;o<=r;)this.compress_(t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(s[n]=t.charCodeAt(o),++o,++n===this.blockSize){this.compress_(s),n=0;break}}else for(;o<e;)if(s[n]=t[o],++o,++n===this.blockSize){this.compress_(s),n=0;break}}this.inbuf_=n,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let o=this.blockSize-1;o>=56;o--)this.buf_[o]=255&e,e/=256;this.compress_(this.buf_);let r=0;for(let o=0;o<5;o++)for(let e=24;e>=0;e-=8)t[r]=this.chain_[o]>>e&255,++r;return t}}function Y(t,e){const r=new Z(t,e);return r.subscribe.bind(r)}exports.Sha1=Q;class Z{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(t=>{this.error(t)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let o;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");void 0===(o=et(t,["next","error","complete"])?t:{next:t,error:e,complete:r}).next&&(o.next=rt),void 0===o.error&&(o.error=rt),void 0===o.complete&&(o.complete=rt);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch(t){}}),this.observers.push(o),s}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tt(t,e){return(...r)=>{Promise.resolve(!0).then(()=>{t(...r)}).catch(t=>{e&&e(t)})}}function et(t,e){if("object"!=typeof t||null===t)return!1;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}function rt(){}const ot=function(t,e,r,o){let s;if(o<e?s="at least "+e:o>r&&(s=0===r?"none":"no more than "+r),s){throw new Error(t+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+s+".")}};function st(t,e){return`${t} failed: ${e} argument `}function nt(t,e,r){if((!r||e)&&"string"!=typeof e)throw new Error(st(t,"namespace")+"must be a valid firebase namespace.")}function it(t,e,r,o){if((!o||r)&&"function"!=typeof r)throw new Error(st(t,e)+"must be a valid function.")}function ct(t,e,r,o){if((!o||r)&&("object"!=typeof r||null===r))throw new Error(st(t,e)+"must be a valid context object.")}exports.validateArgCount=ot;const at=function(t){const e=[];let o=0;for(let s=0;s<t.length;s++){let n=t.charCodeAt(s);if(n>=55296&&n<=56319){const e=n-55296;r(++s<t.length,"Surrogate pair missing trail surrogate."),n=65536+(e<<10)+(t.charCodeAt(s)-56320)}n<128?e[o++]=n:n<2048?(e[o++]=n>>6|192,e[o++]=63&n|128):n<65536?(e[o++]=n>>12|224,e[o++]=n>>6&63|128,e[o++]=63&n|128):(e[o++]=n>>18|240,e[o++]=n>>12&63|128,e[o++]=n>>6&63|128,e[o++]=63&n|128)}return e};exports.stringToByteArray=at;const ht=function(t){let e=0;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);o<128?e++:o<2048?e+=2:o>=55296&&o<=56319?(e+=4,r++):e+=3}return e};exports.stringLength=ht;const ut=1e3,ft=2,lt=144e5;exports.MAX_VALUE_MILLIS=lt;const pt=.5;function dt(t,e=ut,r=ft){const o=e*Math.pow(r,t),s=Math.round(pt*o*(Math.random()-.5)*2);return Math.min(lt,o+s)}function bt(t){return Number.isFinite(t)?t+_t(t):`${t}`}function _t(t){const e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";const r=t%10;return 1===r?"st":2===r?"nd":3===r?"rd":"th"}function yt(t){return t&&t._delegate?t._delegate:t}exports.RANDOM_FACTOR=pt;
},{}],"sLOu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Provider=exports.ComponentContainer=exports.Component=void 0;var t=require("tslib"),e=require("@firebase/util"),n=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}();exports.Component=n;var i="[DEFAULT]",r=function(){function n(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return n.prototype.get=function(t){var n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){var i=new e.Deferred;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch(o){}}return this.instancesDeferred.get(n).promise},n.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}},n.prototype.getComponent=function(){return this.component},n.prototype.setComponent=function(e){var n,r;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(s(e))try{this.getOrInitializeService({instanceIdentifier:i})}catch(u){}try{for(var o=(0,t.__values)(this.instancesDeferred.entries()),a=o.next();!a.done;a=o.next()){var c=(0,t.__read)(a.value,2),h=c[0],l=c[1],p=this.normalizeInstanceIdentifier(h);try{var d=this.getOrInitializeService({instanceIdentifier:p});l.resolve(d)}catch(u){}}}catch(f){n={error:f}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}},n.prototype.clearInstance=function(t){void 0===t&&(t=i),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},n.prototype.delete=function(){return(0,t.__awaiter)(this,void 0,void 0,function(){var e;return(0,t.__generator)(this,function(n){switch(n.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all((0,t.__spreadArray)((0,t.__spreadArray)([],(0,t.__read)(e.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))),(0,t.__read)(e.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()}))))];case 1:return n.sent(),[2]}})})},n.prototype.isComponentSet=function(){return null!=this.component},n.prototype.isInitialized=function(t){return void 0===t&&(t=i),this.instances.has(t)},n.prototype.getOptions=function(t){return void 0===t&&(t=i),this.instancesOptions.get(t)||{}},n.prototype.initialize=function(e){var n,i;void 0===e&&(e={});var r=e.options,o=void 0===r?{}:r,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(this.name+"("+s+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:s,options:o});try{for(var c=(0,t.__values)(this.instancesDeferred.entries()),h=c.next();!h.done;h=c.next()){var l=(0,t.__read)(h.value,2),p=l[0],d=l[1];s===this.normalizeInstanceIdentifier(p)&&d.resolve(a)}}catch(u){n={error:u}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}return a},n.prototype.onInit=function(t,e){var n,i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);var o=this.instances.get(i);return o&&t(o,i),function(){r.delete(t)}},n.prototype.invokeOnInitCallbacks=function(e,n){var i,r,o=this.onInitCallbacks.get(n);if(o)try{for(var s=(0,t.__values)(o),a=s.next();!a.done;a=s.next()){var c=a.value;try{c(e,n)}catch(h){}}}catch(l){i={error:l}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}},n.prototype.getOrInitializeService=function(t){var e=t.instanceIdentifier,n=t.options,i=void 0===n?{}:n,r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:o(e),options:i}),this.instances.set(e,r),this.instancesOptions.set(e,i),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch(s){}return r||null},n.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=i),this.component?this.component.multipleInstances?t:i:t},n.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},n}();function o(t){return t===i?void 0:t}function s(t){return"EAGER"===t.instantiationMode}exports.Provider=r;var a=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new r(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();exports.ComponentContainer=a;
},{"tslib":"vCxL","@firebase/util":"chA2"}],"MfMd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setLogLevel=i,exports.setUserLogHandler=g,exports.Logger=exports.LogLevel=void 0;const e=[];var r;exports.LogLevel=r,function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(exports.LogLevel=r={}));const t={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,l={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},s=(e,r,...t)=>{if(r<e.logLevel)return;const o=(new Date).toISOString(),s=l[r];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${r})`);console[s](`[${o}]  ${e.name}:`,...t)};class n{constructor(r){this.name=r,this._logLevel=o,this._logHandler=s,this._userLogHandler=null,e.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?t[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...e),this._logHandler(this,r.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...e),this._logHandler(this,r.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,r.INFO,...e),this._logHandler(this,r.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,r.WARN,...e),this._logHandler(this,r.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...e),this._logHandler(this,r.ERROR,...e)}}function i(r){e.forEach(e=>{e.setLogLevel(r)})}function g(o,l){for(const s of e){let e=null;l&&l.level&&(e=t[l.level]),s.userLogHandler=null===o?null:(t,l,...s)=>{const n=s.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(e=>e).join(" ");l>=(null!=e?e:t.logLevel)&&o({level:r[l].toLowerCase(),message:n,args:s,type:t.name})}}}exports.Logger=n;
},{}],"Qqsz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._addComponent=R,exports._addOrOverwriteComponent=T,exports._clearComponents=M,exports._getProvider=V,exports._registerComponent=U,exports._removeServiceInstance=q,exports.deleteApp=Q,exports.getApp=G,exports.getApps=J,exports.initializeApp=H,exports.onLog=X,exports.registerVersion=W,exports.setLogLevel=Z,Object.defineProperty(exports,"FirebaseError",{enumerable:!0,get:function(){return a.FirebaseError}}),exports._components=exports._apps=exports._DEFAULT_ENTRY_NAME=exports.SDK_VERSION=void 0;var e=require("@firebase/component"),t=require("@firebase/logger"),a=require("@firebase/util");class r{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(n(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}function n(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}const o="@firebase/app",i="0.7.4",s=new t.Logger("@firebase/app"),p="@firebase/app-compat",c="@firebase/analytics-compat",f="@firebase/analytics",l="@firebase/app-check-compat",m="@firebase/app-check",u="@firebase/auth",d="@firebase/auth-compat",b="@firebase/database",g="@firebase/database-compat",h="@firebase/functions",_="@firebase/functions-compat",v="@firebase/installations",y="@firebase/installations-compat",w="@firebase/messaging",D="@firebase/messaging-compat",x="@firebase/performance",E="@firebase/performance-compat",C="@firebase/remote-config",A="@firebase/remote-config-compat",N="@firebase/storage",$="@firebase/storage-compat",F="@firebase/firestore",O="@firebase/firestore-compat",j="firebase",L="9.1.3",k="[DEFAULT]";exports._DEFAULT_ENTRY_NAME=k;const I={[o]:"fire-core",[p]:"fire-core-compat",[f]:"fire-analytics",[c]:"fire-analytics-compat",[m]:"fire-app-check",[l]:"fire-app-check-compat",[u]:"fire-auth",[d]:"fire-auth-compat",[b]:"fire-rtdb",[g]:"fire-rtdb-compat",[h]:"fire-fn",[_]:"fire-fn-compat",[v]:"fire-iid",[y]:"fire-iid-compat",[w]:"fire-fcm",[D]:"fire-fcm-compat",[x]:"fire-perf",[E]:"fire-perf-compat",[C]:"fire-rc",[A]:"fire-rc-compat",[N]:"fire-gcs",[$]:"fire-gcs-compat",[F]:"fire-fst",[O]:"fire-fst-compat","fire-js":"fire-js",[j]:"fire-js-all"},P=new Map;exports._apps=P;const S=new Map;function R(e,t){try{e.container.addComponent(t)}catch(a){s.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,a)}}function T(e,t){e.container.addOrOverwriteComponent(t)}function U(e){const t=e.name;if(S.has(t))return s.debug(`There were multiple attempts to register component ${t}.`),!1;S.set(t,e);for(const a of P.values())R(a,e);return!0}function V(e,t){return e.container.getProvider(t)}function q(e,t,a=k){V(e,t).clearInstance(a)}function M(){S.clear()}exports._components=S;const z={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."},K=new a.ErrorFactory("app","Firebase",z);class Y{constructor(t,a,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},a),this._name=a.name,this._automaticDataCollectionEnabled=a.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new e.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw K.create("app-deleted",{appName:this._name})}}const B="9.1.3";function H(t,r={}){if("object"!=typeof r){r={name:r}}const n=Object.assign({name:k,automaticDataCollectionEnabled:!1},r),o=n.name;if("string"!=typeof o||!o)throw K.create("bad-app-name",{appName:String(o)});const i=P.get(o);if(i){if((0,a.deepEqual)(t,i.options)&&(0,a.deepEqual)(n,i.config))return i;throw K.create("duplicate-app",{appName:o})}const s=new e.ComponentContainer(o);for(const e of S.values())s.addComponent(e);const p=new Y(t,n,s);return P.set(o,p),p}function G(e=k){const t=P.get(e);if(!t)throw K.create("no-app",{appName:e});return t}function J(){return Array.from(P.values())}async function Q(e){const t=e.name;P.has(t)&&(P.delete(t),await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function W(t,a,r){var n;let o=null!==(n=I[t])&&void 0!==n?n:t;r&&(o+=`-${r}`);const i=o.match(/\s|\//),p=a.match(/\s|\//);if(i||p){const e=[`Unable to register library "${o}" with version "${a}":`];return i&&e.push(`library name "${o}" contains illegal characters (whitespace or "/")`),i&&p&&e.push("and"),p&&e.push(`version name "${a}" contains illegal characters (whitespace or "/")`),void s.warn(e.join(" "))}U(new e.Component(`${o}-version`,()=>({library:o,version:a}),"VERSION"))}function X(e,a){if(null!==e&&"function"!=typeof e)throw K.create("invalid-log-argument");(0,t.setUserLogHandler)(e,a)}function Z(e){(0,t.setLogLevel)(e)}function ee(t){U(new e.Component("platform-logger",e=>new r(e),"PRIVATE")),W(o,i,t),W(o,i,"esm2017"),W("fire-js","")}exports.SDK_VERSION="9.1.3",ee("");
},{"@firebase/component":"sLOu","@firebase/logger":"MfMd","@firebase/util":"chA2"}],"qQDx":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStatEventTarget=exports.default=exports.createWebChannelTransport=exports.XhrIo=exports.WebChannel=exports.Stat=exports.FetchXmlHttpFactory=exports.EventType=exports.Event=exports.ErrorCode=void 0;var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},i={};exports.default=i;var n,s=s||{},r=e||self;function o(){}function h(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function a(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function l(t){return Object.prototype.hasOwnProperty.call(t,u)&&t[u]||(t[u]=++c)}var u="closure_uid_"+(1e9*Math.random()>>>0),c=0;function f(t,e,i){return t.call.apply(t.bind,arguments)}function g(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function p(t,e,i){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?f:g).apply(null,arguments)}function d(t,e){var i=Array.prototype.slice.call(arguments,1);return function(){var e=i.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function v(t,e){function i(){}i.prototype=e.prototype,t.Z=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.Vb=function(t,i,n){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[i].apply(t,s)}}function y(){this.s=this.s,this.o=this.o}var m=0,b={};y.prototype.s=!1,y.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0!=m)){var t=l(this);delete b[t]}},y.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const w=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let i=0;i<t.length;i++)if(i in t&&t[i]===e)return i;return-1},T=Array.prototype.forEach?function(t,e,i){Array.prototype.forEach.call(t,e,i)}:function(t,e,i){const n=t.length,s="string"==typeof t?t.split(""):t;for(let r=0;r<n;r++)r in s&&e.call(i,s[r],r,t)};function E(t){t:{var e=Bi;const i=t.length,n="string"==typeof t?t.split(""):t;for(let s=0;s<i;s++)if(s in n&&e.call(void 0,n[s],s,t)){e=s;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}function S(t){return Array.prototype.concat.apply([],arguments)}function x(t){const e=t.length;if(0<e){const i=Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}return[]}function j(t){return/^[\s\xa0]*$/.test(t)}var C,I=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function A(t,e){return-1!=t.indexOf(e)}function R(t,e){return t<e?-1:t>e?1:0}t:{var O=r.navigator;if(O){var P=O.userAgent;if(P){C=P;break t}}C=""}function D(t,e,i){for(const n in t)e.call(i,t[n],n,t)}function M(t){const e={};for(const i in t)e[i]=t[i];return e}var L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(t,e){let i,n;for(let s=1;s<arguments.length;s++){for(i in n=arguments[s])t[i]=n[i];for(let e=0;e<L.length;e++)i=L[e],Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}}function H(t){return H[" "](t),t}function k(t){var e=q;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}H[" "]=o;var _,B=A(C,"Opera"),F=A(C,"Trident")||A(C,"MSIE"),N=A(C,"Edge"),U=N||F,K=A(C,"Gecko")&&!(A(C.toLowerCase(),"webkit")&&!A(C,"Edge"))&&!(A(C,"Trident")||A(C,"MSIE"))&&!A(C,"Edge"),Y=A(C.toLowerCase(),"webkit")&&!A(C,"Edge");function G(){var t=r.document;return t?t.documentMode:void 0}t:{var J="",W=function(){var t=C;return K?/rv:([^\);]+)(\)|;)/.exec(t):N?/Edge\/([\d\.]+)/.exec(t):F?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Y?/WebKit\/(\S+)/.exec(t):B?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(W&&(J=W?W[1]:""),F){var V=G();if(null!=V&&V>parseFloat(J)){_=String(V);break t}}_=J}var $,q={};function z(){return k(function(){let t=0;const e=I(String(_)).split("."),i=I("9").split("."),n=Math.max(e.length,i.length);for(let o=0;0==t&&o<n;o++){var s=e[o]||"",r=i[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==s[0].length&&0==r[0].length)break;t=R(0==s[1].length?0:parseInt(s[1],10),0==r[1].length?0:parseInt(r[1],10))||R(0==s[2].length,0==r[2].length)||R(s[2],r[2]),s=s[3],r=r[3]}while(0==t)}return 0<=t})}if(r.document&&F){var Z=G();$=Z||(parseInt(_,10)||void 0)}else $=void 0;var Q=$,tt=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{r.addEventListener("test",o,e),r.removeEventListener("test",o,e)}catch(i){}return t}();function et(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function it(t,e){if(et.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var i=this.type=t.type,n=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(K){t:{try{H(e.nodeName);var s=!0;break t}catch(r){}s=!1}s||(e=null)}}else"mouseover"==i?e=t.fromElement:"mouseout"==i&&(e=t.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:nt[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&it.Z.h.call(this)}}et.prototype.h=function(){this.defaultPrevented=!0},v(it,et);var nt={2:"touch",3:"pen",4:"mouse"};it.prototype.h=function(){it.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var st="closure_listenable_"+(1e6*Math.random()|0),rt=0;function ot(t,e,i,n,s){this.listener=t,this.proxy=null,this.src=e,this.type=i,this.capture=!!n,this.ia=s,this.key=++rt,this.ca=this.fa=!1}function ht(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function at(t){this.src=t,this.g={},this.h=0}function lt(t,e){var i=e.type;if(i in t.g){var n,s=t.g[i],r=w(s,e);(n=0<=r)&&Array.prototype.splice.call(s,r,1),n&&(ht(e),0==t.g[i].length&&(delete t.g[i],t.h--))}}function ut(t,e,i,n){for(var s=0;s<t.length;++s){var r=t[s];if(!r.ca&&r.listener==e&&r.capture==!!i&&r.ia==n)return s}return-1}at.prototype.add=function(t,e,i,n,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=ut(t,e,n,s);return-1<o?(e=t[o],i||(e.fa=!1)):((e=new ot(e,this.src,r,!!n,s)).fa=i,t.push(e)),e};var ct="closure_lm_"+(1e6*Math.random()|0),ft={};function gt(t,e,i,n,s){if(n&&n.once)return vt(t,e,i,n,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)gt(t,e[r],i,n,s);return null}return i=St(i),t&&t[st]?t.N(e,i,a(n)?!!n.capture:!!n,s):pt(t,e,i,!1,n,s)}function pt(t,e,i,n,s,r){if(!e)throw Error("Invalid event type");var o=a(s)?!!s.capture:!!s,h=Tt(t);if(h||(t[ct]=h=new at(t)),(i=h.add(e,i,n,o,r)).proxy)return i;if(n=dt(),i.proxy=n,n.src=t,n.listener=i,t.addEventListener)tt||(s=o),void 0===s&&(s=!1),t.addEventListener(e.toString(),n,s);else if(t.attachEvent)t.attachEvent(bt(e.toString()),n);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(n)}return i}function dt(){var t=wt;return function e(i){return t.call(e.src,e.listener,i)}}function vt(t,e,i,n,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)vt(t,e[r],i,n,s);return null}return i=St(i),t&&t[st]?t.O(e,i,a(n)?!!n.capture:!!n,s):pt(t,e,i,!0,n,s)}function yt(t,e,i,n,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)yt(t,e[r],i,n,s);else n=a(n)?!!n.capture:!!n,i=St(i),t&&t[st]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(i=ut(r=t.g[e],i,n,s))&&(ht(r[i]),Array.prototype.splice.call(r,i,1),0==r.length&&(delete t.g[e],t.h--)))):t&&(t=Tt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ut(e,i,n,s)),(i=-1<t?e[t]:null)&&mt(i))}function mt(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[st])lt(e.i,t);else{var i=t.type,n=t.proxy;e.removeEventListener?e.removeEventListener(i,n,t.capture):e.detachEvent?e.detachEvent(bt(i),n):e.addListener&&e.removeListener&&e.removeListener(n),(i=Tt(e))?(lt(i,t),0==i.h&&(i.src=null,e[ct]=null)):ht(t)}}}function bt(t){return t in ft?ft[t]:ft[t]="on"+t}function wt(t,e){if(t.ca)t=!0;else{e=new it(e,this);var i=t.listener,n=t.ia||t.src;t.fa&&mt(t),t=i.call(n,e)}return t}function Tt(t){return(t=t[ct])instanceof at?t:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function St(t){return"function"==typeof t?t:(t[Et]||(t[Et]=function(e){return t.handleEvent(e)}),t[Et])}function xt(){y.call(this),this.i=new at(this),this.P=this,this.I=null}function jt(t,e){var i,n=t.I;if(n)for(i=[];n;n=n.I)i.push(n);if(t=t.P,n=e.type||e,"string"==typeof e)e=new et(e,t);else if(e instanceof et)e.target=e.target||t;else{var s=e;X(e=new et(n,t),s)}if(s=!0,i)for(var r=i.length-1;0<=r;r--){var o=e.g=i[r];s=Ct(o,n,!0,e)&&s}if(s=Ct(o=e.g=t,n,!0,e)&&s,s=Ct(o,n,!1,e)&&s,i)for(r=0;r<i.length;r++)s=Ct(o=e.g=i[r],n,!1,e)&&s}function Ct(t,e,i,n){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.ca&&o.capture==i){var h=o.listener,a=o.ia||o.src;o.fa&&lt(t.i,o),s=!1!==h.call(a,n)&&s}}return s&&!n.defaultPrevented}v(xt,y),xt.prototype[st]=!0,xt.prototype.removeEventListener=function(t,e,i,n){yt(this,t,e,i,n)},xt.prototype.M=function(){if(xt.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var i=e.g[t],n=0;n<i.length;n++)ht(i[n]);delete e.g[t],e.h--}}this.I=null},xt.prototype.N=function(t,e,i,n){return this.i.add(String(t),e,!1,i,n)},xt.prototype.O=function(t,e,i,n){return this.i.add(String(t),e,!0,i,n)};var It=r.JSON.stringify;function At(){var t=kt;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Rt{constructor(){this.h=this.g=null}add(t,e){const i=Pt.get();i.set(t,e),this.h?this.h.next=i:this.g=i,this.h=i}}var Ot,Pt=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Dt,t=>t.reset());class Dt{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Mt(t){r.setTimeout(()=>{throw t},0)}function Lt(t,e){Ot||Xt(),Ht||(Ot(),Ht=!0),kt.add(t,e)}function Xt(){var t=r.Promise.resolve(void 0);Ot=function(){t.then(_t)}}var Ht=!1,kt=new Rt;function _t(){for(var t;t=At();){try{t.h.call(t.g)}catch(i){Mt(i)}var e=Pt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ht=!1}function Bt(t,e){xt.call(this),this.h=t||1,this.g=e||r,this.j=p(this.kb,this),this.l=Date.now()}function Ft(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Nt(t,e,i){if("function"==typeof t)i&&(t=p(t,i));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=p(t.handleEvent,t)}return 2147483647<Number(e)?-1:r.setTimeout(t,e||0)}function Ut(t){t.g=Nt(()=>{t.g=null,t.i&&(t.i=!1,Ut(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}v(Bt,xt),(n=Bt.prototype).da=!1,n.S=null,n.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),jt(this,"tick"),this.da&&(Ft(this),this.start()))}},n.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},n.M=function(){Bt.Z.M.call(this),Ft(this),delete this.g};class Kt extends y{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Ut(this)}M(){super.M(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yt(t){y.call(this),this.h=t,this.g={}}v(Yt,y);var Gt=[];function Jt(t,e,i,n){Array.isArray(i)||(i&&(Gt[0]=i.toString()),i=Gt);for(var s=0;s<i.length;s++){var r=gt(e,i[s],n||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function Wt(t){D(t.g,function(t,e){this.g.hasOwnProperty(e)&&mt(t)},t),t.g={}}function Vt(){this.g=!0}function $t(t,e,i,n,s,r){t.info(function(){if(t.g)if(r)for(var o="",h=r.split("&"),a=0;a<h.length;a++){var l=h[a].split("=");if(1<l.length){var u=l[0];l=l[1];var c=u.split("_");o=2<=c.length&&"type"==c[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+n+") [attempt "+s+"]: "+e+"\n"+i+"\n"+o})}function qt(t,e,i,n,s,r,o){t.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+s+"]: "+e+"\n"+i+"\n"+r+" "+o})}function zt(t,e,i,n){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Qt(t,i)+(n?" "+n:"")})}function Zt(t,e){t.info(function(){return"TIMEOUT: "+e})}function Qt(t,e){if(!t.g)return e;if(!e)return null;try{var i=JSON.parse(e);if(i)for(t=0;t<i.length;t++)if(Array.isArray(i[t])){var n=i[t];if(!(2>n.length)){var s=n[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return It(i)}catch(h){return e}}Yt.prototype.M=function(){Yt.Z.M.call(this),Wt(this)},Yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Vt.prototype.Aa=function(){this.g=!1},Vt.prototype.info=function(){};var te={},ee=null;function ie(){return ee=ee||new xt}function ne(t){et.call(this,te.Ma,t)}function se(t){const e=ie();jt(e,new ne(e,t))}function re(t,e){et.call(this,te.STAT_EVENT,t),this.stat=e}function oe(t){const e=ie();jt(e,new re(e,t))}function he(t,e){et.call(this,te.Na,t),this.size=e}function ae(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return r.setTimeout(function(){t()},e)}te.Ma="serverreachability",v(ne,et),te.STAT_EVENT="statevent",v(re,et),te.Na="timingevent",v(he,et);var le={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ue={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function ce(){}function fe(t){return t.h||(t.h=t.i())}function ge(){}ce.prototype.h=null;var pe,de={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ve(){et.call(this,"d")}function ye(){et.call(this,"c")}function me(){}function be(t,e,i,n){this.l=t,this.j=e,this.m=i,this.X=n||1,this.V=new Yt(this),this.P=Te,t=U?125:void 0,this.W=new Bt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new we}function we(){this.i=null,this.g="",this.h=!1}v(ve,et),v(ye,et),v(me,ce),me.prototype.g=function(){return new XMLHttpRequest},me.prototype.i=function(){return{}},pe=new me;var Te=45e3,Ee={},Se={};function xe(t,e,i){t.K=1,t.v=$e(Ke(e)),t.s=i,t.U=!0,je(t,null)}function je(t,e){t.F=Date.now(),Re(t),t.A=Ke(t.v);var i=t.A,n=t.X;Array.isArray(n)||(n=[String(n)]),ui(i.h,"t",n),t.C=0,i=t.l.H,t.h=new we,t.g=yn(t.l,i?e:null,!t.s),0<t.O&&(t.L=new Kt(p(t.Ia,t,t.g),t.O)),Jt(t.V,t.g,"readystatechange",t.gb),e=t.H?M(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),se(1),$t(t.j,t.u,t.A,t.m,t.X,t.s)}function Ce(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Ie(t,e,i){let n,s=!0;for(;!t.I&&t.C<i.length;){if((n=Ae(t,i))==Se){4==e&&(t.o=4,oe(14),s=!1),zt(t.j,t.m,null,"[Incomplete Response]");break}if(n==Ee){t.o=4,oe(15),zt(t.j,t.m,i,"[Invalid Chunk]"),s=!1;break}zt(t.j,t.m,n,null),Le(t,n)}Ce(t)&&n!=Se&&n!=Ee&&(t.h.g="",t.C=0),4!=e||0!=i.length||t.h.h||(t.o=1,oe(16),s=!1),t.i=t.i&&s,s?0<i.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+i.length),ln(e),e.L=!0,oe(11))):(zt(t.j,t.m,i,"[Invalid Chunked Response]"),Me(t),De(t))}function Ae(t,e){var i=t.C,n=e.indexOf("\n",i);return-1==n?Se:(i=Number(e.substring(i,n)),isNaN(i)?Ee:(n+=1)+i>e.length?Se:(e=e.substr(n,i),t.C=n+i,e))}function Re(t){t.Y=Date.now()+t.P,Oe(t,t.P)}function Oe(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ae(p(t.eb,t),e)}function Pe(t){t.B&&(r.clearTimeout(t.B),t.B=null)}function De(t){0==t.l.G||t.I||fn(t.l,t)}function Me(t){Pe(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Ft(t.W),Wt(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Le(t,e){try{var i=t.l;if(0!=i.G&&(i.g==t||mi(i.i,t)))if(i.I=t.N,!t.J&&mi(i.i,t)&&3==i.G){try{var n=i.Ca.g.parse(e)}catch(l){n=null}if(Array.isArray(n)&&3==n.length){var s=n;if(0==s[0]){t:if(!i.u){if(i.g){if(!(i.g.F+3e3<t.F))break t;cn(i),Zi(i)}an(i),oe(18)}}else i.ta=s[1],0<i.ta-i.U&&37500>s[2]&&i.N&&0==i.A&&!i.v&&(i.v=ae(p(i.ab,i),6e3));if(1>=yi(i.i)&&i.ka){try{i.ka()}catch(l){}i.ka=void 0}}else pn(i,11)}else if((t.J||i.g==t)&&cn(i),!j(e))for(s=i.Ca.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(i.U=l[0],l=l[1],2==i.G)if("c"==l[0]){i.J=l[1],i.la=l[2];const e=l[3];null!=e&&(i.ma=e,i.h.info("VER="+i.ma));const s=l[4];null!=s&&(i.za=s,i.h.info("SVER="+i.za));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(n=1.5*u,i.K=n,i.h.info("backChannelRequestTimeoutMs_="+n)),n=i;const c=t.g;if(c){const t=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=n.i;!r.g&&(A(t,"spdy")||A(t,"quic")||A(t,"h2"))&&(r.j=r.l,r.g=new Set,r.h&&(bi(r,r.h),r.h=null))}if(n.D){const t=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(n.sa=t,Ve(n.F,n.D,t))}}i.G=3,i.j&&i.j.xa(),i.$&&(i.O=Date.now()-t.F,i.h.info("Handshake RTT: "+i.O+"ms"));var o=t;if((n=i).oa=vn(n,n.H?n.la:null,n.W),o.J){wi(n.i,o);var h=o,a=n.K;a&&h.setTimeout(a),h.B&&(Pe(h),Re(h)),n.g=o}else hn(n);0<i.l.length&&en(i)}else"stop"!=l[0]&&"close"!=l[0]||pn(i,7);else 3==i.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?pn(i,7):zi(i):"noop"!=l[0]&&i.j&&i.j.wa(l),i.A=0)}se(4)}catch(l){}}function Xe(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(h(t)){for(var e=[],i=t.length,n=0;n<i;n++)e.push(t[n]);return e}for(n in e=[],i=0,t)e[i++]=t[n];return e}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(h(t)||"string"==typeof t)T(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var i=t.T();else if(t.R&&"function"==typeof t.R)i=void 0;else if(h(t)||"string"==typeof t){i=[];for(var n=t.length,s=0;s<n;s++)i.push(s)}else for(s in i=[],n=0,t)i[n++]=s;s=(n=Xe(t)).length;for(var r=0;r<s;r++)e.call(void 0,n[r],i&&i[r],t)}}function ke(t,e){this.h={},this.g=[],this.i=0;var i=arguments.length;if(1<i){if(i%2)throw Error("Uneven number of arguments");for(var n=0;n<i;n+=2)this.set(arguments[n],arguments[n+1])}else if(t)if(t instanceof ke)for(i=t.T(),n=0;n<i.length;n++)this.set(i[n],t.get(i[n]));else for(n in t)this.set(n,t[n])}function _e(t){if(t.i!=t.g.length){for(var e=0,i=0;e<t.g.length;){var n=t.g[e];Be(t.h,n)&&(t.g[i++]=n),e++}t.g.length=i}if(t.i!=t.g.length){var s={};for(i=e=0;e<t.g.length;)Be(s,n=t.g[e])||(t.g[i++]=n,s[n]=1),e++;t.g.length=i}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(n=be.prototype).setTimeout=function(t){this.P=t},n.gb=function(t){t=t.target;const e=this.L;e&&3==Gi(t)?e.l():this.Ia(t)},n.Ia=function(t){try{if(t==this.g)t:{const c=Gi(this.g);var e=this.g.Da();const f=this.g.ba();if(!(3>c)&&(3!=c||U||this.g&&(this.h.h||this.g.ga()||Ji(this.g)))){this.I||4!=c||7==e||se(8==e||0>=f?3:2),Pe(this);var i=this.g.ba();this.N=i;e:if(Ce(this)){var n=Ji(this.g);t="";var s=n.length,o=4==Gi(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Me(this),De(this);var h="";break e}this.h.i=new r.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(n[e],{stream:o&&e==s-1});n.splice(0,s),this.h.g+=t,this.C=0,h=this.h.g}else h=this.g.ga();if(this.i=200==i,qt(this.j,this.u,this.A,this.m,this.X,c,i),this.i){if(this.$&&!this.J){e:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(a)){var u=a;break e}}u=null}if(!(i=u)){this.i=!1,this.o=3,oe(12),Me(this),De(this);break t}zt(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Le(this,i)}this.U?(Ie(this,c,h),U&&this.i&&3==c&&(Jt(this.V,this.W,"tick",this.fb),this.W.start())):(zt(this.j,this.m,h,null),Le(this,h)),4==c&&Me(this),this.i&&!this.I&&(4==c?fn(this.l,this):(this.i=!1,Re(this)))}else 400==i&&0<h.indexOf("Unknown SID")?(this.o=3,oe(12)):(this.o=0,oe(13)),Me(this),De(this)}}}catch(c){}},n.fb=function(){if(this.g){var t=Gi(this.g),e=this.g.ga();this.C<e.length&&(Pe(this),Ie(this,t,e),this.i&&4!=t&&Re(this))}},n.cancel=function(){this.I=!0,Me(this)},n.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(Zt(this.j,this.A),2!=this.K&&(se(3),oe(17)),Me(this),this.o=2,De(this)):Oe(this,this.Y-t)},(n=ke.prototype).R=function(){_e(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},n.T=function(){return _e(this),this.g.concat()},n.get=function(t,e){return Be(this.h,t)?this.h[t]:e},n.set=function(t,e){Be(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},n.forEach=function(t,e){for(var i=this.T(),n=0;n<i.length;n++){var s=i[n],r=this.get(s);t.call(e,r,s,this)}};var Fe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ne(t,e){if(t){t=t.split("&");for(var i=0;i<t.length;i++){var n=t[i].indexOf("="),s=null;if(0<=n){var r=t[i].substring(0,n);s=t[i].substring(n+1)}else r=t[i];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Ue(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Ue){this.g=void 0!==e?e:t.g,Ye(this,t.j),this.s=t.s,Ge(this,t.i),Je(this,t.m),this.l=t.l,e=t.h;var i=new oi;i.i=e.i,e.g&&(i.g=new ke(e.g),i.h=e.h),We(this,i),this.o=t.o}else t&&(i=String(t).match(Fe))?(this.g=!!e,Ye(this,i[1]||"",!0),this.s=Ze(i[2]||""),Ge(this,i[3]||"",!0),Je(this,i[4]),this.l=Ze(i[5]||"",!0),We(this,i[6]||"",!0),this.o=Ze(i[7]||"")):(this.g=!!e,this.h=new oi(null,this.g))}function Ke(t){return new Ue(t)}function Ye(t,e,i){t.j=i?Ze(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ge(t,e,i){t.i=i?Ze(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function We(t,e,i){e instanceof oi?(t.h=e,fi(t.h,t.g)):(i||(e=Qe(e,si)),t.h=new oi(e,t.g))}function Ve(t,e,i){t.h.set(e,i)}function $e(t){return Ve(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function qe(t){return t instanceof Ue?Ke(t):new Ue(t,void 0)}function ze(t,e,i,n){var s=new Ue(null,void 0);return t&&Ye(s,t),e&&Ge(s,e),i&&Je(s,i),n&&(s.l=n),s}function Ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Qe(t,e,i){return"string"==typeof t?(t=encodeURI(t).replace(e,ti),i&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ti(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ue.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Qe(e,ei,!0),":");var i=this.i;return(i||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Qe(e,ei,!0),"@"),t.push(encodeURIComponent(String(i)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(i=this.m)&&t.push(":",String(i))),(i=this.l)&&(this.i&&"/"!=i.charAt(0)&&t.push("/"),t.push(Qe(i,"/"==i.charAt(0)?ni:ii,!0))),(i=this.h.toString())&&t.push("?",i),(i=this.o)&&t.push("#",Qe(i,ri)),t.join("")};var ei=/[#\/\?@]/g,ii=/[#\?:]/g,ni=/[#\?]/g,si=/[#\?@]/g,ri=/#/g;function oi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function hi(t){t.g||(t.g=new ke,t.h=0,t.i&&Ne(t.i,function(e,i){t.add(decodeURIComponent(e.replace(/\+/g," ")),i)}))}function ai(t,e){hi(t),e=ci(t,e),Be(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Be((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&_e(t)))}function li(t,e){return hi(t),e=ci(t,e),Be(t.g.h,e)}function ui(t,e,i){ai(t,e),0<i.length&&(t.i=null,t.g.set(ci(t,e),x(i)),t.h+=i.length)}function ci(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function fi(t,e){e&&!t.j&&(hi(t),t.i=null,t.g.forEach(function(t,e){var i=e.toLowerCase();e!=i&&(ai(this,e),ui(this,i,t))},t)),t.j=e}(n=oi.prototype).add=function(t,e){hi(this),this.i=null,t=ci(this,t);var i=this.g.get(t);return i||this.g.set(t,i=[]),i.push(e),this.h+=1,this},n.forEach=function(t,e){hi(this),this.g.forEach(function(i,n){T(i,function(i){t.call(e,i,n,this)},this)},this)},n.T=function(){hi(this);for(var t=this.g.R(),e=this.g.T(),i=[],n=0;n<e.length;n++)for(var s=t[n],r=0;r<s.length;r++)i.push(e[n]);return i},n.R=function(t){hi(this);var e=[];if("string"==typeof t)li(this,t)&&(e=S(e,this.g.get(ci(this,t))));else{t=this.g.R();for(var i=0;i<t.length;i++)e=S(e,t[i])}return e},n.set=function(t,e){return hi(this),this.i=null,li(this,t=ci(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},n.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},n.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),i=0;i<e.length;i++){var n=e[i],s=encodeURIComponent(String(n));n=this.R(n);for(var r=0;r<n.length;r++){var o=s;""!==n[r]&&(o+="="+encodeURIComponent(String(n[r]))),t.push(o)}}return this.i=t.join("&")};var gi=class{constructor(t,e){this.h=t,this.g=e}};function pi(t){this.l=t||di,r.PerformanceNavigationTiming?t=0<(t=r.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(r.g&&r.g.Ea&&r.g.Ea()&&r.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var di=10;function vi(t){return!!t.h||!!t.g&&t.g.size>=t.j}function yi(t){return t.h?1:t.g?t.g.size:0}function mi(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function bi(t,e){t.g?t.g.add(e):t.h=e}function wi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Ti(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const i of t.g.values())e=e.concat(i.D);return e}return x(t.i)}function Ei(){}function Si(){this.g=new Ei}function xi(t,e,i){const n=i||"";try{He(t,function(t,i){let s=t;a(t)&&(s=It(t)),e.push(n+i+"="+encodeURIComponent(s))})}catch(s){throw e.push(n+"type="+encodeURIComponent("_badmap")),s}}function ji(t,e){const i=new Vt;if(r.Image){const n=new Image;n.onload=d(Ci,i,n,"TestLoadImage: loaded",!0,e),n.onerror=d(Ci,i,n,"TestLoadImage: error",!1,e),n.onabort=d(Ci,i,n,"TestLoadImage: abort",!1,e),n.ontimeout=d(Ci,i,n,"TestLoadImage: timeout",!1,e),r.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=t}else e(!1)}function Ci(t,e,i,n,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(n)}catch(r){}}function Ii(t){this.l=t.$b||null,this.j=t.ib||!1}function Ai(t,e){xt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Ri,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}pi.prototype.cancel=function(){if(this.i=Ti(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},Ei.prototype.stringify=function(t){return r.JSON.stringify(t,void 0)},Ei.prototype.parse=function(t){return r.JSON.parse(t,void 0)},v(Ii,ce),Ii.prototype.g=function(){return new Ai(this.l,this.j)},Ii.prototype.i=function(t){return function(){return t}}({}),v(Ai,xt);var Ri=0;function Oi(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Pi(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Di(t)}function Di(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(n=Ai.prototype).open=function(t,e){if(this.readyState!=Ri)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Di(this)},n.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||r).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},n.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Pi(this)),this.readyState=Ri},n.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Di(this)),this.g&&(this.readyState=3,Di(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==r.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Oi(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},n.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Pi(this):Di(this),3==this.readyState&&Oi(this)}},n.Ua=function(t){this.g&&(this.response=this.responseText=t,Pi(this))},n.Ta=function(t){this.g&&(this.response=t,Pi(this))},n.ha=function(){this.g&&Pi(this)},n.setRequestHeader=function(t,e){this.v.append(t,e)},n.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var i=e.next();!i.done;)i=i.value,t.push(i[0]+": "+i[1]),i=e.next();return t.join("\r\n")},Object.defineProperty(Ai.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Mi=r.JSON.parse;function Li(t){xt.call(this),this.headers=new ke,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Xi,this.K=this.L=!1}v(Li,xt);var Xi="",Hi=/^https?$/i,ki=["POST","PUT"];function _i(t){return F&&z()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function Bi(t){return"content-type"==t.toLowerCase()}function Fi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ni(t),Ki(t)}function Ni(t){t.D||(t.D=!0,jt(t,"complete"),jt(t,"error"))}function Ui(t){if(t.h&&void 0!==s&&(!t.C[1]||4!=Gi(t)||2!=t.ba()))if(t.v&&4==Gi(t))Nt(t.Fa,0,t);else if(jt(t,"readystatechange"),4==Gi(t)){t.h=!1;try{const s=t.ba();t:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var i;if(!(i=e)){var n;if(n=0===s){var o=String(t.H).match(Fe)[1]||null;if(!o&&r.self&&r.self.location){var h=r.self.location.protocol;o=h.substr(0,h.length-1)}n=!Hi.test(o?o.toLowerCase():"")}i=n}if(i)jt(t,"complete"),jt(t,"success");else{t.m=6;try{var a=2<Gi(t)?t.g.statusText:""}catch(l){a=""}t.j=a+" ["+t.ba()+"]",Ni(t)}}finally{Ki(t)}}}function Ki(t,e){if(t.g){Yi(t);const n=t.g,s=t.C[0]?o:null;t.g=null,t.C=null,e||jt(t,"ready");try{n.onreadystatechange=s}catch(i){}}}function Yi(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(r.clearTimeout(t.A),t.A=null)}function Gi(t){return t.g?t.g.readyState:0}function Ji(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Xi:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Wi(t){let e="";return D(t,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function Vi(t,e,i){t:{for(n in i){var n=!1;break t}n=!0}n||(i=Wi(i),"string"==typeof t?null!=i&&encodeURIComponent(String(i)):Ve(t,e,i))}function $i(t,e,i){return i&&i.internalChannelParams&&i.internalChannelParams[t]||e}function qi(t){this.za=0,this.l=[],this.h=new Vt,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=$i("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=$i("baseRetryDelayMs",5e3,t),this.$a=$i("retryDelaySeedMs",1e4,t),this.Ya=$i("forwardChannelMaxRetries",2,t),this.ra=$i("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new pi(t&&t.concurrentRequestLimit),this.Ca=new Si,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function zi(t){if(Qi(t),3==t.G){var e=t.V++,i=Ke(t.F);Ve(i,"SID",t.J),Ve(i,"RID",e),Ve(i,"TYPE","terminate"),rn(t,i),(e=new be(t,t.h,e,void 0)).K=2,e.v=$e(Ke(i)),i=!1,r.navigator&&r.navigator.sendBeacon&&(i=r.navigator.sendBeacon(e.v.toString(),"")),!i&&r.Image&&((new Image).src=e.v,i=!0),i||(e.g=yn(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Re(e)}dn(t)}function Zi(t){t.g&&(ln(t),t.g.cancel(),t.g=null)}function Qi(t){Zi(t),t.u&&(r.clearTimeout(t.u),t.u=null),cn(t),t.i.cancel(),t.m&&("number"==typeof t.m&&r.clearTimeout(t.m),t.m=null)}function tn(t,e){t.l.push(new gi(t.Za++,e)),3==t.G&&en(t)}function en(t){vi(t.i)||t.m||(t.m=!0,Lt(t.Ha,t),t.C=0)}function nn(t,e){return!(yi(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.l=e.D.concat(t.l),!0):!(1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya))&&(t.m=ae(p(t.Ha,t,e),gn(t,t.C)),t.C++,!0))}function sn(t,e){var i;i=e?e.m:t.V++;const n=Ke(t.F);Ve(n,"SID",t.J),Ve(n,"RID",i),Ve(n,"AID",t.U),rn(t,n),t.o&&t.s&&Vi(n,t.o,t.s),i=new be(t,t.h,i,t.C+1),null===t.o&&(i.H=t.s),e&&(t.l=e.D.concat(t.l)),e=on(t,i,1e3),i.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),bi(t.i,i),xe(i,n,e)}function rn(t,e){t.j&&He({},function(t,i){Ve(e,i,t)})}function on(t,e,i){i=Math.min(t.l.length,i);var n=t.j?p(t.j.Oa,t.j,t):null;t:{var s=t.l;let e=-1;for(;;){const t=["count="+i];-1==e?0<i?(e=s[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let h=0;h<i;h++){let i=s[h].h;const a=s[h].g;if(0>(i-=e))e=Math.max(0,s[h].h-100),o=!1;else try{xi(a,t,"req"+i+"_")}catch(r){n&&n(a)}}if(o){n=t.join("&");break t}}}return t=t.l.splice(0,i),e.D=t,n}function hn(t){t.g||t.u||(t.Y=1,Lt(t.Ga,t),t.A=0)}function an(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=ae(p(t.Ga,t),gn(t,t.A)),t.A++,!0)}function ln(t){null!=t.B&&(r.clearTimeout(t.B),t.B=null)}function un(t){t.g=new be(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Ke(t.oa);Ve(e,"RID","rpc"),Ve(e,"SID",t.J),Ve(e,"CI",t.N?"0":"1"),Ve(e,"AID",t.U),rn(t,e),Ve(e,"TYPE","xmlhttp"),t.o&&t.s&&Vi(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var i=t.g;t=t.la,i.K=1,i.v=$e(Ke(e)),i.s=null,i.U=!0,je(i,t)}function cn(t){null!=t.v&&(r.clearTimeout(t.v),t.v=null)}function fn(t,e){var i=null;if(t.g==e){cn(t),ln(t),t.g=null;var n=2}else{if(!mi(t.i,e))return;i=e.D,wi(t.i,e),n=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==n){i=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;jt(n=ie(),new he(n,i,e,s)),en(t)}else hn(t);else if(3==(s=e.o)||0==s&&0<t.I||!(1==n&&nn(t,e)||2==n&&an(t)))switch(i&&0<i.length&&(e=t.i,e.i=e.i.concat(i)),s){case 1:pn(t,5);break;case 4:pn(t,10);break;case 3:pn(t,6);break;default:pn(t,2)}}function gn(t,e){let i=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(i*=2),i*e}function pn(t,e){if(t.h.info("Error code "+e),2==e){var i=null;t.j&&(i=null);var n=p(t.jb,t);i||(i=new Ue("//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||Ye(i,"https"),$e(i)),ji(i.toString(),n)}else oe(2);t.G=0,t.j&&t.j.va(e),dn(t),Qi(t)}function dn(t){t.G=0,t.I=-1,t.j&&(0==Ti(t.i).length&&0==t.l.length||(t.i.i.length=0,x(t.l),t.l.length=0),t.j.ua())}function vn(t,e,i){let n=qe(i);if(""!=n.i)e&&Ge(n,e+"."+n.i),Je(n,n.m);else{const t=r.location;n=ze(t.protocol,e?e+"."+t.hostname:t.hostname,+t.port,i)}return t.aa&&D(t.aa,function(t,e){Ve(n,e,t)}),e=t.D,i=t.sa,e&&i&&Ve(n,e,i),Ve(n,"VER",t.ma),rn(t,n),n}function yn(t,e,i){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=i&&t.Ba&&!t.qa?new Li(new Ii({ib:!0})):new Li(t.qa)).L=t.H,e}function mn(){}function bn(){if(F&&!(10<=Number(Q)))throw Error("Environmental error: no available transport.")}function wn(t,e){xt.call(this),this.g=new qi(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!j(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!j(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Sn(this)}function Tn(t){ve.call(this);var e=t.__sm__;if(e){t:{for(const i in e){t=i;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function En(){ye.call(this),this.status=1}function Sn(t){this.g=t}(n=Li.prototype).ea=function(t,e,i,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():pe.g(),this.C=this.u?fe(this.u):fe(pe),this.g.onreadystatechange=p(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){return void Fi(this,o)}t=i||"";const s=new ke(this.headers);n&&He(n,function(t,e){s.set(e,t)}),n=E(s.T()),i=r.FormData&&t instanceof r.FormData,!(0<=w(ki,e))||n||i||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(t,e){this.g.setRequestHeader(e,t)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Yi(this),0<this.B&&((this.K=_i(this.g))?(this.g.timeout=this.B,this.g.ontimeout=p(this.pa,this)):this.A=Nt(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){Fi(this,o)}},n.pa=function(){void 0!==s&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,jt(this,"timeout"),this.abort(8))},n.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,jt(this,"complete"),jt(this,"abort"),Ki(this))},n.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ki(this,!0)),Li.Z.M.call(this)},n.Fa=function(){this.s||(this.F||this.v||this.l?Ui(this):this.cb())},n.cb=function(){Ui(this)},n.ba=function(){try{return 2<Gi(this)?this.g.status:-1}catch(t){return-1}},n.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},n.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Mi(e)}},n.Da=function(){return this.m},n.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(n=qi.prototype).ma=8,n.G=1,n.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},n.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new be(this,this.h,t,void 0);let r=this.s;if(this.P&&(r?X(r=M(r),this.P):r=this.P),null===this.o&&(s.H=r),this.ja)t:{for(var e=0,i=0;i<this.l.length;i++){var n=this.l[i];if(void 0===(n="__data__"in n.g&&"string"==typeof(n=n.g.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=i;break t}if(4096===e||i===this.l.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=on(this,s,e),Ve(i=Ke(this.F),"RID",t),Ve(i,"CVER",22),this.D&&Ve(i,"X-HTTP-Session-Id",this.D),rn(this,i),this.o&&r&&Vi(i,this.o,r),bi(this.i,s),this.Ra&&Ve(i,"TYPE","init"),this.ja?(Ve(i,"$req",e),Ve(i,"SID","null"),s.$=!0,xe(s,i,null)):xe(s,i,e),this.G=2}}else 3==this.G&&(t?sn(this,t):0==this.l.length||vi(this.i)||sn(this))},n.Ga=function(){if(this.u=null,un(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ae(p(this.bb,this),t)}},n.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,oe(10),Zi(this),un(this))},n.ab=function(){null!=this.v&&(this.v=null,Zi(this),an(this),oe(19))},n.jb=function(t){t?(this.h.info("Successfully pinged google.com"),oe(2)):(this.h.info("Failed to ping google.com"),oe(1))},(n=mn.prototype).xa=function(){},n.wa=function(){},n.va=function(){},n.ua=function(){},n.Oa=function(){},bn.prototype.g=function(t,e){return new wn(t,e)},v(wn,xt),wn.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,i=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Lt(p(t.hb,t,e))),oe(0),t.W=e,t.aa=i||{},t.N=t.X,t.F=vn(t,null,t.W),en(t)},wn.prototype.close=function(){zi(this.g)},wn.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,tn(this.g,e)}else this.v?((e={}).__data__=It(t),tn(this.g,e)):tn(this.g,t)},wn.prototype.M=function(){this.g.j=null,delete this.j,zi(this.g),delete this.g,wn.Z.M.call(this)},v(Tn,ve),v(En,ye),v(Sn,mn),Sn.prototype.xa=function(){jt(this.g,"a")},Sn.prototype.wa=function(t){jt(this.g,new Tn(t))},Sn.prototype.va=function(t){jt(this.g,new En(t))},Sn.prototype.ua=function(){jt(this.g,"b")},bn.prototype.createWebChannel=bn.prototype.g,wn.prototype.send=wn.prototype.u,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,le.NO_ERROR=0,le.TIMEOUT=8,le.HTTP_ERROR=6,ue.COMPLETE="complete",ge.EventType=de,de.OPEN="a",de.CLOSE="b",de.ERROR="c",de.MESSAGE="d",xt.prototype.listen=xt.prototype.N,Li.prototype.listenOnce=Li.prototype.O,Li.prototype.getLastError=Li.prototype.La,Li.prototype.getLastErrorCode=Li.prototype.Da,Li.prototype.getStatus=Li.prototype.ba,Li.prototype.getResponseJson=Li.prototype.Qa,Li.prototype.getResponseText=Li.prototype.ga,Li.prototype.send=Li.prototype.ea;var xn=i.createWebChannelTransport=function(){return new bn};exports.createWebChannelTransport=xn;var jn=i.getStatEventTarget=function(){return ie()};exports.getStatEventTarget=jn;var Cn=i.ErrorCode=le;exports.ErrorCode=Cn;var In=i.EventType=ue;exports.EventType=In;var An=i.Event=te;exports.Event=An;var Rn=i.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20};exports.Stat=Rn;var On=i.FetchXmlHttpFactory=Ii;exports.FetchXmlHttpFactory=On;var Pn=i.WebChannel=ge;exports.WebChannel=Pn;var Dn=i.XhrIo=Li;exports.XhrIo=Dn;
},{}],"pBGv":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"lBbe":[function(require,module,exports) {
var process = require("process");
var e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports._cast=Ha,exports._debugAssert=w,exports._isBase64Available=G,exports._logWarn=m,exports._validateIsNotUsedTogether=za,exports.addDoc=Hu,exports.arrayRemove=sh,exports.arrayUnion=rh,exports.clearIndexedDbPersistence=Ic,exports.collection=nc,exports.collectionGroup=rc,exports.connectFirestoreEmulator=Xa,exports.deleteDoc=Qu,exports.deleteField=th,exports.disableNetwork=Ec,exports.doc=sc,exports.documentId=Dc,exports.enableIndexedDbPersistence=gc,exports.enableMultiTabIndexedDbPersistence=yc,exports.enableNetwork=Tc,exports.endAt=Du,exports.endBefore=xu,exports.ensureFirestoreConfigured=mc,exports.executeWrite=Ju,exports.getDoc=qu,exports.getDocFromCache=Uu,exports.getDocFromServer=Bu,exports.getDocs=Ku,exports.getDocsFromCache=$u,exports.getDocsFromServer=zu,exports.getFirestore=fc,exports.increment=ih,exports.initializeFirestore=dc,exports.limit=Tu,exports.limitToLast=Eu,exports.loadBundle=Sc,exports.namedQuery=Nc,exports.onSnapshot=Wu,exports.onSnapshotsInSync=Yu,exports.orderBy=Iu,exports.query=pu,exports.queryEqual=oc,exports.refEqual=ic,exports.runTransaction=eh,exports.serverTimestamp=nh,exports.setDoc=Gu,exports.setLogLevel=l,exports.snapshotEqual=du,exports.startAfter=Nu,exports.startAt=Su,exports.terminate=bc,exports.updateDoc=ju,exports.waitForPendingWrites=vc,exports.where=yu,exports.writeBatch=oh,exports._FieldPath=exports._EmptyCredentialsProvider=exports._DocumentKey=exports._DatabaseId=exports.WriteBatch=exports.Transaction=exports.Timestamp=exports.SnapshotMetadata=exports.QuerySnapshot=exports.QueryDocumentSnapshot=exports.QueryConstraint=exports.Query=exports.LoadBundleTask=exports.GeoPoint=exports.FirestoreError=exports.Firestore=exports.FieldValue=exports.FieldPath=exports.DocumentSnapshot=exports.DocumentReference=exports.CollectionReference=exports.CACHE_SIZE_UNLIMITED=exports.Bytes=exports.AbstractUserDataWriter=void 0;var t=require("@firebase/app"),n=require("@firebase/component"),r=require("@firebase/logger"),s=require("@firebase/util"),i=require("@firebase/webchannel-wrapper");const o="@firebase/firestore";class a{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}a.UNAUTHENTICATED=new a(null),a.GOOGLE_CREDENTIALS=new a("google-credentials-uid"),a.FIRST_PARTY=new a("first-party-uid"),a.MOCK_USER=new a("mock-user");let c="9.1.3";const u=new r.Logger("@firebase/firestore");function h(){return u.logLevel}function l(e){u.setLogLevel(e)}function d(e,...t){if(u.logLevel<=r.LogLevel.DEBUG){const n=t.map(p);u.debug(`Firestore (${c}): ${e}`,...n)}}function f(e,...t){if(u.logLevel<=r.LogLevel.ERROR){const n=t.map(p);u.error(`Firestore (${c}): ${e}`,...n)}}function m(e,...t){if(u.logLevel<=r.LogLevel.WARN){const n=t.map(p);u.warn(`Firestore (${c}): ${e}`,...n)}}function p(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function g(e="Unexpected state"){const t=`FIRESTORE (${c}) INTERNAL ASSERTION FAILED: `+e;throw f(t),new Error(t)}function y(e,t){e||g()}function w(e,t){e||g()}function I(e,t){return e}const v={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class T extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=(()=>`${this.name}: [code=${this.code}]: ${this.message}`)}}exports.FirestoreError=T;class E{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class b{constructor(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${e}`}}class S{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(a.UNAUTHENTICATED))}shutdown(){}}exports._EmptyCredentialsProvider=S;class N{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class _{constructor(e){this.t=e,this.currentUser=a.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new E;this.o=(()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new E,e.enqueueRetryable(()=>r(this.currentUser))});const i=()=>{const t=s;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{d("FirebaseCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),i()};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(d("FirebaseCredentialsProvider","Auth not yet detected"),s.resolve(),s=new E)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(d("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(y("string"==typeof t.accessToken),new b(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return y(null===e||"string"==typeof e),new a(e)}}class x{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=a.FIRST_PARTY}get authHeaders(){const e={"X-Goog-AuthUser":this.l},t=this.h.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.m&&(e["X-Goog-Iam-Authorization-Token"]=this.m),e}}class D{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new x(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(a.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class A{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=(e=>this.g(e)),this.p=(e=>t.writeSequenceNumber(e)))}g(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.p&&this.p(e),e}}function k(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}A.T=-1;class C{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=k(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%e.length))}return n}}function L(e,t){return e<t?-1:e>t?1:0}function R(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}function F(e){return e+"\0"}class M{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new T(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new T(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new T(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new T(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return M.fromMillis(Date.now())}static fromDate(e){return M.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new M(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?L(this.nanoseconds,e.nanoseconds):L(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}exports.Timestamp=M;class O{constructor(e){this.timestamp=e}static fromTimestamp(e){return new O(e)}static min(){return new O(new M(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function P(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function q(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function V(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class U{constructor(e,t,n){void 0===t?t=0:t>e.length&&g(),void 0===n?n=e.length-t:n>e.length-t&&g(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===U.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof U?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),s=t.get(r);if(n<s)return-1;if(n>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class B extends U{construct(e,t,n){return new B(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new T(v.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new B(t)}static emptyPath(){return new B([])}}const K=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $ extends U{construct(e,t,n){return new $(e,t,n)}static isValidIdentifier(e){return K.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new $(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new T(v.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new T(v.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new T(v.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(s(),r++)}if(s(),i)throw new T(v.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $(t)}static emptyPath(){return new $([])}}exports._FieldPath=$;class z{constructor(e){this.fields=e,e.sort($.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return R(this.fields,e.fields,(e,t)=>e.isEqual(t))}}function G(){return"undefined"!=typeof atob}class j{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new j(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new j(t)}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return L(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}j.EMPTY_BYTE_STRING=new j("");const Q=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function H(e){if(y(!!e),"string"==typeof e){let t=0;const n=Q.exec(e);if(y(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:W(e.seconds),nanos:W(e.nanos)}}function W(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Y(e){return"string"==typeof e?j.fromBase64String(e):j.fromUint8Array(e)}function J(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function X(e){const t=e.mapValue.fields.__previous_value__;return J(t)?X(t):t}function Z(e){const t=H(e.mapValue.fields.__local_write_time__.timestampValue);return new M(t.seconds,t.nanos)}function ee(e){return null==e}function te(e){return 0===e&&1/e==-1/0}function ne(e){return"number"==typeof e&&Number.isInteger(e)&&!te(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}class re{constructor(e){this.path=e}static fromPath(e){return new re(B.fromString(e))}static fromName(e){return new re(B.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===B.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return B.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new re(new B(e.slice()))}}function se(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?J(e)?4:10:g()}function ie(e,t){const n=se(e);if(n!==se(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Z(e).isEqual(Z(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=H(e.timestampValue),r=H(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Y(e.bytesValue).isEqual(Y(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return W(e.geoPointValue.latitude)===W(t.geoPointValue.latitude)&&W(e.geoPointValue.longitude)===W(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return W(e.integerValue)===W(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=W(e.doubleValue),r=W(t.doubleValue);return n===r?te(n)===te(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return R(e.arrayValue.values||[],t.arrayValue.values||[],ie);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(P(n)!==P(r))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===r[s]||!ie(n[s],r[s])))return!1;return!0}(e,t);default:return g()}}function oe(e,t){return void 0!==(e.values||[]).find(e=>ie(e,t))}function ae(e,t){const n=se(e),r=se(t);if(n!==r)return L(n,r);switch(n){case 0:return 0;case 1:return L(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=W(e.integerValue||e.doubleValue),r=W(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ce(e.timestampValue,t.timestampValue);case 4:return ce(Z(e),Z(t));case 5:return L(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Y(e),r=Y(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let s=0;s<n.length&&s<r.length;s++){const e=L(n[s],r[s]);if(0!==e)return e}return L(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=L(W(e.latitude),W(t.latitude));return 0!==n?n:L(W(e.longitude),W(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let s=0;s<n.length&&s<r.length;++s){const e=ae(n[s],r[s]);if(e)return e}return L(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=Object.keys(n),s=t.fields||{},i=Object.keys(s);r.sort(),i.sort();for(let o=0;o<r.length&&o<i.length;++o){const e=L(r[o],i[o]);if(0!==e)return e;const t=ae(n[r[o]],s[i[o]]);if(0!==t)return t}return L(r.length,i.length)}(e.mapValue,t.mapValue);default:throw g()}}function ce(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return L(e,t);const n=H(e),r=H(t),s=L(n.seconds,r.seconds);return 0!==s?s:L(n.nanos,r.nanos)}function ue(e){return he(e)}function he(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=H(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Y(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,re.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=he(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+=`${s}:${he(e.fields[s])}`;return n+"}"}(e.mapValue):g();var t,n}function le(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function de(e){return!!e&&"integerValue"in e}function fe(e){return!!e&&"arrayValue"in e}function me(e){return!!e&&"nullValue"in e}function pe(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ge(e){return!!e&&"mapValue"in e}function ye(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return q(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=ye(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ye(e.arrayValue.values[n]);return t}return Object.assign({},e)}exports._DocumentKey=re;class we{constructor(e){this.value=e}static empty(){return new we({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(!ge(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ye(t)}setAll(e){let t=$.emptyPath(),n={},r=[];e.forEach((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=ye(e):r.push(s.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());ge(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ie(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];ge(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){q(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new we(ye(this.value))}}function Ie(e){const t=[];return q(e.fields,(e,n)=>{const r=new $([e]);if(ge(n)){const e=Ie(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new z(t)}class ve{constructor(e,t,n,r,s){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=s}static newInvalidDocument(e){return new ve(e,0,O.min(),we.empty(),0)}static newFoundDocument(e,t,n){return new ve(e,1,t,n,0)}static newNoDocument(e,t){return new ve(e,2,t,we.empty(),0)}static newUnknownDocument(e,t){return new ve(e,3,t,we.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=we.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=we.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ve&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}clone(){return new ve(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Te{constructor(e,t=null,n=[],r=[],s=null,i=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=i,this.endAt=o,this.A=null}}function Ee(e,t=null,n=[],r=[],s=null,i=null,o=null){return new Te(e,t,n,r,s,i,o)}function be(e){const t=I(e);if(null===t.A){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>De(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>(function(e){return e.field.canonicalString()+e.dir})(e)).join(","),ee(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=qe(t.startAt)),t.endAt&&(e+="|ub:",e+=qe(t.endAt)),t.A=e}return t.A}function Se(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>{return`${(t=e).field.canonicalString()} ${t.op} ${ue(t.value)}`;var t}).join(", ")}]`),ee(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>(function(e){return`${e.field.canonicalString()} (${e.dir})`})(e)).join(", ")}]`),e.startAt&&(t+=", startAt: "+qe(e.startAt)),e.endAt&&(t+=", endAt: "+qe(e.endAt)),`Target(${t})`}function Ne(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<e.orderBy.length;s++)if(!Ue(e.orderBy[s],t.orderBy[s]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let s=0;s<e.filters.length;s++)if(n=e.filters[s],r=t.filters[s],n.op!==r.op||!n.field.isEqual(r.field)||!ie(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ke(e.startAt,t.startAt)&&Ke(e.endAt,t.endAt)}function _e(e){return re.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class xe extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.R(e,t,n):new Ae(e,t,n):"array-contains"===t?new Re(e,n):"in"===t?new Fe(e,n):"not-in"===t?new Me(e,n):"array-contains-any"===t?new Oe(e,n):new xe(e,t,n)}static R(e,t,n){return"in"===t?new ke(e,n):new Ce(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.P(ae(t,this.value)):null!==t&&se(this.value)===se(t)&&this.P(ae(t,this.value))}P(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return g()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}function De(e){return e.field.canonicalString()+e.op.toString()+ue(e.value)}class Ae extends xe{constructor(e,t,n){super(e,t,n),this.key=re.fromName(n.referenceValue)}matches(e){const t=re.comparator(e.key,this.key);return this.P(t)}}class ke extends xe{constructor(e,t){super(e,"in",t),this.keys=Le("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ce extends xe{constructor(e,t){super(e,"not-in",t),this.keys=Le("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Le(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>re.fromName(e.referenceValue))}class Re extends xe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return fe(t)&&oe(t.arrayValue,this.value)}}class Fe extends xe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&oe(this.value.arrayValue,t)}}class Me extends xe{constructor(e,t){super(e,"not-in",t)}matches(e){if(oe(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!oe(this.value.arrayValue,t)}}class Oe extends xe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!fe(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>oe(this.value.arrayValue,e))}}class Pe{constructor(e,t){this.position=e,this.before=t}}function qe(e){return`${e.before?"b":"a"}:${e.position.map(e=>ue(e)).join(",")}`}class Ve{constructor(e,t="asc"){this.field=e,this.dir=t}}function Ue(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Be(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],o=e.position[s];if(r=i.field.isKeyField()?re.comparator(re.fromName(o.referenceValue),n.key):ae(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function Ke(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!ie(e.position[n],t.position[n]))return!1;return!0}class $e{constructor(e,t=null,n=[],r=[],s=null,i="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=i,this.startAt=o,this.endAt=a,this.V=null,this.S=null,this.startAt,this.endAt}}function ze(e,t,n,r,s,i,o,a){return new $e(e,t,n,r,s,i,o,a)}function Ge(e){return new $e(e)}function je(e){return!ee(e.limit)&&"F"===e.limitType}function Qe(e){return!ee(e.limit)&&"L"===e.limitType}function He(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function We(e){for(const t of e.filters)if(t.v())return t.field;return null}function Ye(e){return null!==e.collectionGroup}function Je(e){const t=I(e);if(null===t.V){t.V=[];const e=We(t),n=He(t);if(null!==e&&null===n)e.isKeyField()||t.V.push(new Ve(e)),t.V.push(new Ve($.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.V.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.V.push(new Ve($.keyField(),e))}}}return t.V}function Xe(e){const t=I(e);if(!t.S)if("F"===t.limitType)t.S=Ee(t.path,t.collectionGroup,Je(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const s of Je(t)){const t="desc"===s.dir?"asc":"desc";e.push(new Ve(s.field,t))}const n=t.endAt?new Pe(t.endAt.position,!t.endAt.before):null,r=t.startAt?new Pe(t.startAt.position,!t.startAt.before):null;t.S=Ee(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.S}function Ze(e,t,n){return new $e(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function et(e,t){return Ne(Xe(e),Xe(t))&&e.limitType===t.limitType}function tt(e){return`${be(Xe(e))}|lt:${e.limitType}`}function nt(e){return`Query(target=${Se(Xe(e))}; limitType=${e.limitType})`}function rt(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):re.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!Be(e.startAt,Je(e),t))&&(!e.endAt||!Be(e.endAt,Je(e),t))}(e,t)}function st(e){return(t,n)=>{let r=!1;for(const s of Je(e)){const e=it(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}function it(e,t,n){const r=e.field.isKeyField()?re.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?ae(r,s):g()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return g()}}function ot(e,t){if(e.D){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:te(t)?"-0":t}}function at(e){return{integerValue:""+e}}function ct(e,t){return ne(t)?at(t):ot(e,t)}class ut{constructor(){this._=void 0}}function ht(e,t,n){return e instanceof ft?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof mt?pt(e,t):e instanceof gt?yt(e,t):function(e,t){const n=dt(e,t),r=It(n)+It(e.C);return de(n)&&de(e.C)?at(r):ot(e.N,r)}(e,t)}function lt(e,t,n){return e instanceof mt?pt(e,t):e instanceof gt?yt(e,t):n}function dt(e,t){return e instanceof wt?de(n=t)||n&&"doubleValue"in n?t:{integerValue:0}:null;var n}class ft extends ut{}class mt extends ut{constructor(e){super(),this.elements=e}}function pt(e,t){const n=vt(t);for(const r of e.elements)n.some(e=>ie(e,r))||n.push(r);return{arrayValue:{values:n}}}class gt extends ut{constructor(e){super(),this.elements=e}}function yt(e,t){let n=vt(t);for(const r of e.elements)n=n.filter(e=>!ie(e,r));return{arrayValue:{values:n}}}class wt extends ut{constructor(e,t){super(),this.N=e,this.C=t}}function It(e){return W(e.integerValue||e.doubleValue)}function vt(e){return fe(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Tt{constructor(e,t){this.field=e,this.transform=t}}function Et(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof mt&&t instanceof mt||e instanceof gt&&t instanceof gt?R(e.elements,t.elements,ie):e instanceof wt&&t instanceof wt?ie(e.C,t.C):e instanceof ft&&t instanceof ft}(e.transform,t.transform)}class bt{constructor(e,t){this.version=e,this.transformResults=t}}class St{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new St}static exists(e){return new St(void 0,e)}static updateTime(e){return new St(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nt(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class _t{}function xt(e,t,n){e instanceof Lt?function(e,t,n){const r=e.value.clone(),s=Mt(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Rt?function(e,t,n){if(!Nt(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Mt(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(Ft(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Dt(e,t,n){e instanceof Lt?function(e,t,n){if(!Nt(e.precondition,t))return;const r=e.value.clone(),s=Ot(e.fieldTransforms,n,t);r.setAll(s),t.convertToFoundDocument(Ct(t),r).setHasLocalMutations()}(e,t,n):e instanceof Rt?function(e,t,n){if(!Nt(e.precondition,t))return;const r=Ot(e.fieldTransforms,n,t),s=t.data;s.setAll(Ft(e)),s.setAll(r),t.convertToFoundDocument(Ct(t),s).setHasLocalMutations()}(e,t,n):function(e,t){Nt(e.precondition,t)&&t.convertToNoDocument(O.min())}(e,t)}function At(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),s=dt(r.transform,e||null);null!=s&&(null==n&&(n=we.empty()),n.set(r.field,s))}return n||null}function kt(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&R(e,t,(e,t)=>Et(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function Ct(e){return e.isFoundDocument()?e.version:O.min()}class Lt extends _t{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}}class Rt extends _t{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}}function Ft(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Mt(e,t,n){const r=new Map;y(e.length===n.length);for(let s=0;s<n.length;s++){const i=e[s],o=i.transform,a=t.data.field(i.field);r.set(i.field,lt(o,a,n[s]))}return r}function Ot(e,t,n){const r=new Map;for(const s of e){const e=s.transform,i=n.data.field(s.field);r.set(s.field,ht(e,i,t))}return r}class Pt extends _t{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class qt extends _t{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}class Vt{constructor(e){this.count=e}}var Ut,Bt;function Kt(e){switch(e){default:return g();case v.CANCELLED:case v.UNKNOWN:case v.DEADLINE_EXCEEDED:case v.RESOURCE_EXHAUSTED:case v.INTERNAL:case v.UNAVAILABLE:case v.UNAUTHENTICATED:return!1;case v.INVALID_ARGUMENT:case v.NOT_FOUND:case v.ALREADY_EXISTS:case v.PERMISSION_DENIED:case v.FAILED_PRECONDITION:case v.ABORTED:case v.OUT_OF_RANGE:case v.UNIMPLEMENTED:case v.DATA_LOSS:return!0}}function $t(e){if(void 0===e)return f("GRPC error has no .code"),v.UNKNOWN;switch(e){case Ut.OK:return v.OK;case Ut.CANCELLED:return v.CANCELLED;case Ut.UNKNOWN:return v.UNKNOWN;case Ut.DEADLINE_EXCEEDED:return v.DEADLINE_EXCEEDED;case Ut.RESOURCE_EXHAUSTED:return v.RESOURCE_EXHAUSTED;case Ut.INTERNAL:return v.INTERNAL;case Ut.UNAVAILABLE:return v.UNAVAILABLE;case Ut.UNAUTHENTICATED:return v.UNAUTHENTICATED;case Ut.INVALID_ARGUMENT:return v.INVALID_ARGUMENT;case Ut.NOT_FOUND:return v.NOT_FOUND;case Ut.ALREADY_EXISTS:return v.ALREADY_EXISTS;case Ut.PERMISSION_DENIED:return v.PERMISSION_DENIED;case Ut.FAILED_PRECONDITION:return v.FAILED_PRECONDITION;case Ut.ABORTED:return v.ABORTED;case Ut.OUT_OF_RANGE:return v.OUT_OF_RANGE;case Ut.UNIMPLEMENTED:return v.UNIMPLEMENTED;case Ut.DATA_LOSS:return v.DATA_LOSS;default:return g()}}(Bt=Ut||(Ut={}))[Bt.OK=0]="OK",Bt[Bt.CANCELLED=1]="CANCELLED",Bt[Bt.UNKNOWN=2]="UNKNOWN",Bt[Bt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Bt[Bt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Bt[Bt.NOT_FOUND=5]="NOT_FOUND",Bt[Bt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Bt[Bt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Bt[Bt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Bt[Bt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Bt[Bt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Bt[Bt.ABORTED=10]="ABORTED",Bt[Bt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Bt[Bt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Bt[Bt.INTERNAL=13]="INTERNAL",Bt[Bt.UNAVAILABLE=14]="UNAVAILABLE",Bt[Bt.DATA_LOSS=15]="DATA_LOSS";class zt{constructor(e,t){this.comparator=e,this.root=t||jt.EMPTY}insert(e,t){return new zt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,jt.BLACK,null,null))}remove(e){return new zt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gt(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gt(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gt(this.root,e,this.comparator,!0)}}class Gt{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jt{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:jt.RED,this.left=null!=r?r:jt.EMPTY,this.right=null!=s?s:jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new jt(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return(r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}removeMin(){if(this.left.isEmpty())return jt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return jt.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw g();if(this.right.isRed())throw g();const e=this.left.check();if(e!==this.right.check())throw g();return e+(this.isRed()?0:1)}}jt.EMPTY=null,jt.RED=!0,jt.BLACK=!1,jt.EMPTY=new class{constructor(){this.size=0}get key(){throw g()}get value(){throw g()}get color(){throw g()}get left(){throw g()}get right(){throw g()}copy(e,t,n,r,s){return this}insert(e,t,n){return new jt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Qt{constructor(e){this.comparator=e,this.data=new zt(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ht(this.data.getIterator())}getIteratorFrom(e){return new Ht(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Qt))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Qt(this.comparator);return t.data=e,t}}class Ht{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const Wt=new zt(re.comparator);function Yt(){return Wt}const Jt=new zt(re.comparator);function Xt(){return Jt}const Zt=new zt(re.comparator);function en(){return Zt}const tn=new Qt(re.comparator);function nn(...e){let t=tn;for(const n of e)t=t.add(n);return t}const rn=new Qt(L);function sn(){return rn}class on{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,an.createSynthesizedTargetChangeForCurrentChange(e,t)),new on(O.min(),n,sn(),Yt(),nn())}}class an{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t){return new an(j.EMPTY_BYTE_STRING,t,nn(),nn(),nn())}}class cn{constructor(e,t,n,r){this.k=e,this.removedTargetIds=t,this.key=n,this.$=r}}class un{constructor(e,t){this.targetId=e,this.O=t}}class hn{constructor(e,t,n=j.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class ln{constructor(){this.F=0,this.M=mn(),this.L=j.EMPTY_BYTE_STRING,this.B=!1,this.U=!0}get current(){return this.B}get resumeToken(){return this.L}get q(){return 0!==this.F}get K(){return this.U}j(e){e.approximateByteSize()>0&&(this.U=!0,this.L=e)}W(){let e=nn(),t=nn(),n=nn();return this.M.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:g()}}),new an(this.L,this.B,e,t,n)}G(){this.U=!1,this.M=mn()}H(e,t){this.U=!0,this.M=this.M.insert(e,t)}J(e){this.U=!0,this.M=this.M.remove(e)}Y(){this.F+=1}X(){this.F-=1}Z(){this.U=!0,this.B=!0}}class dn{constructor(e){this.tt=e,this.et=new Map,this.nt=Yt(),this.st=fn(),this.it=new Qt(L)}rt(e){for(const t of e.k)e.$&&e.$.isFoundDocument()?this.ot(t,e.$):this.at(t,e.key,e.$);for(const t of e.removedTargetIds)this.at(t,e.key,e.$)}ct(e){this.forEachTarget(e,t=>{const n=this.ut(t);switch(e.state){case 0:this.ht(t)&&n.j(e.resumeToken);break;case 1:n.X(),n.q||n.G(),n.j(e.resumeToken);break;case 2:n.X(),n.q||this.removeTarget(t);break;case 3:this.ht(t)&&(n.Z(),n.j(e.resumeToken));break;case 4:this.ht(t)&&(this.lt(t),n.j(e.resumeToken));break;default:g()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.et.forEach((e,n)=>{this.ht(n)&&t(n)})}ft(e){const t=e.targetId,n=e.O.count,r=this.dt(t);if(r){const e=r.target;if(_e(e))if(0===n){const n=new re(e.path);this.at(t,n,ve.newNoDocument(n,O.min()))}else y(1===n);else this.wt(t)!==n&&(this.lt(t),this.it=this.it.add(t))}}_t(e){const t=new Map;this.et.forEach((n,r)=>{const s=this.dt(r);if(s){if(n.current&&_e(s.target)){const t=new re(s.target.path);null!==this.nt.get(t)||this.gt(r,t)||this.at(r,t,ve.newNoDocument(t,e))}n.K&&(t.set(r,n.W()),n.G())}});let n=nn();this.st.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.dt(e);return!t||2===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))});const r=new on(e,t,this.it,this.nt,n);return this.nt=Yt(),this.st=fn(),this.it=new Qt(L),r}ot(e,t){if(!this.ht(e))return;const n=this.gt(e,t.key)?2:0;this.ut(e).H(t.key,n),this.nt=this.nt.insert(t.key,t),this.st=this.st.insert(t.key,this.yt(t.key).add(e))}at(e,t,n){if(!this.ht(e))return;const r=this.ut(e);this.gt(e,t)?r.H(t,1):r.J(t),this.st=this.st.insert(t,this.yt(t).delete(e)),n&&(this.nt=this.nt.insert(t,n))}removeTarget(e){this.et.delete(e)}wt(e){const t=this.ut(e).W();return this.tt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Y(e){this.ut(e).Y()}ut(e){let t=this.et.get(e);return t||(t=new ln,this.et.set(e,t)),t}yt(e){let t=this.st.get(e);return t||(t=new Qt(L),this.st=this.st.insert(e,t)),t}ht(e){const t=null!==this.dt(e);return t||d("WatchChangeAggregator","Detected inactive target",e),t}dt(e){const t=this.et.get(e);return t&&t.q?null:this.tt.Tt(e)}lt(e){this.et.set(e,new ln),this.tt.getRemoteKeysForTarget(e).forEach(t=>{this.at(e,t,null)})}gt(e,t){return this.tt.getRemoteKeysForTarget(e).has(t)}}function fn(){return new zt(re.comparator)}function mn(){return new zt(re.comparator)}const pn={asc:"ASCENDING",desc:"DESCENDING"},gn={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class yn{constructor(e,t){this.databaseId=e,this.D=t}}function wn(e,t){return e.D?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function In(e,t){return e.D?t.toBase64():t.toUint8Array()}function vn(e,t){return wn(e,t.toTimestamp())}function Tn(e){return y(!!e),O.fromTimestamp(function(e){const t=H(e);return new M(t.seconds,t.nanos)}(e))}function En(e,t){return function(e){return new B(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function bn(e){const t=B.fromString(e);return y(Jn(t)),t}function Sn(e,t){return En(e.databaseId,t.path)}function Nn(e,t){const n=bn(t);if(n.get(1)!==e.databaseId.projectId)throw new T(v.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new T(v.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new re(An(n))}function _n(e,t){return En(e.databaseId,t)}function xn(e){const t=bn(e);return 4===t.length?B.emptyPath():An(t)}function Dn(e){return new B(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function An(e){return y(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function kn(e,t,n){return{name:Sn(e,t),fields:n.value.mapValue.fields}}function Cn(e,t,n){const r=Nn(e,t.name),s=Tn(t.updateTime),i=new we({mapValue:{fields:t.fields}}),o=ve.newFoundDocument(r,s,i);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function Ln(e,t){return"found"in t?function(e,t){y(!!t.found),t.found.name,t.found.updateTime;const n=Nn(e,t.found.name),r=Tn(t.found.updateTime),s=new we({mapValue:{fields:t.found.fields}});return ve.newFoundDocument(n,r,s)}(e,t):"missing"in t?function(e,t){y(!!t.missing),y(!!t.readTime);const n=Nn(e,t.missing),r=Tn(t.readTime);return ve.newNoDocument(n,r)}(e,t):g()}function Rn(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:g()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(e,t){return e.D?(y(void 0===t||"string"==typeof t),j.fromBase64String(t||"")):(y(void 0===t||t instanceof Uint8Array),j.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?v.UNKNOWN:$t(e.code);return new T(t,e.message||"")}(o);n=new hn(r,s,i,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=Nn(e,r.document.name),i=Tn(r.document.updateTime),o=new we({mapValue:{fields:r.document.fields}}),a=ve.newFoundDocument(s,i,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new cn(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=Nn(e,r.document),i=r.readTime?Tn(r.readTime):O.min(),o=ve.newNoDocument(s,i),a=r.removedTargetIds||[];n=new cn([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=Nn(e,r.document),i=r.removedTargetIds||[];n=new cn([],i,s,null)}else{if(!("filter"in t))return g();{t.filter;const e=t.filter;e.targetId;const r=e.count||0,s=new Vt(r),i=e.targetId;n=new un(i,s)}}return n}function Fn(e,t){let n;if(t instanceof Lt)n={update:kn(e,t.key,t.value)};else if(t instanceof Pt)n={delete:Sn(e,t.key)};else if(t instanceof Rt)n={update:kn(e,t.key,t.data),updateMask:Yn(t.fieldMask)};else{if(!(t instanceof qt))return g();n={verify:Sn(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>(function(e,t){const n=t.transform;if(n instanceof ft)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof mt)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof gt)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof wt)return{fieldPath:t.field.canonicalString(),increment:n.C};throw g()})(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:vn(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:g()}(e,t.precondition)),n}function Mn(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?St.updateTime(Tn(e.updateTime)):void 0!==e.exists?St.exists(e.exists):St.none()}(t.currentDocument):St.none(),r=t.updateTransforms?t.updateTransforms.map(t=>(function(e,t){let n=null;if("setToServerValue"in t)y("REQUEST_TIME"===t.setToServerValue),n=new ft;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new mt(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new gt(e)}else"increment"in t?n=new wt(e,t.increment):g();const r=$.fromServerFormat(t.fieldPath);return new Tt(r,n)})(e,t)):[];if(t.update){t.update.name;const s=Nn(e,t.update.name),i=new we({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new z(t.map(e=>$.fromServerFormat(e)))}(t.updateMask);return new Rt(s,i,e,n,r)}return new Lt(s,i,n,r)}if(t.delete){const r=Nn(e,t.delete);return new Pt(r,n)}if(t.verify){const r=Nn(e,t.verify);return new qt(r,n)}return g()}function On(e,t){return e&&e.length>0?(y(void 0!==t),e.map(e=>(function(e,t){let n=e.updateTime?Tn(e.updateTime):Tn(t);return n.isEqual(O.min())&&(n=Tn(t)),new bt(n,e.transformResults||[])})(e,t))):[]}function Pn(e,t){return{documents:[_n(e,t.path)]}}function qn(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=_n(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=_n(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(e){if(0===e.length)return;const t=e.map(e=>(function(e){if("=="===e.op){if(pe(e.value))return{unaryFilter:{field:jn(e.field),op:"IS_NAN"}};if(me(e.value))return{unaryFilter:{field:jn(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(pe(e.value))return{unaryFilter:{field:jn(e.field),op:"IS_NOT_NAN"}};if(me(e.value))return{unaryFilter:{field:jn(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jn(e.field),op:Gn(e.op),value:e.value}}})(e));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);s&&(n.structuredQuery.where=s);const i=function(e){if(0!==e.length)return e.map(e=>(function(e){return{field:jn(e.field),direction:zn(e.dir)}})(e))}(t.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(e,t){return e.D||ee(t)?t:{value:t}}(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=Kn(t.startAt)),t.endAt&&(n.structuredQuery.endAt=Kn(t.endAt)),n}function Vn(e){let t=xn(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){y(1===r);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=Bn(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>(function(e){return new Ve(Qn(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))})(e)));let a=null;n.limit&&(a=function(e){let t;return ee(t="object"==typeof e?e.value:e)?null:t}(n.limit));let c=null;n.startAt&&(c=$n(n.startAt));let u=null;return n.endAt&&(u=$n(n.endAt)),ze(t,s,o,i,a,"F",c,u)}function Un(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return g()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}function Bn(e){return e?void 0!==e.unaryFilter?[Wn(e)]:void 0!==e.fieldFilter?[Hn(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(e=>Bn(e)).reduce((e,t)=>e.concat(t)):g():[]}function Kn(e){return{before:e.before,values:e.position}}function $n(e){const t=!!e.before,n=e.values||[];return new Pe(n,t)}function zn(e){return pn[e]}function Gn(e){return gn[e]}function jn(e){return{fieldPath:e.canonicalString()}}function Qn(e){return $.fromServerFormat(e.fieldPath)}function Hn(e){return xe.create(Qn(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return g()}}(e.fieldFilter.op),e.fieldFilter.value)}function Wn(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Qn(e.unaryFilter.field);return xe.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Qn(e.unaryFilter.field);return xe.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Qn(e.unaryFilter.field);return xe.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Qn(e.unaryFilter.field);return xe.create(s,"!=",{nullValue:"NULL_VALUE"});default:return g()}}function Yn(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Jn(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function Xn(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=er(t)),t=Zn(e.get(n),t);return er(t)}function Zn(e,t){let n=t;const r=e.length;for(let s=0;s<r;s++){const t=e.charAt(s);switch(t){case"\0":n+="";break;case"":n+="";break;default:n+=t}}return n}function er(e){return e+""}function tr(e){const t=e.length;if(y(t>=2),2===t)return y(""===e.charAt(0)&&""===e.charAt(1)),B.emptyPath();const n=t-2,r=[];let s="";for(let i=0;i<t;){const t=e.indexOf("",i);switch((t<0||t>n)&&g(),e.charAt(t+1)){case"":const n=e.substring(i,t);let o;0===s.length?o=n:(o=s+=n,s=""),r.push(o);break;case"":s+=e.substring(i,t),s+="\0";break;case"":s+=e.substring(i,t+1);break;default:g()}i=t+2}return new B(r)}class nr{constructor(e,t){this.seconds=e,this.nanoseconds=t}}class rr{constructor(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}}rr.store="owner",rr.key="owner";class sr{constructor(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}}sr.store="mutationQueues",sr.keyPath="userId";class ir{constructor(e,t,n,r,s){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=s}}ir.store="mutations",ir.keyPath="batchId",ir.userMutationsIndex="userMutationsIndex",ir.userMutationsKeyPath=["userId","batchId"];class or{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,Xn(t)]}static key(e,t,n){return[e,Xn(t),n]}}or.store="documentMutations",or.PLACEHOLDER=new or;class ar{constructor(e,t){this.path=e,this.readTime=t}}class cr{constructor(e,t){this.path=e,this.version=t}}class ur{constructor(e,t,n,r,s,i){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=s,this.parentPath=i}}ur.store="remoteDocuments",ur.readTimeIndex="readTimeIndex",ur.readTimeIndexPath="readTime",ur.collectionReadTimeIndex="collectionReadTimeIndex",ur.collectionReadTimeIndexPath=["parentPath","readTime"];class hr{constructor(e){this.byteSize=e}}hr.store="remoteDocumentGlobal",hr.key="remoteDocumentGlobalKey";class lr{constructor(e,t,n,r,s,i,o){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=s,this.lastLimboFreeSnapshotVersion=i,this.query=o}}lr.store="targets",lr.keyPath="targetId",lr.queryTargetsIndexName="queryTargetsIndex",lr.queryTargetsKeyPath=["canonicalId","targetId"];class dr{constructor(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n}}dr.store="targetDocuments",dr.keyPath=["targetId","path"],dr.documentTargetsIndex="documentTargetsIndex",dr.documentTargetsKeyPath=["path","targetId"];class fr{constructor(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}}fr.key="targetGlobalKey",fr.store="targetGlobal";class mr{constructor(e,t){this.collectionId=e,this.parent=t}}mr.store="collectionParents",mr.keyPath=["collectionId","parent"];class pr{constructor(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r}}pr.store="clientMetadata",pr.keyPath="clientId";class gr{constructor(e,t,n){this.bundleId=e,this.createTime=t,this.version=n}}gr.store="bundles",gr.keyPath="bundleId";class yr{constructor(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n}}yr.store="namedQueries",yr.keyPath="name";const wr=[sr.store,ir.store,or.store,ur.store,lr.store,rr.store,fr.store,dr.store,pr.store,hr.store,mr.store,gr.store,yr.store],Ir="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vr{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}class Tr{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&g(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Tr((n,r)=>{this.nextCallback=(t=>{this.wrapSuccess(e,t).next(n,r)}),this.catchCallback=(e=>{this.wrapFailure(t,e).next(n,r)})})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Tr?t:Tr.resolve(t)}catch(e){return Tr.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Tr.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Tr.reject(t)}static resolve(e){return new Tr((t,n)=>{t(e)})}static reject(e){return new Tr((t,n)=>{n(e)})}static waitFor(e){return new Tr((t,n)=>{let r=0,s=0,i=!1;e.forEach(e=>{++r,e.next(()=>{++s,i&&s===r&&t()},e=>n(e))}),i=!0,s===r&&t()})}static or(e){let t=Tr.resolve(!1);for(const n of e)t=t.next(e=>e?Tr.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}}class Er{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.Et=new E,this.transaction.oncomplete=(()=>{this.Et.resolve()}),this.transaction.onabort=(()=>{t.error?this.Et.reject(new Nr(e,t.error)):this.Et.resolve()}),this.transaction.onerror=(t=>{const n=kr(t.target.error);this.Et.reject(new Nr(e,n))})}static open(e,t,n,r){try{return new Er(t,e.transaction(r,n))}catch(e){throw new Nr(t,e)}}get It(){return this.Et.promise}abort(e){e&&this.Et.reject(e),this.aborted||(d("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(e){const t=this.transaction.objectStore(e);return new xr(t)}}class br{constructor(e,t,n){this.name=e,this.version=t,this.At=n,12.2===br.Rt((0,s.getUA)())&&f("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return d("SimpleDb","Removing database:",e),Dr(window.indexedDB.deleteDatabase(e)).toPromise()}static bt(){if(!(0,s.isIndexedDBAvailable)())return!1;if(br.Pt())return!0;const e=(0,s.getUA)(),t=br.Rt(e),n=0<t&&t<10,r=br.vt(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static Pt(){var t;return void 0!==e&&"YES"===(null===(t=e.env)||void 0===t?void 0:t.Vt)}static St(e,t){return e.store(t)}static Rt(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static vt(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async Dt(e){return this.db||(d("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=(e=>{const n=e.target.result;t(n)}),r.onblocked=(()=>{n(new Nr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))}),r.onerror=(t=>{const r=t.target.error;"VersionError"===r.name?n(new T(v.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new T(v.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Nr(e,r))}),r.onupgradeneeded=(e=>{d("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.At.Ct(t,r.transaction,e.oldVersion,this.version).next(()=>{d("SimpleDb","Database upgrade to version "+this.version+" complete")})})})),this.Nt&&(this.db.onversionchange=(e=>this.Nt(e))),this.db}xt(e){this.Nt=e,this.db&&(this.db.onversionchange=(t=>e(t)))}async runTransaction(e,t,n,r){const s="readonly"===t;for(;;){0;try{this.db=await this.Dt(e);const t=Er.open(this.db,e,s?"readonly":"readwrite",n),i=r(t).catch(e=>(t.abort(e),Tr.reject(e))).toPromise();return i.catch(()=>{}),await t.It,i}catch(e){const t="FirebaseError"!==e.name&&i<3;if(d("SimpleDb","Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Sr{constructor(e){this.kt=e,this.$t=!1,this.Ot=null}get isDone(){return this.$t}get Ft(){return this.Ot}set cursor(e){this.kt=e}done(){this.$t=!0}Mt(e){this.Ot=e}delete(){return Dr(this.kt.delete())}}class Nr extends T{constructor(e,t){super(v.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function _r(e){return"IndexedDbTransactionError"===e.name}class xr{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(d("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(d("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Dr(n)}add(e){return d("SimpleDb","ADD",this.store.name,e,e),Dr(this.store.add(e))}get(e){return Dr(this.store.get(e)).next(t=>(void 0===t&&(t=null),d("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return d("SimpleDb","DELETE",this.store.name,e),Dr(this.store.delete(e))}count(){return d("SimpleDb","COUNT",this.store.name),Dr(this.store.count())}Lt(e,t){const n=this.cursor(this.options(e,t)),r=[];return this.Bt(n,(e,t)=>{r.push(t)}).next(()=>r)}Ut(e,t){d("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.qt=!1;const r=this.cursor(n);return this.Bt(r,(e,t,n)=>n.delete())}Kt(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.Bt(r,t)}jt(e){const t=this.cursor({});return new Tr((n,r)=>{t.onerror=(e=>{const t=kr(e.target.error);r(t)}),t.onsuccess=(t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()})})}Bt(e,t){const n=[];return new Tr((r,s)=>{e.onerror=(e=>{s(e.target.error)}),e.onsuccess=(e=>{const s=e.target.result;if(!s)return void r();const i=new Sr(s),o=t(s.primaryKey,s.value,i);if(o instanceof Tr){const e=o.catch(e=>(i.done(),Tr.reject(e)));n.push(e)}i.isDone?r():null===i.Ft?s.continue():s.continue(i.Ft)})}).next(()=>Tr.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.qt?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Dr(e){return new Tr((t,n)=>{e.onsuccess=(e=>{const n=e.target.result;t(n)}),e.onerror=(e=>{const t=kr(e.target.error);n(t)})})}let Ar=!1;function kr(e){const t=br.Rt((0,s.getUA)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new T("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ar||(Ar=!0,setTimeout(()=>{throw e},0)),e}}return e}class Cr extends vr{constructor(e,t){super(),this.Qt=e,this.currentSequenceNumber=t}}function Lr(e,t){const n=I(e);return br.St(n.Qt,t)}class Rr{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&xt(t,e,n[r])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&Dt(t,e,this.localWriteTime);for(const t of this.mutations)t.key.isEqual(e.key)&&Dt(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach(t=>{const n=e.get(t.key),r=n;this.applyToLocalView(r),n.isValidDocument()||r.convertToNoDocument(O.min())})}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),nn())}isEqual(e){return this.batchId===e.batchId&&R(this.mutations,e.mutations,(e,t)=>kt(e,t))&&R(this.baseMutations,e.baseMutations,(e,t)=>kt(e,t))}}class Fr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){y(e.mutations.length===n.length);let r=en();const s=e.mutations;for(let i=0;i<s.length;i++)r=r.insert(s[i].key,n[i].version);return new Fr(e,t,n,r)}}class Mr{constructor(e,t,n,r,s=O.min(),i=O.min(),o=j.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o}withSequenceNumber(e){return new Mr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Mr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Or{constructor(e){this.Wt=e}}function Pr(e,t){if(t.document)return Cn(e.Wt,t.document,!!t.hasCommittedMutations);if(t.noDocument){const e=re.fromSegments(t.noDocument.path),n=Kr(t.noDocument.readTime),r=ve.newNoDocument(e,n);return t.hasCommittedMutations?r.setHasCommittedMutations():r}if(t.unknownDocument){const e=re.fromSegments(t.unknownDocument.path),n=Kr(t.unknownDocument.version);return ve.newUnknownDocument(e,n)}return g()}function qr(e,t,n){const r=Vr(n),s=t.key.path.popLast().toArray();if(t.isFoundDocument()){const n=function(e,t){return{name:Sn(e,t.key),fields:t.data.value.mapValue.fields,updateTime:wn(e,t.version.toTimestamp())}}(e.Wt,t),i=t.hasCommittedMutations;return new ur(null,null,n,i,r,s)}if(t.isNoDocument()){const e=t.key.path.toArray(),n=Br(t.version),i=t.hasCommittedMutations;return new ur(null,new ar(e,n),null,i,r,s)}if(t.isUnknownDocument()){const e=t.key.path.toArray(),n=Br(t.version);return new ur(new cr(e,n),null,null,!0,r,s)}return g()}function Vr(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Ur(e){const t=new M(e[0],e[1]);return O.fromTimestamp(t)}function Br(e){const t=e.toTimestamp();return new nr(t.seconds,t.nanoseconds)}function Kr(e){const t=new M(e.seconds,e.nanoseconds);return O.fromTimestamp(t)}function $r(e,t){const n=(t.baseMutations||[]).map(t=>Mn(e.Wt,t));for(let i=0;i<t.mutations.length-1;++i){const e=t.mutations[i];if(i+1<t.mutations.length&&void 0!==t.mutations[i+1].transform){const n=t.mutations[i+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(i+1,1),++i}}const r=t.mutations.map(t=>Mn(e.Wt,t)),s=M.fromMillis(t.localWriteTimeMs);return new Rr(t.batchId,s,n,r)}function zr(e){const t=Kr(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Kr(e.lastLimboFreeSnapshotVersion):O.min();let r;var s;return void 0!==e.query.documents?(y(1===(s=e.query).documents.length),r=Xe(Ge(xn(s.documents[0])))):r=function(e){return Xe(Vn(e))}(e.query),new Mr(r,e.targetId,0,e.lastListenSequenceNumber,t,n,j.fromBase64String(e.resumeToken))}function Gr(e,t){const n=Br(t.snapshotVersion),r=Br(t.lastLimboFreeSnapshotVersion);let s;s=_e(t.target)?Pn(e.Wt,t.target):qn(e.Wt,t.target);const i=t.resumeToken.toBase64();return new lr(t.targetId,be(t.target),n,i,t.sequenceNumber,r,s)}function jr(e){const t=Vn({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Ze(t,t.limit,"L"):t}class Qr{getBundleMetadata(e,t){return Hr(e).get(t).next(e=>{if(e)return{id:(t=e).bundleId,createTime:Kr(t.createTime),version:t.version};var t})}saveBundleMetadata(e,t){return Hr(e).put({bundleId:(n=t).id,createTime:Br(Tn(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return Wr(e).get(t).next(e=>{if(e)return{name:(t=e).name,query:jr(t.bundledQuery),readTime:Kr(t.readTime)};var t})}saveNamedQuery(e,t){return Wr(e).put(function(e){return{name:e.name,readTime:Br(Tn(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function Hr(e){return Lr(e,gr.store)}function Wr(e){return Lr(e,yr.store)}class Yr{constructor(){this.Gt=new Jr}addToCollectionParentIndex(e,t){return this.Gt.add(t),Tr.resolve()}getCollectionParents(e,t){return Tr.resolve(this.Gt.getEntries(t))}}class Jr{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Qt(B.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Qt(B.comparator)).toArray()}}class Xr{constructor(){this.zt=new Jr}addToCollectionParentIndex(e,t){if(!this.zt.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.zt.add(t)});const s={collectionId:n,parent:Xn(r)};return Zr(e).put(s)}return Tr.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[F(t),""],!1,!0);return Zr(e).Lt(r).next(e=>{for(const r of e){if(r.collectionId!==t)break;n.push(tr(r.parent))}return n})}}function Zr(e){return Lr(e,mr.store)}const es={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ts{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new ts(e,ts.DEFAULT_COLLECTION_PERCENTILE,ts.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function ns(e,t,n){const r=e.store(ir.store),s=e.store(or.store),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Kt({range:o},(e,t,n)=>(a++,n.delete()));i.push(c.next(()=>{y(1===a)}));const u=[];for(const h of n.mutations){const e=or.key(t,h.key.path,n.batchId);i.push(s.delete(e)),u.push(h.key)}return Tr.waitFor(i).next(()=>u)}function rs(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw g();t=e.noDocument}return JSON.stringify(t).length}ts.DEFAULT_COLLECTION_PERCENTILE=10,ts.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ts.DEFAULT=new ts(41943040,ts.DEFAULT_COLLECTION_PERCENTILE,ts.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ts.DISABLED=new ts(-1,0,0);class ss{constructor(e,t,n,r){this.userId=e,this.N=t,this.Ht=n,this.referenceDelegate=r,this.Jt={}}static Yt(e,t,n,r){y(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new ss(s,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return os(e).Kt({index:ir.userMutationsIndex,range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const s=as(e),i=os(e);return i.add({}).next(o=>{y("number"==typeof o);const a=new Rr(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map(t=>Fn(e.Wt,t)),s=n.mutations.map(t=>Fn(e.Wt,t));return new ir(t,n.batchId,n.localWriteTime.toMillis(),r,s)}(this.N,this.userId,a),u=[];let h=new Qt((e,t)=>L(e.canonicalString(),t.canonicalString()));for(const e of r){const t=or.key(this.userId,e.key.path,o);h=h.add(e.key.path.popLast()),u.push(i.put(c)),u.push(s.put(t,or.PLACEHOLDER))}return h.forEach(t=>{u.push(this.Ht.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Jt[o]=a.keys()}),Tr.waitFor(u).next(()=>a)})}lookupMutationBatch(e,t){return os(e).get(t).next(e=>e?(y(e.userId===this.userId),$r(this.N,e)):null)}Xt(e,t){return this.Jt[t]?Tr.resolve(this.Jt[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const n=e.keys();return this.Jt[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return os(e).Kt({index:ir.userMutationsIndex,range:r},(e,t,r)=>{t.userId===this.userId&&(y(t.batchId>=n),s=$r(this.N,t)),r.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return os(e).Kt({index:ir.userMutationsIndex,range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return os(e).Lt(ir.userMutationsIndex,t).next(e=>e.map(e=>$r(this.N,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=or.prefixForPath(this.userId,t.path),r=IDBKeyRange.lowerBound(n),s=[];return as(e).Kt({range:r},(n,r,i)=>{const[o,a,c]=n,u=tr(a);if(o===this.userId&&t.path.isEqual(u))return os(e).get(c).next(e=>{if(!e)throw g();y(e.userId===this.userId),s.push($r(this.N,e))});i.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Qt(L);const r=[];return t.forEach(t=>{const s=or.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(s),o=as(e).Kt({range:i},(e,r,s)=>{const[i,o,a]=e,c=tr(o);i===this.userId&&t.path.isEqual(c)?n=n.add(a):s.done()});r.push(o)}),Tr.waitFor(r).next(()=>this.Zt(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,s=or.prefixForPath(this.userId,n),i=IDBKeyRange.lowerBound(s);let o=new Qt(L);return as(e).Kt({range:i},(e,t,s)=>{const[i,a,c]=e,u=tr(a);i===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):s.done()}).next(()=>this.Zt(e,o))}Zt(e,t){const n=[],r=[];return t.forEach(t=>{r.push(os(e).get(t).next(e=>{if(null===e)throw g();y(e.userId===this.userId),n.push($r(this.N,e))}))}),Tr.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return ns(e.Qt,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.te(t.batchId)}),Tr.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}te(e){delete this.Jt[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return Tr.resolve();const n=IDBKeyRange.lowerBound(or.prefixForUser(this.userId)),r=[];return as(e).Kt({range:n},(e,t,n)=>{if(e[0]===this.userId){const t=tr(e[1]);r.push(t)}else n.done()}).next(()=>{y(0===r.length)})})}containsKey(e,t){return is(e,this.userId,t)}ee(e){return cs(e).get(this.userId).next(e=>e||new sr(this.userId,-1,""))}}function is(e,t,n){const r=or.prefixForPath(t,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return as(e).Kt({range:i,qt:!0},(e,n,r)=>{const[i,a,c]=e;i===t&&a===s&&(o=!0),r.done()}).next(()=>o)}function os(e){return Lr(e,ir.store)}function as(e){return Lr(e,or.store)}function cs(e){return Lr(e,sr.store)}class us{constructor(e){this.ne=e}next(){return this.ne+=2,this.ne}static se(){return new us(0)}static ie(){return new us(-1)}}class hs{constructor(e,t){this.referenceDelegate=e,this.N=t}allocateTargetId(e){return this.re(e).next(t=>{const n=new us(t.highestTargetId);return t.highestTargetId=n.next(),this.oe(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.re(e).next(e=>O.fromTimestamp(new M(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.re(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.re(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.oe(e,r)))}addTargetData(e,t){return this.ae(e,t).next(()=>this.re(e).next(n=>(n.targetCount+=1,this.ce(t,n),this.oe(e,n))))}updateTargetData(e,t){return this.ae(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ls(e).delete(t.targetId)).next(()=>this.re(e)).next(t=>(y(t.targetCount>0),t.targetCount-=1,this.oe(e,t)))}removeTargets(e,t,n){let r=0;const s=[];return ls(e).Kt((i,o)=>{const a=zr(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,s.push(this.removeTargetData(e,a)))}).next(()=>Tr.waitFor(s)).next(()=>r)}forEachTarget(e,t){return ls(e).Kt((e,n)=>{const r=zr(n);t(r)})}re(e){return ds(e).get(fr.key).next(e=>(y(null!==e),e))}oe(e,t){return ds(e).put(fr.key,t)}ae(e,t){return ls(e).put(Gr(this.N,t))}ce(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.re(e).next(e=>e.targetCount)}getTargetData(e,t){const n=be(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return ls(e).Kt({range:r,index:lr.queryTargetsIndexName},(e,n,r)=>{const i=zr(n);Ne(t,i.target)&&(s=i,r.done())}).next(()=>s)}addMatchingKeys(e,t,n){const r=[],s=fs(e);return t.forEach(t=>{const i=Xn(t.path);r.push(s.put(new dr(n,i))),r.push(this.referenceDelegate.addReference(e,n,t))}),Tr.waitFor(r)}removeMatchingKeys(e,t,n){const r=fs(e);return Tr.forEach(t,t=>{const s=Xn(t.path);return Tr.waitFor([r.delete([n,s]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){const n=fs(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=fs(e);let s=nn();return r.Kt({range:n,qt:!0},(e,t,n)=>{const r=tr(e[1]),i=new re(r);s=s.add(i)}).next(()=>s)}containsKey(e,t){const n=Xn(t.path),r=IDBKeyRange.bound([n],[F(n)],!1,!0);let s=0;return fs(e).Kt({index:dr.documentTargetsIndex,qt:!0,range:r},([e,t],n,r)=>{0!==e&&(s++,r.done())}).next(()=>s>0)}Tt(e,t){return ls(e).get(t).next(e=>e?zr(e):null)}}function ls(e){return Lr(e,lr.store)}function ds(e){return Lr(e,fr.store)}function fs(e){return Lr(e,dr.store)}async function ms(e){if(e.code!==v.FAILED_PRECONDITION||e.message!==Ir)throw e;d("LocalStore","Unexpectedly lost primary lease")}function ps([e,t],[n,r]){const s=L(e,n);return 0===s?L(t,r):s}class gs{constructor(e){this.ue=e,this.buffer=new Qt(ps),this.he=0}le(){return++this.he}fe(e){const t=[e,this.le()];if(this.buffer.size<this.ue)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();ps(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ys{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.de=!1,this.we=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this._e(e)}stop(){this.we&&(this.we.cancel(),this.we=null)}get started(){return null!==this.we}_e(e){const t=this.de?3e5:6e4;d("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.we=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.we=null,this.de=!0;try{await e.collectGarbage(this.garbageCollector)}catch(e){_r(e)?d("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await ms(e)}await this._e(e)})}}class ws{constructor(e,t){this.me=e,this.params=t}calculateTargetCount(e,t){return this.me.ge(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Tr.resolve(A.T);const n=new gs(t);return this.me.forEachTarget(e,e=>n.fe(e.sequenceNumber)).next(()=>this.me.ye(e,e=>n.fe(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.me.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.me.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(d("LruGarbageCollector","Garbage collection skipped; disabled"),Tr.resolve(es)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(d("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),es):this.pe(e,t))}getCacheSize(e){return this.me.getCacheSize(e)}pe(e,t){let n,s,i,o,a,c,u;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(d("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),s=this.params.maximumSequenceNumbersToCollect):s=t,o=Date.now(),this.nthSequenceNumber(e,s))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(u=Date.now(),h()<=r.LogLevel.DEBUG&&d("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-l}ms\n\tDetermined least recently used ${s} in `+(a-o)+"ms\n"+`\tRemoved ${i} targets in `+(c-a)+"ms\n"+`\tRemoved ${e} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-l}ms`),Tr.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:e})))}}class Is{constructor(e,t){this.db=e,this.garbageCollector=function(e,t){return new ws(e,t)}(this,t)}ge(e){const t=this.Te(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}Te(e){let t=0;return this.ye(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}ye(e,t){return this.Ee(e,(e,n)=>t(n))}addReference(e,t,n){return vs(e,n)}removeReference(e,t,n){return vs(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return vs(e,t)}Ie(e,t){return function(e,t){let n=!1;return cs(e).jt(r=>is(e,r,t).next(e=>(e&&(n=!0),Tr.resolve(!e)))).next(()=>n)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Ee(e,(i,o)=>{if(o<=t){const t=this.Ie(e,i).next(t=>{if(!t)return s++,n.getEntry(e,i).next(()=>(n.removeEntry(i),fs(e).delete([0,Xn(i.path)])))});r.push(t)}}).next(()=>Tr.waitFor(r)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return vs(e,t)}Ee(e,t){const n=fs(e);let r,s=A.T;return n.Kt({index:dr.documentTargetsIndex},([e,n],{path:i,sequenceNumber:o})=>{0===e?(s!==A.T&&t(new re(tr(r)),s),s=o,r=i):s=A.T}).next(()=>{s!==A.T&&t(new re(tr(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function vs(e,t){return fs(e).put(function(e,t){return new dr(0,Xn(e.path),t)}(t,e.currentSequenceNumber))}class Ts{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}forEach(e){q(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return V(this.inner)}}class Es{constructor(){this.changes=new Ts(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}getReadTime(e){const t=this.changes.get(e);return t?t.readTime:O.min()}addEntry(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}removeEntry(e,t=null){this.assertNotApplied(),this.changes.set(e,{document:ve.newInvalidDocument(e),readTime:t})}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Tr.resolve(n.document):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class bs{constructor(e,t){this.N=e,this.Ht=t}addEntry(e,t,n){return _s(e).put(xs(t),n)}removeEntry(e,t){const n=_s(e),r=xs(t);return n.delete(r)}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.Ae(e,n)))}getEntry(e,t){return _s(e).get(xs(t)).next(e=>this.Re(t,e))}be(e,t){return _s(e).get(xs(t)).next(e=>({document:this.Re(t,e),size:rs(e)}))}getEntries(e,t){let n=Yt();return this.Pe(e,t,(e,t)=>{const r=this.Re(e,t);n=n.insert(e,r)}).next(()=>n)}ve(e,t){let n=Yt(),r=new zt(re.comparator);return this.Pe(e,t,(e,t)=>{const s=this.Re(e,t);n=n.insert(e,s),r=r.insert(e,rs(t))}).next(()=>({documents:n,Ve:r}))}Pe(e,t,n){if(t.isEmpty())return Tr.resolve();const r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),s=t.getIterator();let i=s.getNext();return _s(e).Kt({range:r},(e,t,r)=>{const o=re.fromSegments(e);for(;i&&re.comparator(i,o)<0;)n(i,null),i=s.getNext();i&&i.isEqual(o)&&(n(i,t),i=s.hasNext()?s.getNext():null),i?r.Mt(i.path.toArray()):r.done()}).next(()=>{for(;i;)n(i,null),i=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n){let r=Yt();const s=t.path.length+1,i={};if(n.isEqual(O.min())){const e=t.path.toArray();i.range=IDBKeyRange.lowerBound(e)}else{const e=t.path.toArray(),r=Vr(n);i.range=IDBKeyRange.lowerBound([e,r],!0),i.index=ur.collectionReadTimeIndex}return _s(e).Kt(i,(e,n,i)=>{if(e.length!==s)return;const o=Pr(this.N,n);t.path.isPrefixOf(o.key.path)?rt(t,o)&&(r=r.insert(o.key,o)):i.done()}).next(()=>r)}newChangeBuffer(e){return new Ss(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return Ns(e).get(hr.key).next(e=>(y(!!e),e))}Ae(e,t){return Ns(e).put(hr.key,t)}Re(e,t){if(t){const e=Pr(this.N,t);if(!e.isNoDocument()||!e.version.isEqual(O.min()))return e}return ve.newInvalidDocument(e)}}class Ss extends Es{constructor(e,t){super(),this.Se=e,this.trackRemovals=t,this.De=new Ts(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let n=0,r=new Qt((e,t)=>L(e.canonicalString(),t.canonicalString()));return this.changes.forEach((s,i)=>{const o=this.De.get(s);if(i.document.isValidDocument()){const a=qr(this.Se.N,i.document,this.getReadTime(s));r=r.add(s.path.popLast());const c=rs(a);n+=c-o,t.push(this.Se.addEntry(e,s,a))}else if(n-=o,this.trackRemovals){const n=qr(this.Se.N,ve.newNoDocument(s,O.min()),this.getReadTime(s));t.push(this.Se.addEntry(e,s,n))}else t.push(this.Se.removeEntry(e,s))}),r.forEach(n=>{t.push(this.Se.Ht.addToCollectionParentIndex(e,n))}),t.push(this.Se.updateMetadata(e,n)),Tr.waitFor(t)}getFromCache(e,t){return this.Se.be(e,t).next(e=>(this.De.set(t,e.size),e.document))}getAllFromCache(e,t){return this.Se.ve(e,t).next(({documents:e,Ve:t})=>(t.forEach((e,t)=>{this.De.set(e,t)}),e))}}function Ns(e){return Lr(e,hr.store)}function _s(e){return Lr(e,ur.store)}function xs(e){return e.path.toArray()}class Ds{constructor(e){this.N=e}Ct(e,t,n,r){y(n<r&&n>=0&&r<=11);const s=new Er("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(rr.store)}(e),function(e){e.createObjectStore(sr.store,{keyPath:sr.keyPath}),e.createObjectStore(ir.store,{keyPath:ir.keyPath,autoIncrement:!0}).createIndex(ir.userMutationsIndex,ir.userMutationsKeyPath,{unique:!0}),e.createObjectStore(or.store)}(e),As(e),function(e){e.createObjectStore(ur.store)}(e));let i=Tr.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(dr.store),e.deleteObjectStore(lr.store),e.deleteObjectStore(fr.store)}(e),As(e)),i=i.next(()=>(function(e){const t=s.store(fr.store),n=new fr(0,0,O.min().toTimestamp(),0);return t.put(fr.key,n)})())),n<4&&r>=4&&(0!==n&&(i=i.next(()=>(function(e,t){return t.store(ir.store).Lt().next(n=>{e.deleteObjectStore(ir.store),e.createObjectStore(ir.store,{keyPath:ir.keyPath,autoIncrement:!0}).createIndex(ir.userMutationsIndex,ir.userMutationsKeyPath,{unique:!0});const r=t.store(ir.store),s=n.map(e=>r.put(e));return Tr.waitFor(s)})})(e,s))),i=i.next(()=>{!function(e){e.createObjectStore(pr.store,{keyPath:pr.keyPath})}(e)})),n<5&&r>=5&&(i=i.next(()=>this.Ce(s))),n<6&&r>=6&&(i=i.next(()=>(function(e){e.createObjectStore(hr.store)}(e),this.Ne(s)))),n<7&&r>=7&&(i=i.next(()=>this.xe(s))),n<8&&r>=8&&(i=i.next(()=>this.ke(e,s))),n<9&&r>=9&&(i=i.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){const t=e.objectStore(ur.store);t.createIndex(ur.readTimeIndex,ur.readTimeIndexPath,{unique:!1}),t.createIndex(ur.collectionReadTimeIndex,ur.collectionReadTimeIndexPath,{unique:!1})}(t)})),n<10&&r>=10&&(i=i.next(()=>this.$e(s))),n<11&&r>=11&&(i=i.next(()=>{!function(e){e.createObjectStore(gr.store,{keyPath:gr.keyPath})}(e),function(e){e.createObjectStore(yr.store,{keyPath:yr.keyPath})}(e)})),i}Ne(e){let t=0;return e.store(ur.store).Kt((e,n)=>{t+=rs(n)}).next(()=>{const n=new hr(t);return e.store(hr.store).put(hr.key,n)})}Ce(e){const t=e.store(sr.store),n=e.store(ir.store);return t.Lt().next(t=>Tr.forEach(t,t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.Lt(ir.userMutationsIndex,r).next(n=>Tr.forEach(n,n=>{y(n.userId===t.userId);const r=$r(this.N,n);return ns(e,t.userId,r).next(()=>{})}))}))}xe(e){const t=e.store(dr.store),n=e.store(ur.store);return e.store(fr.store).get(fr.key).next(e=>{const r=[];return n.Kt((n,s)=>{const i=new B(n),o=function(e){return[0,Xn(i)]}();r.push(t.get(o).next(n=>n?Tr.resolve():(n=>t.put(new dr(0,Xn(n),e.highestListenSequenceNumber)))(i)))}).next(()=>Tr.waitFor(r))})}ke(e,t){e.createObjectStore(mr.store,{keyPath:mr.keyPath});const n=t.store(mr.store),r=new Jr,s=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Xn(r)})}};return t.store(ur.store).Kt({qt:!0},(e,t)=>{const n=new B(e);return s(n.popLast())}).next(()=>t.store(or.store).Kt({qt:!0},([e,t,n],r)=>{const i=tr(t);return s(i.popLast())}))}$e(e){const t=e.store(lr.store);return t.Kt((e,n)=>{const r=zr(n),s=Gr(this.N,r);return t.put(s)})}}function As(e){e.createObjectStore(dr.store,{keyPath:dr.keyPath}).createIndex(dr.documentTargetsIndex,dr.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(lr.store,{keyPath:lr.keyPath}).createIndex(lr.queryTargetsIndexName,lr.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(fr.store)}const ks="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Cs{constructor(e,t,n,r,s,i,o,a,c,u){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Oe=s,this.window=i,this.document=o,this.Fe=c,this.Me=u,this.Le=null,this.Be=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ue=null,this.inForeground=!1,this.qe=null,this.Ke=null,this.je=Number.NEGATIVE_INFINITY,this.Qe=(e=>Promise.resolve()),!Cs.bt())throw new T(v.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Is(this,r),this.We=t+"main",this.N=new Or(a),this.Ge=new br(this.We,11,new Ds(this.N)),this.ze=new hs(this.referenceDelegate,this.N),this.Ht=new Xr,this.He=function(e,t){return new bs(e,t)}(this.N,this.Ht),this.Je=new Qr,this.window&&this.window.localStorage?this.Ye=this.window.localStorage:(this.Ye=null,!1===u&&f("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Xe().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new T(v.FAILED_PRECONDITION,ks);return this.Ze(),this.tn(),this.en(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.ze.getHighestSequenceNumber(e))}).then(e=>{this.Le=new A(e,this.Fe)}).then(()=>{this.Be=!0}).catch(e=>(this.Ge&&this.Ge.close(),Promise.reject(e)))}nn(e){return this.Qe=(async t=>{if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ge.xt(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Oe.enqueueAndForget(async()=>{this.started&&await this.Xe()}))}Xe(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Rs(e).put(new pr(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.sn(e).next(e=>{e||(this.isPrimary=!1,this.Oe.enqueueRetryable(()=>this.Qe(!1)))})}).next(()=>this.rn(e)).next(t=>this.isPrimary&&!t?this.on(e).next(()=>!1):!!t&&this.an(e).next(()=>!0))).catch(e=>{if(_r(e))return d("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return d("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Oe.enqueueRetryable(()=>this.Qe(e)),this.isPrimary=e})}sn(e){return Ls(e).get(rr.key).next(e=>Tr.resolve(this.cn(e)))}un(e){return Rs(e).delete(this.clientId)}async hn(){if(this.isPrimary&&!this.ln(this.je,18e5)){this.je=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=Lr(e,pr.store);return t.Lt().next(e=>{const n=this.fn(e,18e5),r=e.filter(e=>-1===n.indexOf(e));return Tr.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this.Ye)for(const t of e)this.Ye.removeItem(this.dn(t.clientId))}}en(){this.Ke=this.Oe.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Xe().then(()=>this.hn()).then(()=>this.en()))}cn(e){return!!e&&e.ownerId===this.clientId}rn(e){return this.Me?Tr.resolve(!0):Ls(e).get(rr.key).next(t=>{if(null!==t&&this.ln(t.leaseTimestampMs,5e3)&&!this.wn(t.ownerId)){if(this.cn(t)&&this.networkEnabled)return!0;if(!this.cn(t)){if(!t.allowTabSynchronization)throw new T(v.FAILED_PRECONDITION,ks);return!1}}return!(!this.networkEnabled||!this.inForeground)||Rs(e).Lt().next(e=>void 0===this.fn(e,5e3).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&d("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.Be=!1,this._n(),this.Ke&&(this.Ke.cancel(),this.Ke=null),this.mn(),this.gn(),await this.Ge.runTransaction("shutdown","readwrite",[rr.store,pr.store],e=>{const t=new Cr(e,A.T);return this.on(t).next(()=>this.un(t))}),this.Ge.close(),this.yn()}fn(e,t){return e.filter(e=>this.ln(e.updateTimeMs,t)&&!this.wn(e.clientId))}pn(){return this.runTransaction("getActiveClients","readonly",e=>Rs(e).Lt().next(e=>this.fn(e,18e5).map(e=>e.clientId)))}get started(){return this.Be}getMutationQueue(e){return ss.Yt(e,this.N,this.Ht,this.referenceDelegate)}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getIndexManager(){return this.Ht}getBundleCache(){return this.Je}runTransaction(e,t,n){d("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite";let s;return this.Ge.runTransaction(e,r,wr,r=>(s=new Cr(r,this.Le?this.Le.next():A.T),"readwrite-primary"===t?this.sn(s).next(e=>!!e||this.rn(s)).next(t=>{if(!t)throw f(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Oe.enqueueRetryable(()=>this.Qe(!1)),new T(v.FAILED_PRECONDITION,Ir);return n(s)}).next(e=>this.an(s).next(()=>e)):this.Tn(s).next(()=>n(s)))).then(e=>(s.raiseOnCommittedEvent(),e))}Tn(e){return Ls(e).get(rr.key).next(e=>{if(null!==e&&this.ln(e.leaseTimestampMs,5e3)&&!this.wn(e.ownerId)&&!this.cn(e)&&!(this.Me||this.allowTabSynchronization&&e.allowTabSynchronization))throw new T(v.FAILED_PRECONDITION,ks)})}an(e){const t=new rr(this.clientId,this.allowTabSynchronization,Date.now());return Ls(e).put(rr.key,t)}static bt(){return br.bt()}on(e){const t=Ls(e);return t.get(rr.key).next(e=>this.cn(e)?(d("IndexedDbPersistence","Releasing primary lease."),t.delete(rr.key)):Tr.resolve())}ln(e,t){const n=Date.now();return!(e<n-t||e>n&&(f(`Detected an update time that is in the future: ${e} > ${n}`),1))}Ze(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.qe=(()=>{this.Oe.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Xe()))}),this.document.addEventListener("visibilitychange",this.qe),this.inForeground="visible"===this.document.visibilityState)}mn(){this.qe&&(this.document.removeEventListener("visibilitychange",this.qe),this.qe=null)}tn(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ue=(()=>{this._n(),(0,s.isSafari)()&&navigator.appVersion.match("Version/14")&&this.Oe.enterRestrictedMode(!0),this.Oe.enqueueAndForget(()=>this.shutdown())}),this.window.addEventListener("pagehide",this.Ue))}gn(){this.Ue&&(this.window.removeEventListener("pagehide",this.Ue),this.Ue=null)}wn(e){var t;try{const n=null!==(null===(t=this.Ye)||void 0===t?void 0:t.getItem(this.dn(e)));return d("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return f("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}_n(){if(this.Ye)try{this.Ye.setItem(this.dn(this.clientId),String(Date.now()))}catch(e){f("Failed to set zombie client id.",e)}}yn(){if(this.Ye)try{this.Ye.removeItem(this.dn(this.clientId))}catch(e){}}dn(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ls(e){return Lr(e,rr.store)}function Rs(e){return Lr(e,pr.store)}function Fs(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Ms{constructor(e,t){this.progress=e,this.En=t}}class Os{constructor(e,t,n){this.He=e,this.In=t,this.Ht=n}An(e,t){return this.In.getAllMutationBatchesAffectingDocumentKey(e,t).next(n=>this.Rn(e,t,n))}Rn(e,t,n){return this.He.getEntry(e,t).next(e=>{for(const t of n)t.applyToLocalView(e);return e})}bn(e,t){e.forEach((e,n)=>{for(const r of t)r.applyToLocalView(n)})}Pn(e,t){return this.He.getEntries(e,t).next(t=>this.vn(e,t).next(()=>t))}vn(e,t){return this.In.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>this.bn(t,e))}getDocumentsMatchingQuery(e,t,n){return function(e){return re.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Vn(e,t.path):Ye(t)?this.Sn(e,t,n):this.Dn(e,t,n)}Vn(e,t){return this.An(e,new re(t)).next(e=>{let t=Xt();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}Sn(e,t,n){const r=t.collectionGroup;let s=Xt();return this.Ht.getCollectionParents(e,r).next(i=>Tr.forEach(i,i=>{const o=function(e,t){return new $e(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,i.child(r));return this.Dn(e,o,n).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}Dn(e,t,n){let r,s;return this.He.getDocumentsMatchingQuery(e,t,n).next(n=>(r=n,this.In.getAllMutationBatchesAffectingQuery(e,t))).next(t=>(s=t,this.Cn(e,s,r).next(e=>{r=e;for(const t of s)for(const e of t.mutations){const n=e.key;let s=r.get(n);null==s&&(s=ve.newInvalidDocument(n),r=r.insert(n,s)),Dt(e,s,t.localWriteTime),s.isFoundDocument()||(r=r.remove(n))}}))).next(()=>(r.forEach((e,n)=>{rt(t,n)||(r=r.remove(e))}),r))}Cn(e,t,n){let r=nn();for(const i of t)for(const e of i.mutations)e instanceof Rt&&null===n.get(e.key)&&(r=r.add(e.key));let s=n;return this.He.getEntries(e,r).next(e=>(e.forEach((e,t)=>{t.isFoundDocument()&&(s=s.insert(e,t))}),s))}}class Ps{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Nn=n,this.xn=r}static kn(e,t){let n=nn(),r=nn();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Ps(e,t.fromCache,n,r)}}class qs{$n(e){this.On=e}getDocumentsMatchingQuery(e,t,n,s){return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(O.min())?this.Fn(e,t):this.On.Pn(e,s).next(i=>{const o=this.Mn(t,i);return(je(t)||Qe(t))&&this.Ln(t.limitType,o,s,n)?this.Fn(e,t):(h()<=r.LogLevel.DEBUG&&d("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),nt(t)),this.On.getDocumentsMatchingQuery(e,t,n).next(e=>(o.forEach(t=>{e=e.insert(t.key,t)}),e)))})}Mn(e,t){let n=new Qt(st(e));return t.forEach((t,r)=>{rt(e,r)&&(n=n.add(r))}),n}Ln(e,t,n,r){if(n.size!==t.size)return!0;const s="F"===e?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Fn(e,t){return h()<=r.LogLevel.DEBUG&&d("QueryEngine","Using full collection scan to execute query:",nt(t)),this.On.getDocumentsMatchingQuery(e,t,O.min())}}class Vs{constructor(e,t,n,r){this.persistence=e,this.Bn=t,this.N=r,this.Un=new zt(L),this.qn=new Ts(e=>be(e),Ne),this.Kn=O.min(),this.In=e.getMutationQueue(n),this.jn=e.getRemoteDocumentCache(),this.ze=e.getTargetCache(),this.Qn=new Os(this.jn,this.In,this.persistence.getIndexManager()),this.Je=e.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Un))}}function Us(e,t,n,r){return new Vs(e,t,n,r)}async function Bs(e,t){const n=I(e);let r=n.In,s=n.Qn;const i=await n.persistence.runTransaction("Handle user change","readonly",e=>{let i;return n.In.getAllMutationBatches(e).next(o=>(i=o,r=n.persistence.getMutationQueue(t),s=new Os(n.jn,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e))).next(t=>{const n=[],r=[];let o=nn();for(const e of i){n.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return s.Pn(e,o).next(e=>({Wn:e,removedBatchIds:n,addedBatchIds:r}))})});return n.In=r,n.Qn=s,n.Bn.$n(n.Qn),i}function Ks(e,t){const n=I(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),s=n.jn.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const s=n.batch,i=s.keys();let o=Tr.resolve();return i.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const i=n.docVersions.get(e);y(null!==i),t.version.compareTo(i)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))})}),o.next(()=>e.In.removeMutationBatch(t,s))}(n,e,t,s).next(()=>s.apply(e)).next(()=>n.In.performConsistencyCheck(e)).next(()=>n.Qn.Pn(e,r))})}function $s(e){const t=I(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.ze.getLastRemoteSnapshotVersion(e))}function zs(e,t){const n=I(e),r=t.snapshotVersion;let s=n.Un;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const i=n.jn.newChangeBuffer({trackRemovals:!0});s=n.Un;const o=[];t.targetChanges.forEach((t,i)=>{const a=s.get(i);if(!a)return;o.push(n.ze.removeMatchingKeys(e,t.removedDocuments,i).next(()=>n.ze.addMatchingKeys(e,t.addedDocuments,i)));const c=t.resumeToken;if(c.approximateByteSize()>0){const u=a.withResumeToken(c,r).withSequenceNumber(e.currentSequenceNumber);s=s.insert(i,u),function(e,t,n){return y(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(a,u,t)&&o.push(n.ze.updateTargetData(e,u))}});let a=Yt();if(t.documentUpdates.forEach((r,s)=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(Gs(e,i,t.documentUpdates,r,void 0).next(e=>{a=e})),!r.isEqual(O.min())){const t=n.ze.getLastRemoteSnapshotVersion(e).next(t=>n.ze.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return Tr.waitFor(o).next(()=>i.apply(e)).next(()=>n.Qn.vn(e,a)).next(()=>a)}).then(e=>(n.Un=s,e))}function Gs(e,t,n,r,s){let i=nn();return n.forEach(e=>i=i.add(e)),t.getEntries(e,i).next(e=>{let i=Yt();return n.forEach((n,o)=>{const a=e.get(n),c=(null==s?void 0:s.get(n))||r;o.isNoDocument()&&o.version.isEqual(O.min())?(t.removeEntry(n,c),i=i.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(o,c),i=i.insert(n,o)):d("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)}),i})}function js(e,t){const n=I(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.In.getNextMutationBatchAfterBatchId(e,t)))}function Qs(e,t){const n=I(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.ze.getTargetData(e,t).next(s=>s?(r=s,Tr.resolve(r)):n.ze.allocateTargetId(e).next(s=>(r=new Mr(t,s,0,e.currentSequenceNumber),n.ze.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Un.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Un=n.Un.insert(e.targetId,e),n.qn.set(t,e.targetId)),e})}async function Hs(e,t,n){const r=I(e),s=r.Un.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,e=>r.persistence.referenceDelegate.removeTarget(e,s))}catch(e){if(!_r(e))throw e;d("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.Un=r.Un.remove(t),r.qn.delete(s.target)}function Ws(e,t,n){const r=I(e);let s=O.min(),i=nn();return r.persistence.runTransaction("Execute query","readonly",e=>(function(e,t,n){const r=I(e),s=r.qn.get(n);return void 0!==s?Tr.resolve(r.Un.get(s)):r.ze.getTargetData(t,n)})(r,e,Xe(t)).next(t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,r.ze.getMatchingKeysForTargetId(e,t.targetId).next(e=>{i=e})}).next(()=>r.Bn.getDocumentsMatchingQuery(e,t,n?s:O.min(),n?i:nn())).next(e=>({documents:e,Gn:i})))}function Ys(e,t){const n=I(e),r=I(n.ze),s=n.Un.get(t);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",e=>r.Tt(e,t).next(e=>e?e.target:null))}function Js(e){const t=I(e);return t.persistence.runTransaction("Get new document changes","readonly",e=>(function(e,t,n){const r=I(e);let s=Yt(),i=Vr(n);const o=_s(t),a=IDBKeyRange.lowerBound(i,!0);return o.Kt({index:ur.readTimeIndex,range:a},(e,t)=>{const n=Pr(r.N,t);s=s.insert(n.key,n),i=t.readTime}).next(()=>({En:s,readTime:Ur(i)}))})(t.jn,e,t.Kn)).then(({En:e,readTime:n})=>(t.Kn=n,e))}async function Xs(e){const t=I(e);return t.persistence.runTransaction("Synchronize last document change read time","readonly",e=>(function(e){const t=_s(e);let n=O.min();return t.Kt({index:ur.readTimeIndex,reverse:!0},(e,t,r)=>{t.readTime&&(n=Ur(t.readTime)),r.done()}).next(()=>n)})(e)).then(e=>{t.Kn=e})}async function Zs(e,t,n,r){const s=I(e);let i=nn(),o=Yt(),a=en();for(const h of n){const e=t.zn(h.metadata.name);h.document&&(i=i.add(e)),o=o.insert(e,t.Hn(h)),a=a.insert(e,t.Jn(h.metadata.readTime))}const c=s.jn.newChangeBuffer({trackRemovals:!0}),u=await Qs(s,function(e){return Xe(Ge(B.fromString(`__bundle__/docs/${e}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",e=>Gs(e,c,o,O.min(),a).next(t=>(c.apply(e),t)).next(t=>s.ze.removeMatchingKeysForTargetId(e,u.targetId).next(()=>s.ze.addMatchingKeys(e,i,u.targetId)).next(()=>s.Qn.vn(e,t)).next(()=>t)))}async function ei(e,t,n=nn()){const r=await Qs(e,Xe(jr(t.bundledQuery))),s=I(e);return s.persistence.runTransaction("Save named query","readwrite",e=>{const i=Tn(t.readTime);if(r.snapshotVersion.compareTo(i)>=0)return s.Je.saveNamedQuery(e,t);const o=r.withResumeToken(j.EMPTY_BYTE_STRING,i);return s.Un=s.Un.insert(o.targetId,o),s.ze.updateTargetData(e,o).next(()=>s.ze.removeMatchingKeysForTargetId(e,r.targetId)).next(()=>s.ze.addMatchingKeys(e,n,r.targetId)).next(()=>s.Je.saveNamedQuery(e,t))})}class ti{constructor(e){this.N=e,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(e,t){return Tr.resolve(this.Yn.get(t))}saveBundleMetadata(e,t){var n;return this.Yn.set(t.id,{id:(n=t).id,version:n.version,createTime:Tn(n.createTime)}),Tr.resolve()}getNamedQuery(e,t){return Tr.resolve(this.Xn.get(t))}saveNamedQuery(e,t){return this.Xn.set(t.name,function(e){return{name:e.name,query:jr(e.bundledQuery),readTime:Tn(e.readTime)}}(t)),Tr.resolve()}}class ni{constructor(){this.Zn=new Qt(ri.ts),this.es=new Qt(ri.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const n=new ri(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.rs(new ri(e,t))}os(e,t){e.forEach(e=>this.removeReference(e,t))}cs(e){const t=new re(new B([])),n=new ri(t,e),r=new ri(t,e+1),s=[];return this.es.forEachInRange([n,r],e=>{this.rs(e),s.push(e.key)}),s}us(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new re(new B([])),n=new ri(t,e),r=new ri(t,e+1);let s=nn();return this.es.forEachInRange([n,r],e=>{s=s.add(e.key)}),s}containsKey(e){const t=new ri(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ri{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return re.comparator(e.key,t.key)||L(e.ls,t.ls)}static ns(e,t){return L(e.ls,t.ls)||re.comparator(e.key,t.key)}}class si{constructor(e,t){this.Ht=e,this.referenceDelegate=t,this.In=[],this.fs=1,this.ds=new Qt(ri.ts)}checkEmpty(e){return Tr.resolve(0===this.In.length)}addMutationBatch(e,t,n,r){const s=this.fs;this.fs++,this.In.length>0&&this.In[this.In.length-1];const i=new Rr(s,t,n,r);this.In.push(i);for(const o of r)this.ds=this.ds.add(new ri(o.key,s)),this.Ht.addToCollectionParentIndex(e,o.key.path.popLast());return Tr.resolve(i)}lookupMutationBatch(e,t){return Tr.resolve(this.ws(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this._s(n),s=r<0?0:r;return Tr.resolve(this.In.length>s?this.In[s]:null)}getHighestUnacknowledgedBatchId(){return Tr.resolve(0===this.In.length?-1:this.fs-1)}getAllMutationBatches(e){return Tr.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ri(t,0),r=new ri(t,Number.POSITIVE_INFINITY),s=[];return this.ds.forEachInRange([n,r],e=>{const t=this.ws(e.ls);s.push(t)}),Tr.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Qt(L);return t.forEach(e=>{const t=new ri(e,0),r=new ri(e,Number.POSITIVE_INFINITY);this.ds.forEachInRange([t,r],e=>{n=n.add(e.ls)})}),Tr.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;re.isDocumentKey(s)||(s=s.child(""));const i=new ri(new re(s),0);let o=new Qt(L);return this.ds.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},i),Tr.resolve(this.gs(o))}gs(e){const t=[];return e.forEach(e=>{const n=this.ws(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){y(0===this.ys(t.batchId,"removed")),this.In.shift();let n=this.ds;return Tr.forEach(t.mutations,r=>{const s=new ri(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ds=n})}te(e){}containsKey(e,t){const n=new ri(t,0),r=this.ds.firstAfterOrEqual(n);return Tr.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.In.length,Tr.resolve()}ys(e,t){return this._s(e)}_s(e){return 0===this.In.length?0:e-this.In[0].batchId}ws(e){const t=this._s(e);return t<0||t>=this.In.length?null:this.In[t]}}class ii{constructor(e,t){this.Ht=e,this.ps=t,this.docs=new zt(re.comparator),this.size=0}addEntry(e,t,n){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.ps(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:o,readTime:n}),this.size+=o-i,this.Ht.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Tr.resolve(n?n.document.clone():ve.newInvalidDocument(t))}getEntries(e,t){let n=Yt();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.clone():ve.newInvalidDocument(e))}),Tr.resolve(n)}getDocumentsMatchingQuery(e,t,n){let r=Yt();const s=new re(t.path.child("")),i=this.docs.getIteratorFrom(s);for(;i.hasNext();){const{key:e,value:{document:s,readTime:o}}=i.getNext();if(!t.path.isPrefixOf(e.path))break;o.compareTo(n)<=0||rt(t,s)&&(r=r.insert(s.key,s.clone()))}return Tr.resolve(r)}Ts(e,t){return Tr.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new oi(this)}getSize(e){return Tr.resolve(this.size)}}class oi extends Es{constructor(e){super(),this.Se=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.document.isValidDocument()?t.push(this.Se.addEntry(e,r.document,this.getReadTime(n))):this.Se.removeEntry(n)}),Tr.waitFor(t)}getFromCache(e,t){return this.Se.getEntry(e,t)}getAllFromCache(e,t){return this.Se.getEntries(e,t)}}class ai{constructor(e){this.persistence=e,this.Es=new Ts(e=>be(e),Ne),this.lastRemoteSnapshotVersion=O.min(),this.highestTargetId=0,this.Is=0,this.As=new ni,this.targetCount=0,this.Rs=us.se()}forEachTarget(e,t){return this.Es.forEach((e,n)=>t(n)),Tr.resolve()}getLastRemoteSnapshotVersion(e){return Tr.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Tr.resolve(this.Is)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),Tr.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Is&&(this.Is=t),Tr.resolve()}ae(e){this.Es.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new us(t),this.highestTargetId=t),e.sequenceNumber>this.Is&&(this.Is=e.sequenceNumber)}addTargetData(e,t){return this.ae(t),this.targetCount+=1,Tr.resolve()}updateTargetData(e,t){return this.ae(t),Tr.resolve()}removeTargetData(e,t){return this.Es.delete(t.target),this.As.cs(t.targetId),this.targetCount-=1,Tr.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.Es.forEach((i,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Es.delete(i),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),Tr.waitFor(s).next(()=>r)}getTargetCount(e){return Tr.resolve(this.targetCount)}getTargetData(e,t){const n=this.Es.get(t)||null;return Tr.resolve(n)}addMatchingKeys(e,t,n){return this.As.ss(t,n),Tr.resolve()}removeMatchingKeys(e,t,n){this.As.os(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(t=>{s.push(r.markPotentiallyOrphaned(e,t))}),Tr.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.As.cs(t),Tr.resolve()}getMatchingKeysForTargetId(e,t){const n=this.As.hs(t);return Tr.resolve(n)}containsKey(e,t){return Tr.resolve(this.As.containsKey(t))}}class ci{constructor(e,t){this.bs={},this.Le=new A(0),this.Be=!1,this.Be=!0,this.referenceDelegate=e(this),this.ze=new ai(this),this.Ht=new Yr,this.He=function(e,t){return new ii(e,t)}(this.Ht,e=>this.referenceDelegate.Ps(e)),this.N=new Or(t),this.Je=new ti(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(e){let t=this.bs[e.toKey()];return t||(t=new si(this.Ht,this.referenceDelegate),this.bs[e.toKey()]=t),t}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(e,t,n){d("MemoryPersistence","Starting transaction:",e);const r=new ui(this.Le.next());return this.referenceDelegate.vs(),n(r).next(e=>this.referenceDelegate.Vs(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ss(e,t){return Tr.or(Object.values(this.bs).map(n=>()=>n.containsKey(e,t)))}}class ui extends vr{constructor(e){super(),this.currentSequenceNumber=e}}class hi{constructor(e){this.persistence=e,this.Ds=new ni,this.Cs=null}static Ns(e){return new hi(e)}get xs(){if(this.Cs)return this.Cs;throw g()}addReference(e,t,n){return this.Ds.addReference(n,t),this.xs.delete(n.toString()),Tr.resolve()}removeReference(e,t,n){return this.Ds.removeReference(n,t),this.xs.add(n.toString()),Tr.resolve()}markPotentiallyOrphaned(e,t){return this.xs.add(t.toString()),Tr.resolve()}removeTarget(e,t){this.Ds.cs(t.targetId).forEach(e=>this.xs.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.xs.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}vs(){this.Cs=new Set}Vs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Tr.forEach(this.xs,n=>{const r=re.fromPath(n);return this.ks(e,r).next(e=>{e||t.removeEntry(r)})}).next(()=>(this.Cs=null,t.apply(e)))}updateLimboDocument(e,t){return this.ks(e,t).next(e=>{e?this.xs.delete(t.toString()):this.xs.add(t.toString())})}Ps(e){return 0}ks(e,t){return Tr.or([()=>Tr.resolve(this.Ds.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ss(e,t)])}}function li(e,t){return`firestore_clients_${e}_${t}`}function di(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function fi(e,t){return`firestore_targets_${e}_${t}`}class mi{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static $s(e,t,n){const r=JSON.parse(n);let s,i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&((i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(s=new T(r.error.code,r.error.message))),i?new mi(e,t,r.state,s):(f("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Os(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pi{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static $s(e,t){const n=JSON.parse(t);let r,s="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&((s="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(r=new T(n.error.code,n.error.message))),s?new pi(e,n.state,r):(f("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Os(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gi{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,s=sn();for(let i=0;r&&i<n.activeTargetIds.length;++i)r=ne(n.activeTargetIds[i]),s=s.add(n.activeTargetIds[i]);return r?new gi(e,s):(f("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class yi{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new yi(t.clientId,t.onlineState):(f("SharedClientState",`Failed to parse online state: ${e}`),null)}}class wi{constructor(){this.activeTargetIds=sn()}Fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ms(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Os(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ii{constructor(e,t,n,r,s){this.window=e,this.Oe=t,this.persistenceKey=n,this.Ls=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Bs=this.Us.bind(this),this.qs=new zt(L),this.started=!1,this.Ks=[];const i=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.js=li(this.persistenceKey,this.Ls),this.Qs=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.qs=this.qs.insert(this.Ls,new wi),this.Ws=new RegExp(`^firestore_clients_${i}_([^_]*)$`),this.Gs=new RegExp(`^firestore_mutations_${i}_(\\d+)(?:_(.*))?$`),this.zs=new RegExp(`^firestore_targets_${i}_(\\d+)$`),this.Hs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Js=function(e){return`firestore_bundle_loaded_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.Bs)}static bt(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.pn();for(const n of e){if(n===this.Ls)continue;const e=this.getItem(li(this.persistenceKey,n));if(e){const t=gi.$s(n,e);t&&(this.qs=this.qs.insert(t.clientId,t))}}this.Ys();const t=this.storage.getItem(this.Hs);if(t){const e=this.Xs(t);e&&this.Zs(e)}for(const n of this.Ks)this.Us(n);this.Ks=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Qs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ti(this.qs)}isActiveQueryTarget(e){let t=!1;return this.qs.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.ei(e,"pending")}updateMutationState(e,t,n){this.ei(e,t,n),this.ni(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(fi(this.persistenceKey,e));if(n){const r=pi.$s(e,n);r&&(t=r.state)}}return this.si.Fs(e),this.Ys(),t}removeLocalQueryTarget(e){this.si.Ms(e),this.Ys()}isLocalQueryTarget(e){return this.si.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(fi(this.persistenceKey,e))}updateQueryState(e,t,n){this.ii(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.ni(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.ri(e)}notifyBundleLoaded(){this.oi()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Bs),this.removeItem(this.js),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return d("SharedClientState","READ",e,t),t}setItem(e,t){d("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){d("SharedClientState","REMOVE",e),this.storage.removeItem(e)}Us(e){const t=e;if(t.storageArea===this.storage){if(d("SharedClientState","EVENT",t.key,t.newValue),t.key===this.js)return void f("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Oe.enqueueRetryable(async()=>{if(this.started){if(null!==t.key)if(this.Ws.test(t.key)){if(null==t.newValue){const e=this.ai(t.key);return this.ci(e,null)}{const e=this.ui(t.key,t.newValue);if(e)return this.ci(e.clientId,e)}}else if(this.Gs.test(t.key)){if(null!==t.newValue){const e=this.hi(t.key,t.newValue);if(e)return this.li(e)}}else if(this.zs.test(t.key)){if(null!==t.newValue){const e=this.fi(t.key,t.newValue);if(e)return this.di(e)}}else if(t.key===this.Hs){if(null!==t.newValue){const e=this.Xs(t.newValue);if(e)return this.Zs(e)}}else if(t.key===this.Qs){const e=function(e){let t=A.T;if(null!=e)try{const n=JSON.parse(e);y("number"==typeof n),t=n}catch(e){f("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==A.T&&this.sequenceNumberHandler(e)}else if(t.key===this.Js)return this.syncEngine.wi()}else this.Ks.push(t)})}}get si(){return this.qs.get(this.Ls)}Ys(){this.setItem(this.js,this.si.Os())}ei(e,t,n){const r=new mi(this.currentUser,e,t,n),s=di(this.persistenceKey,this.currentUser,e);this.setItem(s,r.Os())}ni(e){const t=di(this.persistenceKey,this.currentUser,e);this.removeItem(t)}ri(e){const t={clientId:this.Ls,onlineState:e};this.storage.setItem(this.Hs,JSON.stringify(t))}ii(e,t,n){const r=fi(this.persistenceKey,e),s=new pi(e,t,n);this.setItem(r,s.Os())}oi(){this.setItem(this.Js,"value-not-used")}ai(e){const t=this.Ws.exec(e);return t?t[1]:null}ui(e,t){const n=this.ai(e);return gi.$s(n,t)}hi(e,t){const n=this.Gs.exec(e),r=Number(n[1]),s=void 0!==n[2]?n[2]:null;return mi.$s(new a(s),r,t)}fi(e,t){const n=this.zs.exec(e),r=Number(n[1]);return pi.$s(r,t)}Xs(e){return yi.$s(e)}async li(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine._i(e.batchId,e.state,e.error);d("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}di(e){return this.syncEngine.mi(e.targetId,e.state,e.error)}ci(e,t){const n=t?this.qs.insert(e,t):this.qs.remove(e),r=this.ti(this.qs),s=this.ti(n),i=[],o=[];return s.forEach(e=>{r.has(e)||i.push(e)}),r.forEach(e=>{s.has(e)||o.push(e)}),this.syncEngine.gi(i,o).then(()=>{this.qs=n})}Zs(e){this.qs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ti(e){let t=sn();return e.forEach((e,n)=>{t=t.unionWith(n.activeTargetIds)}),t}}class vi{constructor(){this.yi=new wi,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.yi.Fs(e),this.pi[e]||"not-current"}updateQueryState(e,t,n){this.pi[e]=t}removeLocalQueryTarget(e){this.yi.Ms(e)}isLocalQueryTarget(e){return this.yi.activeTargetIds.has(e)}clearQueryState(e){delete this.pi[e]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(e){return this.yi.activeTargetIds.has(e)}start(){return this.yi=new wi,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}class Ti{Ti(e){}shutdown(){}}class Ei{constructor(){this.Ei=(()=>this.Ii()),this.Ai=(()=>this.Ri()),this.bi=[],this.Pi()}Ti(e){this.bi.push(e)}shutdown(){window.removeEventListener("online",this.Ei),window.removeEventListener("offline",this.Ai)}Pi(){window.addEventListener("online",this.Ei),window.addEventListener("offline",this.Ai)}Ii(){d("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.bi)e(0)}Ri(){d("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.bi)e(1)}static bt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const bi={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Si{constructor(e){this.vi=e.vi,this.Vi=e.Vi}Si(e){this.Di=e}Ci(e){this.Ni=e}onMessage(e){this.xi=e}close(){this.Vi()}send(e){this.vi(e)}ki(){this.Di()}$i(e){this.Ni(e)}Oi(e){this.xi(e)}}class Ni extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.Fi=t+"://"+e.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(e,t,n,r){const s=this.Bi(e,t);d("RestConnection","Sending: ",s,n);const i={};return this.Ui(i,r),this.qi(e,s,i,n).then(e=>(d("RestConnection","Received: ",e),e),t=>{throw m("RestConnection",`${e} failed with error: `,t,"url: ",s,"request:",n),t})}Ki(e,t,n,r){return this.Li(e,t,n,r)}Ui(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/"+c,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(const n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])}Bi(e,t){const n=bi[e];return`${this.Fi}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}qi(e,t,n,r){return new Promise((s,o)=>{const a=new i.XhrIo;a.listenOnce(i.EventType.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case i.ErrorCode.NO_ERROR:const t=a.getResponseJson();d("Connection","XHR received:",JSON.stringify(t)),s(t);break;case i.ErrorCode.TIMEOUT:d("Connection",'RPC "'+e+'" timed out'),o(new T(v.DEADLINE_EXCEEDED,"Request time out"));break;case i.ErrorCode.HTTP_ERROR:const n=a.getStatus();if(d("Connection",'RPC "'+e+'" failed with status:',n,"response text:",a.getResponseText()),n>0){const e=a.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(v).indexOf(t)>=0?t:v.UNKNOWN}(e.status);o(new T(t,e.message))}else o(new T(v.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new T(v.UNAVAILABLE,"Connection failed."));break;default:g()}}finally{d("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(r);a.send(t,"POST",c,n,15)})}ji(e,t){const n=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=(0,i.createWebChannelTransport)(),o=(0,i.getStatEventTarget)(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new i.FetchXmlHttpFactory({})),this.Ui(a.initMessageHeaders,t),(0,s.isMobileCordova)()||(0,s.isReactNative)()||(0,s.isElectron)()||(0,s.isIE)()||(0,s.isUWP)()||(0,s.isBrowserExtension)()||(a.httpHeadersOverwriteParam="$httpHeaders");const c=n.join("");d("Connection","Creating WebChannel: "+c,a);const u=r.createWebChannel(c,a);let h=!1,l=!1;const f=new Si({vi:e=>{l?d("Connection","Not sending because WebChannel is closed:",e):(h||(d("Connection","Opening WebChannel transport."),u.open(),h=!0),d("Connection","WebChannel sending:",e),u.send(e))},Vi:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,i.WebChannel.EventType.OPEN,()=>{l||d("Connection","WebChannel transport opened.")}),p(u,i.WebChannel.EventType.CLOSE,()=>{l||(l=!0,d("Connection","WebChannel transport closed"),f.$i())}),p(u,i.WebChannel.EventType.ERROR,e=>{l||(l=!0,m("Connection","WebChannel transport errored:",e),f.$i(new T(v.UNAVAILABLE,"The operation could not be completed")))}),p(u,i.WebChannel.EventType.MESSAGE,e=>{var t;if(!l){const n=e.data[0];y(!!n);const r=n,s=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(s){d("Connection","WebChannel received error:",s);const e=s.status;let t=function(e){const t=Ut[e];if(void 0!==t)return $t(t)}(e),n=s.message;void 0===t&&(t=v.INTERNAL,n="Unknown error status: "+e+" with message "+s.message),l=!0,f.$i(new T(t,n)),u.close()}else d("Connection","WebChannel received:",n),f.Oi(n)}}),p(o,i.Event.STAT_EVENT,e=>{e.stat===i.Stat.PROXY?d("Connection","Detected buffering proxy"):e.stat===i.Stat.NOPROXY&&d("Connection","Detected no buffering proxy")}),setTimeout(()=>{f.ki()},0),f}}function _i(){return"undefined"!=typeof window?window:null}function xi(){return"undefined"!=typeof document?document:null}function Di(e){return new yn(e,!0)}class Ai{constructor(e,t,n=1e3,r=1.5,s=6e4){this.Oe=e,this.timerId=t,this.Qi=n,this.Wi=r,this.Gi=s,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(e){this.cancel();const t=Math.floor(this.zi+this.Zi()),n=Math.max(0,Date.now()-this.Ji),r=Math.max(0,t-n);r>0&&d("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.zi} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,r,()=>(this.Ji=Date.now(),e())),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){null!==this.Hi&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){null!==this.Hi&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}}class ki{constructor(e,t,n,r,s,i){this.Oe=e,this.er=n,this.nr=r,this.credentialsProvider=s,this.listener=i,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new Ai(e,t)}ar(){return 1===this.state||2===this.state||4===this.state}cr(){return 2===this.state}start(){3!==this.state?this.auth():this.ur()}async stop(){this.ar()&&await this.close(0)}hr(){this.state=0,this.rr.reset()}lr(){this.cr()&&null===this.ir&&(this.ir=this.Oe.enqueueAfterDelay(this.er,6e4,()=>this.dr()))}wr(e){this._r(),this.stream.send(e)}async dr(){if(this.cr())return this.close(0)}_r(){this.ir&&(this.ir.cancel(),this.ir=null)}async close(e,t){this._r(),this.rr.cancel(),this.sr++,3!==e?this.rr.reset():t&&t.code===v.RESOURCE_EXHAUSTED?(f(t.toString()),f("Using maximum backoff delay to prevent overloading the backend."),this.rr.Yi()):t&&t.code===v.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ci(t)}mr(){}auth(){this.state=1;const e=this.gr(this.sr),t=this.sr;this.credentialsProvider.getToken().then(e=>{this.sr===t&&this.yr(e)},t=>{e(()=>{const e=new T(v.UNKNOWN,"Fetching auth token failed: "+t.message);return this.pr(e)})})}yr(e){const t=this.gr(this.sr);this.stream=this.Tr(e),this.stream.Si(()=>{t(()=>(this.state=2,this.listener.Si()))}),this.stream.Ci(e=>{t(()=>this.pr(e))}),this.stream.onMessage(e=>{t(()=>this.onMessage(e))})}ur(){this.state=4,this.rr.Xi(async()=>{this.state=0,this.start()})}pr(e){return d("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(3,e)}gr(e){return t=>{this.Oe.enqueueAndForget(()=>this.sr===e?t():(d("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Ci extends ki{constructor(e,t,n,r,s){super(e,"listen_stream_connection_backoff","listen_stream_idle",t,n,s),this.N=r}Tr(e){return this.nr.ji("Listen",e)}onMessage(e){this.rr.reset();const t=Rn(this.N,e),n=function(e){if(!("targetChange"in e))return O.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?O.min():t.readTime?Tn(t.readTime):O.min()}(e);return this.listener.Er(t,n)}Ir(e){const t={};t.database=Dn(this.N),t.addTarget=function(e,t){let n;const r=t.target;return(n=_e(r)?{documents:Pn(e,r)}:{query:qn(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=In(e,t.resumeToken):t.snapshotVersion.compareTo(O.min())>0&&(n.readTime=wn(e,t.snapshotVersion.toTimestamp())),n}(this.N,e);const n=Un(this.N,e);n&&(t.labels=n),this.wr(t)}Ar(e){const t={};t.database=Dn(this.N),t.removeTarget=e,this.wr(t)}}class Li extends ki{constructor(e,t,n,r,s){super(e,"write_stream_connection_backoff","write_stream_idle",t,n,s),this.N=r,this.Rr=!1}get br(){return this.Rr}start(){this.Rr=!1,this.lastStreamToken=void 0,super.start()}mr(){this.Rr&&this.Pr([])}Tr(e){return this.nr.ji("Write",e)}onMessage(e){if(y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Rr){this.rr.reset();const t=On(e.writeResults,e.commitTime),n=Tn(e.commitTime);return this.listener.vr(n,t)}return y(!e.writeResults||0===e.writeResults.length),this.Rr=!0,this.listener.Vr()}Sr(){const e={};e.database=Dn(this.N),this.wr(e)}Pr(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Fn(this.N,e))};this.wr(t)}}class Ri extends class{}{constructor(e,t,n){super(),this.credentials=e,this.nr=t,this.N=n,this.Dr=!1}Cr(){if(this.Dr)throw new T(v.FAILED_PRECONDITION,"The client has already been terminated.")}Li(e,t,n){return this.Cr(),this.credentials.getToken().then(r=>this.nr.Li(e,t,n,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===v.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new T(v.UNKNOWN,e.toString())})}Ki(e,t,n){return this.Cr(),this.credentials.getToken().then(r=>this.nr.Ki(e,t,n,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===v.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new T(v.UNKNOWN,e.toString())})}terminate(){this.Dr=!0}}class Fi{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Nr=0,this.kr=null,this.$r=!0}Or(){0===this.Nr&&(this.Fr("Unknown"),this.kr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.kr=null,this.Mr("Backend didn't respond within 10 seconds."),this.Fr("Offline"),Promise.resolve())))}Lr(e){"Online"===this.state?this.Fr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Fr("Offline")))}set(e){this.Br(),this.Nr=0,"Online"===e&&(this.$r=!1),this.Fr(e)}Fr(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Mr(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.$r?(f(t),this.$r=!1):d("OnlineStateTracker",t)}Br(){null!==this.kr&&(this.kr.cancel(),this.kr=null)}}class Mi{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ur=[],this.qr=new Map,this.Kr=new Set,this.jr=[],this.Qr=s,this.Qr.Ti(e=>{n.enqueueAndForget(async()=>{zi(this)&&(d("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=I(e);t.Kr.add(4),await Pi(t),t.Wr.set("Unknown"),t.Kr.delete(4),await Oi(t)}(this))})}),this.Wr=new Fi(n,r)}}async function Oi(e){if(zi(e))for(const t of e.jr)await t(!0)}async function Pi(e){for(const t of e.jr)await t(!1)}function qi(e,t){const n=I(e);n.qr.has(t.targetId)||(n.qr.set(t.targetId,t),$i(n)?Ki(n):ao(n).cr()&&Ui(n,t))}function Vi(e,t){const n=I(e),r=ao(n);n.qr.delete(t),r.cr()&&Bi(n,t),0===n.qr.size&&(r.cr()?r.lr():zi(n)&&n.Wr.set("Unknown"))}function Ui(e,t){e.Gr.Y(t.targetId),ao(e).Ir(t)}function Bi(e,t){e.Gr.Y(t),ao(e).Ar(t)}function Ki(e){e.Gr=new dn({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Tt:t=>e.qr.get(t)||null}),ao(e).start(),e.Wr.Or()}function $i(e){return zi(e)&&!ao(e).ar()&&e.qr.size>0}function zi(e){return 0===I(e).Kr.size}function Gi(e){e.Gr=void 0}async function ji(e){e.qr.forEach((t,n)=>{Ui(e,t)})}async function Qi(e,t){Gi(e),$i(e)?(e.Wr.Lr(t),Ki(e)):e.Wr.set("Unknown")}async function Hi(e,t,n){if(e.Wr.set("Online"),t instanceof hn&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.qr.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.qr.delete(r),e.Gr.removeTarget(r))}(e,t)}catch(n){d("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Wi(e,n)}else if(t instanceof cn?e.Gr.rt(t):t instanceof un?e.Gr.ft(t):e.Gr.ct(t),!n.isEqual(O.min()))try{const r=await $s(e.localStore);n.compareTo(r)>=0&&await function(e,t){const n=e.Gr._t(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.qr.get(r);s&&e.qr.set(r,s.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(t=>{const n=e.qr.get(t);if(!n)return;e.qr.set(t,n.withResumeToken(j.EMPTY_BYTE_STRING,n.snapshotVersion)),Bi(e,t);const r=new Mr(n.target,t,1,n.sequenceNumber);Ui(e,r)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){d("RemoteStore","Failed to raise snapshot:",t),await Wi(e,t)}}async function Wi(e,t,n){if(!_r(t))throw t;e.Kr.add(1),await Pi(e),e.Wr.set("Offline"),n||(n=(()=>$s(e.localStore))),e.asyncQueue.enqueueRetryable(async()=>{d("RemoteStore","Retrying IndexedDB access"),await n(),e.Kr.delete(1),await Oi(e)})}function Yi(e,t){return t().catch(n=>Wi(e,n,t))}async function Ji(e){const t=I(e),n=co(t);let r=t.Ur.length>0?t.Ur[t.Ur.length-1].batchId:-1;for(;Xi(t);)try{const s=await js(t.localStore,r);if(null===s){0===t.Ur.length&&n.lr();break}r=s.batchId,Zi(t,s)}catch(e){await Wi(t,e)}eo(t)&&to(t)}function Xi(e){return zi(e)&&e.Ur.length<10}function Zi(e,t){e.Ur.push(t);const n=co(e);n.cr()&&n.br&&n.Pr(t.mutations)}function eo(e){return zi(e)&&!co(e).ar()&&e.Ur.length>0}function to(e){co(e).start()}async function no(e){co(e).Sr()}async function ro(e){const t=co(e);for(const n of e.Ur)t.Pr(n.mutations)}async function so(e,t,n){const r=e.Ur.shift(),s=Fr.from(r,t,n);await Yi(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Ji(e)}async function io(e,t){t&&co(e).br&&await async function(e,t){if(Kt(n=t.code)&&n!==v.ABORTED){const n=e.Ur.shift();co(e).hr(),await Yi(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Ji(e)}var n}(e,t),eo(e)&&to(e)}async function oo(e,t){const n=I(e);t?(n.Kr.delete(2),await Oi(n)):t||(n.Kr.add(2),await Pi(n),n.Wr.set("Unknown"))}function ao(e){return e.zr||(e.zr=function(e,t,n){const r=I(e);return r.Cr(),new Ci(t,r.nr,r.credentials,r.N,n)}(e.datastore,e.asyncQueue,{Si:ji.bind(null,e),Ci:Qi.bind(null,e),Er:Hi.bind(null,e)}),e.jr.push(async t=>{t?(e.zr.hr(),$i(e)?Ki(e):e.Wr.set("Unknown")):(await e.zr.stop(),Gi(e))})),e.zr}function co(e){return e.Hr||(e.Hr=function(e,t,n){const r=I(e);return r.Cr(),new Li(t,r.nr,r.credentials,r.N,n)}(e.datastore,e.asyncQueue,{Si:no.bind(null,e),Ci:io.bind(null,e),Vr:ro.bind(null,e),vr:so.bind(null,e)}),e.jr.push(async t=>{t?(e.Hr.hr(),await Ji(e)):(await e.Hr.stop(),e.Ur.length>0&&(d("RemoteStore",`Stopping write stream with ${e.Ur.length} pending writes`),e.Ur=[]))})),e.Hr}class uo{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new E,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,s){const i=Date.now()+n,o=new uo(e,t,i,r,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new T(v.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ho(e,t){if(f("AsyncQueue",`${t}: ${e}`),_r(e))return new T(v.UNAVAILABLE,`${t}: ${e}`);throw e}class lo{constructor(e){this.comparator=e?(t,n)=>e(t,n)||re.comparator(t.key,n.key):(e,t)=>re.comparator(e.key,t.key),this.keyedMap=Xt(),this.sortedSet=new zt(this.comparator)}static emptySet(e){return new lo(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof lo))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new lo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class fo{constructor(){this.Jr=new zt(re.comparator)}track(e){const t=e.doc.key,n=this.Jr.get(t);n?0!==e.type&&3===n.type?this.Jr=this.Jr.insert(t,e):3===e.type&&1!==n.type?this.Jr=this.Jr.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Jr=this.Jr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Jr=this.Jr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Jr=this.Jr.remove(t):1===e.type&&2===n.type?this.Jr=this.Jr.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Jr=this.Jr.insert(t,{type:2,doc:e.doc}):g():this.Jr=this.Jr.insert(t,e)}Yr(){const e=[];return this.Jr.inorderTraversal((t,n)=>{e.push(n)}),e}}class mo{constructor(e,t,n,r,s,i,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new mo(e,t,lo.emptySet(t),s,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&et(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class po{constructor(){this.Xr=void 0,this.listeners=[]}}class go{constructor(){this.queries=new Ts(e=>tt(e),et),this.onlineState="Unknown",this.Zr=new Set}}async function yo(e,t){const n=I(e),r=t.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new po),s)try{i.Xr=await n.onListen(r)}catch(e){const n=ho(e,`Initialization of query '${nt(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,i),i.listeners.push(t),t.eo(n.onlineState),i.Xr&&t.no(i.Xr)&&To(n)}async function wo(e,t){const n=I(e),r=t.query;let s=!1;const i=n.queries.get(r);if(i){const e=i.listeners.indexOf(t);e>=0&&(i.listeners.splice(e,1),s=0===i.listeners.length)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function Io(e,t){const n=I(e);let r=!1;for(const s of t){const e=s.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.no(s)&&(r=!0);t.Xr=s}}r&&To(n)}function vo(e,t,n){const r=I(e),s=r.queries.get(t);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(t)}function To(e){e.Zr.forEach(e=>{e.next()})}class Eo{constructor(e,t,n){this.query=e,this.so=t,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=n||{}}no(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new mo(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.io?this.oo(e)&&(this.so.next(e),t=!0):this.ao(e,this.onlineState)&&(this.co(e),t=!0),this.ro=e,t}onError(e){this.so.error(e)}eo(e){this.onlineState=e;let t=!1;return this.ro&&!this.io&&this.ao(this.ro,e)&&(this.co(this.ro),t=!0),t}ao(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return!(this.options.uo&&n||e.docs.isEmpty()&&"Offline"!==t)}oo(e){if(e.docChanges.length>0)return!0;const t=this.ro&&this.ro.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}co(e){e=mo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.io=!0,this.so.next(e)}}class bo{constructor(e,t){this.payload=e,this.byteLength=t}ho(){return"metadata"in this.payload}}class So{constructor(e){this.N=e}zn(e){return Nn(this.N,e)}Hn(e){return e.metadata.exists?Cn(this.N,e.document,!1):ve.newNoDocument(this.zn(e.metadata.name),this.Jn(e.metadata.readTime))}Jn(e){return Tn(e)}}class No{constructor(e,t,n){this.lo=e,this.localStore=t,this.N=n,this.queries=[],this.documents=[],this.progress=_o(e)}fo(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}wo(e){const t=new Map,n=new So(this.N);for(const r of e)if(r.metadata.queries){const e=n.zn(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||nn()).add(e);t.set(n,r)}}return t}async complete(){const e=await Zs(this.localStore,new So(this.N),this.documents,this.lo.id),t=this.wo(this.documents);for(const n of this.queries)await ei(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",new Ms(Object.assign({},this.progress),e)}}function _o(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class xo{constructor(e){this.key=e}}class Do{constructor(e){this.key=e}}class Ao{constructor(e,t){this.query=e,this._o=t,this.mo=null,this.current=!1,this.yo=nn(),this.mutatedKeys=nn(),this.po=st(e),this.To=new lo(this.po)}get Eo(){return this._o}Io(e,t){const n=t?t.Ao:new fo,r=t?t.To:this.To;let s=t?t.mutatedKeys:this.mutatedKeys,i=r,o=!1;const a=je(this.query)&&r.size===this.query.limit?r.last():null,c=Qe(this.query)&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const u=r.get(e),h=rt(this.query,t)?t:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.Ro(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.po(h,a)>0||c&&this.po(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(i=i.add(h),s=d?s.add(e):s.delete(e)):(i=i.delete(e),s=s.delete(e)))}),je(this.query)||Qe(this.query))for(;i.size>this.query.limit;){const e=je(this.query)?i.last():i.first();i=i.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{To:i,Ao:n,Ln:o,mutatedKeys:s}}Ro(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.To;this.To=e.To,this.mutatedKeys=e.mutatedKeys;const s=e.Ao.Yr();s.sort((e,t)=>(function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return g()}};return n(e)-n(t)})(e.type,t.type)||this.po(e.doc,t.doc)),this.bo(n);const i=t?this.Po():[],o=0===this.yo.size&&this.current?1:0,a=o!==this.mo;return this.mo=o,0!==s.length||a?{snapshot:new mo(this.query,e.To,r,s,e.mutatedKeys,0===o,a,!1),vo:i}:{vo:i}}eo(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({To:this.To,Ao:new fo,mutatedKeys:this.mutatedKeys,Ln:!1},!1)):{vo:[]}}Vo(e){return!this._o.has(e)&&!!this.To.has(e)&&!this.To.get(e).hasLocalMutations}bo(e){e&&(e.addedDocuments.forEach(e=>this._o=this._o.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this._o=this._o.delete(e)),this.current=e.current)}Po(){if(!this.current)return[];const e=this.yo;this.yo=nn(),this.To.forEach(e=>{this.Vo(e.key)&&(this.yo=this.yo.add(e.key))});const t=[];return e.forEach(e=>{this.yo.has(e)||t.push(new Do(e))}),this.yo.forEach(n=>{e.has(n)||t.push(new xo(n))}),t}So(e){this._o=e.Gn,this.yo=nn();const t=this.Io(e.documents);return this.applyChanges(t,!0)}Do(){return mo.fromInitialDocuments(this.query,this.To,this.mutatedKeys,0===this.mo)}}class ko{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Co{constructor(e){this.key=e,this.Co=!1}}class Lo{constructor(e,t,n,r,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.No={},this.xo=new Ts(e=>tt(e),et),this.ko=new Map,this.$o=new Set,this.Oo=new zt(re.comparator),this.Fo=new Map,this.Mo=new ni,this.Lo={},this.Bo=new Map,this.Uo=us.ie(),this.onlineState="Unknown",this.qo=void 0}get isPrimaryClient(){return!0===this.qo}}async function Ro(e,t){const n=ca(e);let r,s;const i=n.xo.get(t);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Do();else{const e=await Qs(n.localStore,Xe(t)),i=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,s=await Fo(n,t,r,"current"===i),n.isPrimaryClient&&qi(n.remoteStore,e)}return s}async function Fo(e,t,n,r){e.Ko=((t,n,r)=>(async function(e,t,n,r){let s=t.view.Io(n);s.Ln&&(s=await Ws(e.localStore,t.query,!1).then(({documents:e})=>t.view.Io(e,s)));const i=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(s,e.isPrimaryClient,i);return Qo(e,t.targetId,o.vo),o.snapshot})(e,t,n,r));const s=await Ws(e.localStore,t,!0),i=new Ao(t,s.Gn),o=i.Io(s.documents),a=an.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),c=i.applyChanges(o,e.isPrimaryClient,a);Qo(e,n,c.vo);const u=new ko(t,n,i);return e.xo.set(t,u),e.ko.has(n)?e.ko.get(n).push(t):e.ko.set(n,[t]),c.snapshot}async function Mo(e,t){const n=I(e),r=n.xo.get(t),s=n.ko.get(r.targetId);if(s.length>1)return n.ko.set(r.targetId,s.filter(e=>!et(e,t))),void n.xo.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Hs(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Vi(n.remoteStore,r.targetId),Go(n,r.targetId)}).catch(ms)):(Go(n,r.targetId),await Hs(n.localStore,r.targetId,!0))}async function Oo(e,t,n){const r=ua(e);try{const s=await function(e,t){const n=I(e),r=M.now(),s=t.reduce((e,t)=>e.add(t.key),nn());let i;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>n.Qn.Pn(e,s).next(s=>{i=s;const o=[];for(const e of t){const t=At(e,i.get(e.key));null!=t&&o.push(new Rt(e.key,t,Ie(t.value.mapValue),St.exists(!0)))}return n.In.addMutationBatch(e,r,o,t)})).then(e=>(e.applyToLocalDocumentSet(i),{batchId:e.batchId,changes:i}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(e,t,n){let r=e.Lo[e.currentUser.toKey()];r||(r=new zt(L)),r=r.insert(t,n),e.Lo[e.currentUser.toKey()]=r}(r,s.batchId,n),await Yo(r,s.changes),await Ji(r.remoteStore)}catch(e){const t=ho(e,"Failed to persist write");n.reject(t)}}async function Po(e,t){const n=I(e);try{const r=await zs(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Fo.get(t);r&&(y(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Co=!0:e.modifiedDocuments.size>0?y(r.Co):e.removedDocuments.size>0&&(y(r.Co),r.Co=!1))}),await Yo(n,r,t)}catch(e){await ms(e)}}function qo(e,t,n){const r=I(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.xo.forEach((n,r)=>{const s=r.view.eo(t);s.snapshot&&e.push(s.snapshot)}),function(e,t){const n=I(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const s of n.listeners)s.eo(t)&&(r=!0)}),r&&To(n)}(r.eventManager,t),e.length&&r.No.Er(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Vo(e,t,n){const r=I(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Fo.get(t),i=s&&s.key;if(i){let e=new zt(re.comparator);e=e.insert(i,ve.newNoDocument(i,O.min()));const n=nn().add(i),s=new on(O.min(),new Map,new Qt(L),e,n);await Po(r,s),r.Oo=r.Oo.remove(i),r.Fo.delete(t),Wo(r)}else await Hs(r.localStore,t,!1).then(()=>Go(r,t,n)).catch(ms)}async function Uo(e,t){const n=I(e),r=t.batch.batchId;try{const s=await Ks(n.localStore,t);zo(n,r,null),$o(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Yo(n,s)}catch(e){await ms(e)}}async function Bo(e,t,n){const r=I(e);try{const e=await function(e,t){const n=I(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.In.lookupMutationBatch(e,t).next(t=>(y(null!==t),r=t.keys(),n.In.removeMutationBatch(e,t))).next(()=>n.In.performConsistencyCheck(e)).next(()=>n.Qn.Pn(e,r))})}(r.localStore,t);zo(r,t,n),$o(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Yo(r,e)}catch(n){await ms(n)}}async function Ko(e,t){const n=I(e);zi(n.remoteStore)||d("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(e){const t=I(n.localStore);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.In.getHighestUnacknowledgedBatchId(e))}();if(-1===r)return void t.resolve();const s=n.Bo.get(r)||[];s.push(t),n.Bo.set(r,s)}catch(e){const n=ho(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}function $o(e,t){(e.Bo.get(t)||[]).forEach(e=>{e.resolve()}),e.Bo.delete(t)}function zo(e,t,n){const r=I(e);let s=r.Lo[r.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),r.Lo[r.currentUser.toKey()]=s}}function Go(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.ko.get(t))e.xo.delete(r),n&&e.No.jo(r,n);e.ko.delete(t),e.isPrimaryClient&&e.Mo.cs(t).forEach(t=>{e.Mo.containsKey(t)||jo(e,t)})}function jo(e,t){e.$o.delete(t.path.canonicalString());const n=e.Oo.get(t);null!==n&&(Vi(e.remoteStore,n),e.Oo=e.Oo.remove(t),e.Fo.delete(n),Wo(e))}function Qo(e,t,n){for(const r of n)r instanceof xo?(e.Mo.addReference(r.key,t),Ho(e,r)):r instanceof Do?(d("SyncEngine","Document no longer in limbo: "+r.key),e.Mo.removeReference(r.key,t),e.Mo.containsKey(r.key)||jo(e,r.key)):g()}function Ho(e,t){const n=t.key,r=n.path.canonicalString();e.Oo.get(n)||e.$o.has(r)||(d("SyncEngine","New document in limbo: "+n),e.$o.add(r),Wo(e))}function Wo(e){for(;e.$o.size>0&&e.Oo.size<e.maxConcurrentLimboResolutions;){const t=e.$o.values().next().value;e.$o.delete(t);const n=new re(B.fromString(t)),r=e.Uo.next();e.Fo.set(r,new Co(n)),e.Oo=e.Oo.insert(n,r),qi(e.remoteStore,new Mr(Xe(Ge(n.path)),r,2,A.T))}}async function Yo(e,t,n){const r=I(e),s=[],i=[],o=[];r.xo.isEmpty()||(r.xo.forEach((e,a)=>{o.push(r.Ko(a,t,n).then(e=>{if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),s.push(e);const t=Ps.kn(a.targetId,e);i.push(t)}}))}),await Promise.all(o),r.No.Er(s),await async function(e,t){const n=I(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Tr.forEach(t,t=>Tr.forEach(t.Nn,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Tr.forEach(t.xn,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!_r(e))throw e;d("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Un.get(e),r=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(r);n.Un=n.Un.insert(e,s)}}}(r.localStore,i))}async function Jo(e,t){const n=I(e);if(!n.currentUser.isEqual(t)){d("SyncEngine","User change. New user:",t.toKey());const e=await Bs(n.localStore,t);n.currentUser=t,function(e,t){e.Bo.forEach(e=>{e.forEach(e=>{e.reject(new T(v.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Bo.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Yo(n,e.Wn)}}function Xo(e,t){const n=I(e),r=n.Fo.get(t);if(r&&r.Co)return nn().add(r.key);{let e=nn();const r=n.ko.get(t);if(!r)return e;for(const t of r){const r=n.xo.get(t);e=e.unionWith(r.view.Eo)}return e}}async function Zo(e,t){const n=I(e),r=await Ws(n.localStore,t.query,!0),s=t.view.So(r);return n.isPrimaryClient&&Qo(n,t.targetId,s.vo),s}async function ea(e){const t=I(e);return Js(t.localStore).then(e=>Yo(t,e))}async function ta(e,t,n,r){const s=I(e),i=await function(e,t){const n=I(e),r=I(n.In);return n.persistence.runTransaction("Lookup mutation documents","readonly",e=>r.Xt(e,t).next(t=>t?n.Qn.Pn(e,t):Tr.resolve(null)))}(s.localStore,t);null!==i?("pending"===n?await Ji(s.remoteStore):"acknowledged"===n||"rejected"===n?(zo(s,t,r||null),$o(s,t),function(e,t){I(I(e).In).te(t)}(s.localStore,t)):g(),await Yo(s,i)):d("SyncEngine","Cannot apply mutation batch with id: "+t)}async function na(e,t){const n=I(e);if(ca(n),ua(n),!0===t&&!0!==n.qo){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await ra(n,e.toArray());n.qo=!0,await oo(n.remoteStore,!0);for(const r of t)qi(n.remoteStore,r)}else if(!1===t&&!1!==n.qo){const e=[];let t=Promise.resolve();n.ko.forEach((r,s)=>{n.sharedClientState.isLocalQueryTarget(s)?e.push(s):t=t.then(()=>(Go(n,s),Hs(n.localStore,s,!0))),Vi(n.remoteStore,s)}),await t,await ra(n,e),function(e){const t=I(n);t.Fo.forEach((e,n)=>{Vi(t.remoteStore,n)}),t.Mo.us(),t.Fo=new Map,t.Oo=new zt(re.comparator)}(),n.qo=!1,await oo(n.remoteStore,!1)}}async function ra(e,t,n){const r=I(e),s=[],i=[];for(const o of t){let e;const t=r.ko.get(o);if(t&&0!==t.length){e=await Qs(r.localStore,Xe(t[0]));for(const e of t){const t=r.xo.get(e),n=await Zo(r,t);n.snapshot&&i.push(n.snapshot)}}else{const t=await Ys(r.localStore,o);e=await Qs(r.localStore,t),await Fo(r,sa(t),o,!1)}s.push(e)}return r.No.Er(i),s}function sa(e){return ze(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function ia(e){const t=I(e);return I(I(t.localStore).persistence).pn()}async function oa(e,t,n,r){const s=I(e);if(s.qo)d("SyncEngine","Ignoring unexpected query state notification.");else if(s.ko.has(t))switch(n){case"current":case"not-current":{const e=await Js(s.localStore),r=on.createSynthesizedRemoteEventForCurrentChange(t,"current"===n);await Yo(s,e,r);break}case"rejected":await Hs(s.localStore,t,!0),Go(s,t,r);break;default:g()}}async function aa(e,t,n){const r=ca(e);if(r.qo){for(const e of t){if(r.ko.has(e)){d("SyncEngine","Adding an already active target "+e);continue}const t=await Ys(r.localStore,e),n=await Qs(r.localStore,t);await Fo(r,sa(t),n.targetId,!1),qi(r.remoteStore,n)}for(const e of n)r.ko.has(e)&&await Hs(r.localStore,e,!1).then(()=>{Vi(r.remoteStore,e),Go(r,e)}).catch(ms)}}function ca(e){const t=I(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Po.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Xo.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Vo.bind(null,t),t.No.Er=Io.bind(null,t.eventManager),t.No.jo=vo.bind(null,t.eventManager),t}function ua(e){const t=I(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Uo.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Bo.bind(null,t),t}function ha(e,t,n){const r=I(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=I(e),r=Tn(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.Je.getBundleMetadata(e,t.id)).then(e=>!!e&&e.createTime.compareTo(r)>=0)}(e.localStore,r))return await t.close(),void n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r));n._updateProgress(_o(r));const s=new No(r,e.localStore,t.N);let i=await t.Qo();for(;i;){const e=await s.fo(i);e&&n._updateProgress(e),i=await t.Qo()}const o=await s.complete();await Yo(e,o.En,void 0),await function(e,t){const n=I(e);return n.persistence.runTransaction("Save bundle","readwrite",e=>n.Je.saveBundleMetadata(e,t))}(e.localStore,r),n._completeWith(o.progress)}catch(e){m("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e)}})(r,t,n).then(()=>{r.sharedClientState.notifyBundleLoaded()})}class la{constructor(){this.synchronizeTabs=!1}async initialize(e){this.N=Di(e.databaseInfo.databaseId),this.sharedClientState=this.Wo(e),this.persistence=this.Go(e),await this.persistence.start(),this.gcScheduler=this.zo(e),this.localStore=this.Ho(e)}zo(e){return null}Ho(e){return Us(this.persistence,new qs,e.initialUser,this.N)}Go(e){return new ci(hi.Ns,this.N)}Wo(e){return new vi}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class da extends la{constructor(e,t,n){super(),this.Jo=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await Xs(this.localStore),await this.Jo.initialize(this,e),await ua(this.Jo.syncEngine),await Ji(this.Jo.remoteStore),await this.persistence.nn(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(this.localStore),Promise.resolve()))}Ho(e){return Us(this.persistence,new qs,e.initialUser,this.N)}zo(e){const t=this.persistence.referenceDelegate.garbageCollector;return new ys(t,e.asyncQueue)}Go(e){const t=Fs(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ts.withCacheSize(this.cacheSizeBytes):ts.DEFAULT;return new Cs(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,_i(),xi(),this.N,this.sharedClientState,!!this.forceOwnership)}Wo(e){return new vi}}class fa extends da{constructor(e,t){super(e,t,!1),this.Jo=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Jo.syncEngine;this.sharedClientState instanceof Ii&&(this.sharedClientState.syncEngine={_i:ta.bind(null,t),mi:oa.bind(null,t),gi:aa.bind(null,t),pn:ia.bind(null,t),wi:ea.bind(null,t)},await this.sharedClientState.start()),await this.persistence.nn(async e=>{await na(this.Jo.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop())})}Wo(e){const t=_i();if(!Ii.bt(t))throw new T(v.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=Fs(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ii(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class ma{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=(e=>qo(this.syncEngine,e,1)),this.remoteStore.remoteSyncer.handleCredentialChange=Jo.bind(null,this.syncEngine),await oo(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new go}createDatastore(e){const t=Di(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new Ni(r));var r;return function(e,t,n){return new Ri(e,t,n)}(e.credentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,s=(e=>qo(this.syncEngine,e,0)),i=Ei.bt()?new Ei:new Ti,new Mi(t,n,r,s,i);var t,n,r,s,i}createSyncEngine(e,t){return function(e,t,n,r,s,i,o){const a=new Lo(e,t,n,r,s,i);return o&&(a.qo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=I(e);d("RemoteStore","RemoteStore shutting down."),t.Kr.add(5),await Pi(t),t.Qr.shutdown(),t.Wr.set("Unknown")}(this.remoteStore)}}function pa(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}class ga{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Yo(this.observer.next,e)}error(e){this.observer.error?this.Yo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Xo(){this.muted=!0}Yo(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class ya{constructor(e,t){this.Zo=e,this.N=t,this.metadata=new E,this.buffer=new Uint8Array,this.ta=new TextDecoder("utf-8"),this.ea().then(e=>{e&&e.ho()?this.metadata.resolve(e.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.payload)}`))},e=>this.metadata.reject(e))}close(){return this.Zo.cancel()}async getMetadata(){return this.metadata.promise}async Qo(){return await this.getMetadata(),this.ea()}async ea(){const e=await this.na();if(null===e)return null;const t=this.ta.decode(e),n=Number(t);isNaN(n)&&this.sa(`length string (${t}) is not valid number`);const r=await this.ia(n);return new bo(JSON.parse(r),e.length+n)}ra(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async na(){for(;this.ra()<0&&!(await this.oa()););if(0===this.buffer.length)return null;const e=this.ra();e<0&&this.sa("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async ia(e){for(;this.buffer.length<e;)await this.oa()&&this.sa("Reached the end of bundle when more is expected.");const t=this.ta.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}sa(e){throw this.Zo.cancel(),new Error(`Invalid bundle format: ${e}`)}async oa(){const e=await this.Zo.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class wa{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new T(v.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=I(e),r=Dn(n.N)+"/documents",s={documents:t.map(e=>Sn(n.N,e))},i=await n.Ki("BatchGetDocuments",r,s),o=new Map;i.forEach(e=>{const t=Ln(n.N,e);o.set(t.key.toString(),t)});const a=[];return t.forEach(e=>{const t=o.get(e.toString());y(!!t),a.push(t)}),a}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Pt(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=re.fromPath(t);this.mutations.push(new qt(n,this.precondition(n)))}),await async function(e,t){const n=I(e),r=Dn(n.N)+"/documents",s={writes:t.map(e=>Fn(n.N,e))};await n.Li("Commit",r,s)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw g();t=O.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new T(v.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?St.updateTime(t):St.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(O.min()))throw new T(v.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return St.updateTime(t)}return St.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Ia{constructor(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.aa=5,this.rr=new Ai(this.asyncQueue,"transaction_retry")}run(){this.aa-=1,this.ca()}ca(){this.rr.Xi(async()=>{const e=new wa(this.datastore),t=this.ua(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.ha(e)}))}).catch(e=>{this.ha(e)})})}ua(e){try{const t=this.updateFunction(e);return!ee(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ha(e){this.aa>0&&this.la(e)?(this.aa-=1,this.asyncQueue.enqueueAndForget(()=>(this.ca(),Promise.resolve()))):this.deferred.reject(e)}la(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!Kt(t)}return!1}}class va{constructor(e,t,n){this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=a.UNAUTHENTICATED,this.clientId=C.I(),this.credentialListener=(()=>Promise.resolve()),this.credentials.start(t,async e=>{d("FirestoreClient","Received user=",e.uid),await this.credentialListener(e),this.user=e})}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.credentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new T(v.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new E;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.shutdown(),e.resolve()}catch(t){const n=ho(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Ta(e,t){e.asyncQueue.verifyOperationInProgress(),d("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Bs(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e.offlineComponents=t}async function Ea(e,t){e.asyncQueue.verifyOperationInProgress();const n=await ba(e);d("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener(e=>(async function(e,t){const n=I(e);n.asyncQueue.verifyOperationInProgress(),d("RemoteStore","RemoteStore received new credentials");const r=zi(n);n.Kr.add(3),await Pi(n),r&&n.Wr.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Kr.delete(3),await Oi(n)})(t.remoteStore,e)),e.onlineComponents=t}async function ba(e){return e.offlineComponents||(d("FirestoreClient","Using default OfflineComponentProvider"),await Ta(e,new la)),e.offlineComponents}async function Sa(e){return e.onlineComponents||(d("FirestoreClient","Using default OnlineComponentProvider"),await Ea(e,new ma)),e.onlineComponents}function Na(e){return ba(e).then(e=>e.persistence)}function _a(e){return ba(e).then(e=>e.localStore)}function xa(e){return Sa(e).then(e=>e.remoteStore)}function Da(e){return Sa(e).then(e=>e.syncEngine)}async function Aa(e){const t=await Sa(e),n=t.eventManager;return n.onListen=Ro.bind(null,t.syncEngine),n.onUnlisten=Mo.bind(null,t.syncEngine),n}function ka(e){return e.asyncQueue.enqueue(async()=>{const t=await Na(e),n=await xa(e);return t.setNetworkEnabled(!0),function(e){const t=I(n);return t.Kr.delete(0),Oi(t)}()})}function Ca(e){return e.asyncQueue.enqueue(async()=>{const t=await Na(e),n=await xa(e);return t.setNetworkEnabled(!1),async function(e){const t=I(n);t.Kr.add(0),await Pi(t),t.Wr.set("Offline")}()})}function La(e,t){const n=new E;return e.asyncQueue.enqueueAndForget(async()=>(async function(e,t,n){try{const r=await function(e,t){const n=I(e);return n.persistence.runTransaction("read document","readonly",e=>n.Qn.An(e,t))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new T(v.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=ho(e,`Failed to get document '${t} from cache`);n.reject(r)}})(await _a(e),t,n)),n.promise}function Ra(e,t,n={}){const r=new E;return e.asyncQueue.enqueueAndForget(async()=>(function(e,t,n,r,s){const i=new ga({next:i=>{t.enqueueAndForget(()=>wo(e,o));const a=i.docs.has(n);!a&&i.fromCache?s.reject(new T(v.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&i.fromCache&&r&&"server"===r.source?s.reject(new T(v.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(i)},error:e=>s.reject(e)}),o=new Eo(Ge(n.path),i,{includeMetadataChanges:!0,uo:!0});return yo(e,o)})(await Aa(e),e.asyncQueue,t,n,r)),r.promise}function Fa(e,t){const n=new E;return e.asyncQueue.enqueueAndForget(async()=>(async function(e,t,n){try{const r=await Ws(e,t,!0),s=new Ao(t,r.Gn),i=s.Io(r.documents),o=s.applyChanges(i,!1);n.resolve(o.snapshot)}catch(e){const r=ho(e,`Failed to execute query '${t} against cache`);n.reject(r)}})(await _a(e),t,n)),n.promise}function Ma(e,t,n={}){const r=new E;return e.asyncQueue.enqueueAndForget(async()=>(function(e,t,n,r,s){const i=new ga({next:n=>{t.enqueueAndForget(()=>wo(e,o)),n.fromCache&&"server"===r.source?s.reject(new T(v.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:e=>s.reject(e)}),o=new Eo(n,i,{includeMetadataChanges:!0,uo:!0});return yo(e,o)})(await Aa(e),e.asyncQueue,t,n,r)),r.promise}function Oa(e,t){const n=new ga(t);return e.asyncQueue.enqueueAndForget(async()=>(function(e,t){I(e).Zr.add(t),t.next()})(await Aa(e),n)),()=>{n.Xo(),e.asyncQueue.enqueueAndForget(async()=>(function(e,t){I(e).Zr.delete(t)})(await Aa(e),n))}}function Pa(e,t){const n=new E;return e.asyncQueue.enqueueAndForget(async()=>{const r=await function(e){return Sa(e).then(e=>e.datastore)}(e);new Ia(e.asyncQueue,r,t,n).run()}),n.promise}function qa(e,t,n,r){const s=function(e,t){let n;return function(e,t){return new ya(e,t)}(function(e,t){if(e instanceof Uint8Array)return pa(e,t);if(e instanceof ArrayBuffer)return pa(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n="string"==typeof e?(new TextEncoder).encode(e):e),t)}(n,Di(t));e.asyncQueue.enqueueAndForget(async()=>{ha(await Da(e),s,r)})}function Va(e,t){return e.asyncQueue.enqueue(async()=>(function(e,t){const n=I(e);return n.persistence.runTransaction("Get named query","readonly",e=>n.Je.getNamedQuery(e,t))})(await _a(e),t))}class Ua{constructor(e,t,n,r,s,i,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Ba{constructor(e,t){this.projectId=e,this.database=t||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ba&&e.projectId===this.projectId&&e.database===this.database}}exports._DatabaseId=Ba;const Ka=new Map;function $a(e,t,n){if(!n)throw new T(v.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function za(e,t,n,r){if(!0===t&&!0===r)throw new T(v.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Ga(e){if(!re.isDocumentKey(e))throw new T(v.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function ja(e){if(re.isDocumentKey(e))throw new T(v.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Qa(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":g()}function Ha(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new T(v.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Qa(e);throw new T(v.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Wa(e,t){if(t<=0)throw new T(v.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class Ya{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new T(v.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new T(v.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,za("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ja{constructor(e,t){this._credentials=t,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ya({}),this._settingsFrozen=!1,e instanceof Ba?this._databaseId=e:(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new T(v.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ba(e.options.projectId)}(e))}get app(){if(!this._app)throw new T(v.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new T(v.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ya(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new S;switch(e.type){case"gapi":const t=e.client;return y(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new D(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new T(v.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Ka.get(e);t&&(d("ComponentProvider","Removing Datastore"),Ka.delete(e),t.terminate())}(this),Promise.resolve()}}function Xa(e,t,n,r={}){var i;const o=(e=Ha(e,Ja))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==t&&m("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},o),{host:`${t}:${n}`,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=a.MOCK_USER;else{t=(0,s.createMockUserToken)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new T(v.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new a(o)}e._credentials=new N(new b(t,n))}}class Za{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Za(this.firestore,e,this._key)}}exports.DocumentReference=Za;class ec{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ec(this.firestore,e,this._query)}}exports.Query=ec;class tc extends ec{constructor(e,t,n){super(e,t,Ge(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Za(this.firestore,null,new re(e))}withConverter(e){return new tc(this.firestore,e,this._path)}}function nc(e,t,...n){if(e=(0,s.getModularInstance)(e),$a("collection","path",t),e instanceof Ja){const r=B.fromString(t,...n);return ja(r),new tc(e,null,r)}{if(!(e instanceof Za||e instanceof tc))throw new T(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(B.fromString(t,...n));return ja(r),new tc(e.firestore,null,r)}}function rc(e,t){if(e=Ha(e,Ja),$a("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new T(v.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ec(e,null,function(e){return new $e(B.emptyPath(),e)}(t))}function sc(e,t,...n){if(e=(0,s.getModularInstance)(e),1===arguments.length&&(t=C.I()),$a("doc","path",t),e instanceof Ja){const r=B.fromString(t,...n);return Ga(r),new Za(e,null,new re(r))}{if(!(e instanceof Za||e instanceof tc))throw new T(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(B.fromString(t,...n));return Ga(r),new Za(e.firestore,e instanceof tc?e.converter:null,new re(r))}}function ic(e,t){return e=(0,s.getModularInstance)(e),t=(0,s.getModularInstance)(t),(e instanceof Za||e instanceof tc)&&(t instanceof Za||t instanceof tc)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function oc(e,t){return e=(0,s.getModularInstance)(e),t=(0,s.getModularInstance)(t),e instanceof ec&&t instanceof ec&&e.firestore===t.firestore&&et(e._query,t._query)&&e.converter===t.converter}exports.CollectionReference=tc;class ac{constructor(){this.fa=Promise.resolve(),this.da=[],this.wa=!1,this._a=[],this.ma=null,this.ga=!1,this.ya=!1,this.pa=[],this.rr=new Ai(this,"async_queue_retry"),this.Ta=(()=>{const e=xi();e&&d("AsyncQueue","Visibility state changed to "+e.visibilityState),this.rr.tr()});const e=xi();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ta)}get isShuttingDown(){return this.wa}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ea(),this.Ia(e)}enterRestrictedMode(e){if(!this.wa){this.wa=!0,this.ya=e||!1;const t=xi();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ta)}}enqueue(e){if(this.Ea(),this.wa)return new Promise(()=>{});const t=new E;return this.Ia(()=>this.wa&&this.ya?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.da.push(e),this.Aa()))}async Aa(){if(0!==this.da.length){try{await this.da[0](),this.da.shift(),this.rr.reset()}catch(e){if(!_r(e))throw e;d("AsyncQueue","Operation failed with retryable error: "+e)}this.da.length>0&&this.rr.Xi(()=>this.Aa())}}Ia(e){const t=this.fa.then(()=>(this.ga=!0,e().catch(e=>{throw this.ma=e,this.ga=!1,f("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.ga=!1,e))));return this.fa=t,t}enqueueAfterDelay(e,t,n){this.Ea(),this.pa.indexOf(e)>-1&&(t=0);const r=uo.createAndSchedule(this,e,t,n,e=>this.Ra(e));return this._a.push(r),r}Ea(){this.ma&&g()}verifyOperationInProgress(){}async ba(){let e;do{e=this.fa,await e}while(e!==this.fa)}Pa(e){for(const t of this._a)if(t.timerId===e)return!0;return!1}va(e){return this.ba().then(()=>{this._a.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this._a)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.ba()})}Va(e){this.pa.push(e)}Ra(e){const t=this._a.indexOf(e);this._a.splice(t,1)}}function cc(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of["next","error","complete"])if(r in n&&"function"==typeof n[r])return!0;return!1}(e)}class uc{constructor(){this._progressObserver={},this._taskCompletionResolver=new E,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}exports.LoadBundleTask=uc;const hc=-1;exports.CACHE_SIZE_UNLIMITED=-1;class lc extends Ja{constructor(e,t){super(e,t),this.type="firestore",this._queue=new ac,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||pc(this),this._firestoreClient.terminate()}}function dc(e,n){const r=(0,t._getProvider)(e,"firestore");if(r.isInitialized()){const e=r.getImmediate(),t=r.getOptions();if((0,s.deepEqual)(t,n))return e;throw new T(v.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==n.cacheSizeBytes&&-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new T(v.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:n})}function fc(e=(0,t.getApp)()){return(0,t._getProvider)(e,"firestore").getImmediate()}function mc(e){return e._firestoreClient||pc(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function pc(e){var t;const n=e._freezeSettings(),r=function(e,t,n,r){return new Ua(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new va(e._credentials,e._queue,r)}function gc(e,t){_c(e=Ha(e,lc));const n=mc(e),r=e._freezeSettings(),s=new ma;return wc(n,s,new da(s,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function yc(e){_c(e=Ha(e,lc));const t=mc(e),n=e._freezeSettings(),r=new ma;return wc(t,r,new fa(r,n.cacheSizeBytes))}function wc(e,t,n){const r=new E;return e.asyncQueue.enqueue(async()=>{try{await Ta(e,n),await Ea(e,t),r.resolve()}catch(e){if(!function(e){return"FirebaseError"===e.name?e.code===v.FAILED_PRECONDITION||e.code===v.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(e))throw e;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),r.reject(e)}}).then(()=>r.promise)}function Ic(e){if(e._initialized&&!e._terminated)throw new T(v.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new E;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!br.bt())return Promise.resolve();const t=e+"main";await br.delete(t)}(Fs(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}}),t.promise}function vc(e){return function(e){const t=new E;return e.asyncQueue.enqueueAndForget(async()=>Ko(await Da(e),t)),t.promise}(mc(e=Ha(e,lc)))}function Tc(e){return ka(mc(e=Ha(e,lc)))}function Ec(e){return Ca(mc(e=Ha(e,lc)))}function bc(e){return(0,t._removeServiceInstance)(e.app,"firestore"),e._delete()}function Sc(e,t){const n=mc(e=Ha(e,lc)),r=new uc;return qa(n,e._databaseId,t,r),r}function Nc(e,t){return Va(mc(e=Ha(e,lc)),t).then(t=>t?new ec(e,null,t.query):null)}function _c(e){if(e._initialized||e._terminated)throw new T(v.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}exports.Firestore=lc;class xc{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new T(v.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Dc(){return new xc("__name__")}exports.FieldPath=xc;class Ac{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ac(j.fromBase64String(e))}catch(e){throw new T(v.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Ac(j.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}exports.Bytes=Ac;class kc{constructor(e){this._methodName=e}}exports.FieldValue=kc;class Cc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new T(v.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new T(v.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return L(this._lat,e._lat)||L(this._long,e._long)}}exports.GeoPoint=Cc;const Lc=/^__.*__$/;class Rc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Rt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Lt(e,this.data,t,this.fieldTransforms)}}class Fc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Rt(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Mc(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw g()}}class Oc{constructor(e,t,n,r,s,i){this.settings=e,this.databaseId=t,this.N=n,this.ignoreUndefinedProperties=r,void 0===s&&this.Sa(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Da(){return this.settings.Da}Ca(e){return new Oc(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Na(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Ca({path:n,xa:!1});return r.ka(e),r}$a(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Ca({path:n,xa:!1});return r.Sa(),r}Oa(e){return this.Ca({path:void 0,xa:!0})}Fa(e){return nu(e,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.La)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Sa(){if(this.path)for(let e=0;e<this.path.length;e++)this.ka(this.path.get(e))}ka(e){if(0===e.length)throw this.Fa("Document fields must not be empty");if(Mc(this.Da)&&Lc.test(e))throw this.Fa('Document fields cannot begin and end with "__"')}}class Pc{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.N=n||Di(e)}Ba(e,t,n,r=!1){return new Oc({Da:e,methodName:t,La:n,path:$.emptyPath(),xa:!1,Ma:r},this.databaseId,this.N,this.ignoreUndefinedProperties)}}function qc(e){const t=e._freezeSettings(),n=Di(e._databaseId);return new Pc(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Vc(e,t,n,r,s,i={}){const o=e.Ba(i.merge||i.mergeFields?2:0,t,n,s);Xc("Data must be an object, but it was:",o,r);const a=Yc(r,o);let c,u;if(i.merge)c=new z(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const s=Zc(t,r,n);if(!o.contains(s))throw new T(v.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);ru(e,s)||e.push(s)}c=new z(e),u=o.fieldTransforms.filter(e=>c.covers(e.field))}else c=null,u=o.fieldTransforms;return new Rc(new we(a),c,u)}class Uc extends kc{_toFieldTransform(e){if(2!==e.Da)throw 1===e.Da?e.Fa(`${this._methodName}() can only appear at the top level of your update data`):e.Fa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Uc}}function Bc(e,t,n){return new Oc({Da:3,La:t.settings.La,methodName:e._methodName,xa:n},t.databaseId,t.N,t.ignoreUndefinedProperties)}class Kc extends kc{_toFieldTransform(e){return new Tt(e.path,new ft)}isEqual(e){return e instanceof Kc}}class $c extends kc{constructor(e,t){super(e),this.Ua=t}_toFieldTransform(e){const t=Bc(this,e,!0),n=this.Ua.map(e=>Wc(e,t)),r=new mt(n);return new Tt(e.path,r)}isEqual(e){return this===e}}class zc extends kc{constructor(e,t){super(e),this.Ua=t}_toFieldTransform(e){const t=Bc(this,e,!0),n=this.Ua.map(e=>Wc(e,t)),r=new gt(n);return new Tt(e.path,r)}isEqual(e){return this===e}}class Gc extends kc{constructor(e,t){super(e),this.qa=t}_toFieldTransform(e){const t=new wt(e.N,ct(e.N,this.qa));return new Tt(e.path,t)}isEqual(e){return this===e}}function jc(e,t,n,r){const i=e.Ba(1,t,n);Xc("Data must be an object, but it was:",i,r);const o=[],a=we.empty();q(r,(e,r)=>{const c=tu(t,e,n);r=(0,s.getModularInstance)(r);const u=i.$a(c);if(r instanceof Uc)o.push(c);else{const e=Wc(r,u);null!=e&&(o.push(c),a.set(c,e))}});const c=new z(o);return new Fc(a,c,i.fieldTransforms)}function Qc(e,t,n,r,i,o){const a=e.Ba(1,t,n),c=[Zc(t,r,n)],u=[i];if(o.length%2!=0)throw new T(v.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let s=0;s<o.length;s+=2)c.push(Zc(t,o[s])),u.push(o[s+1]);const h=[],l=we.empty();for(let f=c.length-1;f>=0;--f)if(!ru(h,c[f])){const e=c[f];let t=u[f];t=(0,s.getModularInstance)(t);const n=a.$a(e);if(t instanceof Uc)h.push(e);else{const r=Wc(t,n);null!=r&&(h.push(e),l.set(e,r))}}const d=new z(h);return new Fc(l,d,a.fieldTransforms)}function Hc(e,t,n,r=!1){return Wc(n,e.Ba(r?4:3,t))}function Wc(e,t){if(Jc(e=(0,s.getModularInstance)(e)))return Xc("Unsupported field value:",t,e),Yc(e,t);if(e instanceof kc)return function(e,t){if(!Mc(t.Da))throw t.Fa(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Fa(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xa&&4!==t.Da)throw t.Fa("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const s of e){let e=Wc(s,t.Oa(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,s.getModularInstance)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return ct(t.N,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=M.fromDate(e);return{timestampValue:wn(t.N,n)}}if(e instanceof M){const n=new M(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:wn(t.N,n)}}if(e instanceof Cc)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Ac)return{bytesValue:In(t.N,e._byteString)};if(e instanceof Za){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Fa(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:En(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Fa(`Unsupported field value: ${Qa(e)}`)}(e,t)}function Yc(e,t){const n={};return V(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):q(e,(e,r)=>{const s=Wc(r,t.Na(e));null!=s&&(n[e]=s)}),{mapValue:{fields:n}}}function Jc(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof M||e instanceof Cc||e instanceof Ac||e instanceof Za||e instanceof kc)}function Xc(e,t,n){if(!Jc(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Qa(n);throw"an object"===r?t.Fa(e+" a custom object"):t.Fa(e+" "+r)}}function Zc(e,t,n){if((t=(0,s.getModularInstance)(t))instanceof xc)return t._internalPath;if("string"==typeof t)return tu(e,t);throw nu("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}const eu=new RegExp("[~\\*/\\[\\]]");function tu(e,t,n){if(t.search(eu)>=0)throw nu(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new xc(...t.split("."))._internalPath}catch(r){throw nu(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function nu(e,t,n,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new T(v.INVALID_ARGUMENT,a+e+c)}function ru(e,t){return e.some(e=>e.isEqual(t))}class su{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Za(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new iu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ou("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class iu extends su{data(){return super.data()}}function ou(e,t){return"string"==typeof t?tu(e,t):t instanceof xc?t._internalPath:t._delegate._internalPath}class au{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}exports.SnapshotMetadata=au;class cu extends su{constructor(e,t,n,r,s,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new uu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(ou("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}exports.DocumentSnapshot=cu;class uu extends cu{data(e={}){return super.data(e)}}exports.QueryDocumentSnapshot=uu;class hu{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new au(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new uu(this._firestore,this._userDataWriter,n.key,n,new au(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new T(v.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>({type:"added",doc:new uu(e._firestore,e._userDataWriter,n.doc.key,n.doc,new au(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new uu(e._firestore,e._userDataWriter,t.doc.key,t.doc,new au(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,i=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(i=(n=n.add(t.doc)).indexOf(t.doc.key)),{type:lu(t.type),doc:r,oldIndex:s,newIndex:i}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function lu(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return g()}}function du(e,t){return e instanceof cu&&t instanceof cu?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof hu&&t instanceof hu&&e._firestore===t._firestore&&oc(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function fu(e){if(Qe(e)&&0===e.explicitOrderBy.length)throw new T(v.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}exports.QuerySnapshot=hu;class mu{}function pu(e,...t){for(const n of t)e=n._apply(e);return e}exports.QueryConstraint=mu;class gu extends mu{constructor(e,t,n){super(),this.Ka=e,this.ja=t,this.Qa=n,this.type="where"}_apply(e){const t=qc(e.firestore),n=function(e,t,n,r,s,i,o){let a;if(s.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new T(v.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on FieldPath.documentId().`);if("in"===i||"not-in"===i){Cu(o,i);const t=[];for(const n of o)t.push(ku(r,e,n));a={arrayValue:{values:t}}}else a=ku(r,e,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Cu(o,i),a=Hc(n,"where",o,"in"===i||"not-in"===i);const c=xe.create(s,i,a);return function(e,t){if(t.v()){const n=We(e);if(null!==n&&!n.isEqual(t.field))throw new T(v.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${t.field.toString()}'`);const r=He(e);null!==r&&Lu(e,t.field,r)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(t.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==n)throw n===t.op?new T(v.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new T(v.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}(e,c),c}(e._query,0,t,e.firestore._databaseId,this.Ka,this.ja,this.Qa);return new ec(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new $e(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}function yu(e,t,n){const r=t,s=ou("where",e);return new gu(s,r,n)}class wu extends mu{constructor(e,t){super(),this.Ka=e,this.Wa=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new T(v.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new T(v.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Ve(t,n);return function(e,t){if(null===He(e)){const n=We(e);null!==n&&Lu(e,n,t.field)}}(e,r),r}(e._query,this.Ka,this.Wa);return new ec(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new $e(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Iu(e,t="asc"){const n=t,r=ou("orderBy",e);return new wu(r,n)}class vu extends mu{constructor(e,t,n){super(),this.type=e,this.Ga=t,this.za=n}_apply(e){return new ec(e.firestore,e.converter,Ze(e._query,this.Ga,this.za))}}function Tu(e){return Wa("limit",e),new vu("limit",e,"F")}function Eu(e){return Wa("limitToLast",e),new vu("limitToLast",e,"L")}class bu extends mu{constructor(e,t,n){super(),this.type=e,this.Ha=t,this.Ja=n}_apply(e){const t=Au(e,this.type,this.Ha,this.Ja);return new ec(e.firestore,e.converter,function(e,t){return new $e(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function Su(...e){return new bu("startAt",e,!0)}function Nu(...e){return new bu("startAfter",e,!1)}class _u extends mu{constructor(e,t,n){super(),this.type=e,this.Ha=t,this.Ja=n}_apply(e){const t=Au(e,this.type,this.Ha,this.Ja);return new ec(e.firestore,e.converter,function(e,t){return new $e(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function xu(...e){return new _u("endBefore",e,!0)}function Du(...e){return new _u("endAt",e,!1)}function Au(e,t,n,r){if(n[0]=(0,s.getModularInstance)(n[0]),n[0]instanceof su)return function(e,t,n,r,s){if(!r)throw new T(v.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const i=[];for(const o of Je(e))if(o.field.isKeyField())i.push(le(t,r.key));else{const e=r.data.field(o.field);if(J(e))throw new T(v.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new T(v.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}i.push(e)}return new Pe(i,s)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const s=qc(e.firestore);return function(e,t,n,r,s,i){const o=e.explicitOrderBy;if(s.length>o.length)throw new T(v.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let c=0;c<s.length;c++){const i=s[c];if(o[c].field.isKeyField()){if("string"!=typeof i)throw new T(v.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof i}`);if(!Ye(e)&&-1!==i.indexOf("/"))throw new T(v.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${i}' contains a slash.`);const n=e.path.child(B.fromString(i));if(!re.isDocumentKey(n))throw new T(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const s=new re(n);a.push(le(t,s))}else{const e=Hc(n,r,i);a.push(e)}}return new Pe(a,i)}(e._query,e.firestore._databaseId,s,t,n,r)}}function ku(e,t,n){if("string"==typeof(n=(0,s.getModularInstance)(n))){if(""===n)throw new T(v.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ye(t)&&-1!==n.indexOf("/"))throw new T(v.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(B.fromString(n));if(!re.isDocumentKey(r))throw new T(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return le(e,new re(r))}if(n instanceof Za)return le(e,n._key);throw new T(v.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${Qa(n)}.`)}function Cu(e,t){if(!Array.isArray(e)||0===e.length)throw new T(v.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new T(v.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function Lu(e,t,n){if(!n.isEqual(t))throw new T(v.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class Ru{convertValue(e,t="none"){switch(se(e)){case 0:return null;case 1:return e.booleanValue;case 2:return W(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Y(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw g()}}convertObject(e,t){const n={};return q(e.fields,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new Cc(W(e.latitude),W(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=X(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Z(e));default:return null}}convertTimestamp(e){const t=H(e);return new M(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=B.fromString(e);y(Jn(n));const r=new Ba(n.get(1),n.get(3)),s=new re(n.popFirst(5));return r.isEqual(t)||f(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Fu(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}exports.AbstractUserDataWriter=Ru;class Mu extends Ru{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ac(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Za(this.firestore,null,t)}}class Ou{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=qc(e)}set(e,t,n){this._verifyNotCommitted();const r=Pu(e,this._firestore),s=Fu(r.converter,t,n),i=Vc(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,n);return this._mutations.push(i.toMutation(r._key,St.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=Pu(e,this._firestore);let o;return o="string"==typeof(t=(0,s.getModularInstance)(t))||t instanceof xc?Qc(this._dataReader,"WriteBatch.update",i._key,t,n,r):jc(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,St.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Pu(e,this._firestore);return this._mutations=this._mutations.concat(new Pt(t._key,St.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new T(v.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Pu(e,t){if((e=(0,s.getModularInstance)(e)).firestore!==t)throw new T(v.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function qu(e){e=Ha(e,Za);const t=Ha(e.firestore,lc);return Ra(mc(t),e._key).then(n=>Xu(t,e,n))}exports.WriteBatch=Ou;class Vu extends Ru{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ac(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Za(this.firestore,null,t)}}function Uu(e){e=Ha(e,Za);const t=Ha(e.firestore,lc),n=mc(t),r=new Vu(t);return La(n,e._key).then(n=>new cu(t,r,e._key,n,new au(null!==n&&n.hasLocalMutations,!0),e.converter))}function Bu(e){e=Ha(e,Za);const t=Ha(e.firestore,lc);return Ra(mc(t),e._key,{source:"server"}).then(n=>Xu(t,e,n))}function Ku(e){e=Ha(e,ec);const t=Ha(e.firestore,lc),n=mc(t),r=new Vu(t);return fu(e._query),Ma(n,e._query).then(n=>new hu(t,r,e,n))}function $u(e){e=Ha(e,ec);const t=Ha(e.firestore,lc),n=mc(t),r=new Vu(t);return Fa(n,e._query).then(n=>new hu(t,r,e,n))}function zu(e){e=Ha(e,ec);const t=Ha(e.firestore,lc),n=mc(t),r=new Vu(t);return Ma(n,e._query,{source:"server"}).then(n=>new hu(t,r,e,n))}function Gu(e,t,n){e=Ha(e,Za);const r=Ha(e.firestore,lc),s=Fu(e.converter,t,n);return Ju(r,[Vc(qc(r),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,St.none())])}function ju(e,t,n,...r){e=Ha(e,Za);const i=Ha(e.firestore,lc),o=qc(i);let a;return Ju(i,[(a="string"==typeof(t=(0,s.getModularInstance)(t))||t instanceof xc?Qc(o,"updateDoc",e._key,t,n,r):jc(o,"updateDoc",e._key,t)).toMutation(e._key,St.exists(!0))])}function Qu(e){return Ju(Ha(e.firestore,lc),[new Pt(e._key,St.none())])}function Hu(e,t){const n=Ha(e.firestore,lc),r=sc(e),s=Fu(e.converter,t);return Ju(n,[Vc(qc(e.firestore),"addDoc",r._key,s,null!==e.converter,{}).toMutation(r._key,St.exists(!1))]).then(()=>r)}function Wu(e,...t){var n,r,i;e=(0,s.getModularInstance)(e);let o={includeMetadataChanges:!1},a=0;"object"!=typeof t[a]||cc(t[a])||(o=t[a],a++);const c={includeMetadataChanges:o.includeMetadataChanges};if(cc(t[a])){const e=t[a];t[a]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[a+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[a+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let u,h,l;if(e instanceof Za)h=Ha(e.firestore,lc),l=Ge(e._key.path),u={next:n=>{t[a]&&t[a](Xu(h,e,n))},error:t[a+1],complete:t[a+2]};else{const n=Ha(e,ec);h=Ha(n.firestore,lc),l=n._query;const r=new Vu(h);u={next:e=>{t[a]&&t[a](new hu(h,r,n,e))},error:t[a+1],complete:t[a+2]},fu(e._query)}return function(e,t,n,r){const s=new ga(u),i=new Eo(t,s,n);return e.asyncQueue.enqueueAndForget(async()=>yo(await Aa(e),i)),()=>{s.Xo(),e.asyncQueue.enqueueAndForget(async()=>wo(await Aa(e),i))}}(mc(h),l,c)}function Yu(e,t){return Oa(mc(e=Ha(e,lc)),cc(t)?t:{next:t})}function Ju(e,t){return function(e,t){const n=new E;return e.asyncQueue.enqueueAndForget(async()=>Oo(await Da(e),t,n)),n.promise}(mc(e),t)}function Xu(e,t,n){const r=n.docs.get(t._key),s=new Vu(e);return new cu(e,s,t._key,r,new au(n.hasPendingWrites,n.fromCache),t.converter)}class Zu extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=qc(e)}get(e){const t=Pu(e,this._firestore),n=new Mu(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return g();const r=e[0];if(r.isFoundDocument())return new su(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new su(this._firestore,n,t._key,null,t.converter);throw g()})}set(e,t,n){const r=Pu(e,this._firestore),s=Fu(r.converter,t,n),i=Vc(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,n);return this._transaction.set(r._key,i),this}update(e,t,n,...r){const i=Pu(e,this._firestore);let o;return o="string"==typeof(t=(0,s.getModularInstance)(t))||t instanceof xc?Qc(this._dataReader,"Transaction.update",i._key,t,n,r):jc(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,o),this}delete(e){const t=Pu(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Pu(e,this._firestore),n=new Vu(this._firestore);return super.get(e).then(e=>new cu(this._firestore,n,t._key,e._document,new au(!1,!1),t.converter))}}function eh(e,t){return Pa(mc(e),n=>t(new Zu(e,n)))}function th(){return new Uc("deleteField")}function nh(){return new Kc("serverTimestamp")}function rh(...e){return new $c("arrayUnion",e)}function sh(...e){return new zc("arrayRemove",e)}function ih(e){return new Gc("increment",e)}function oh(e){return mc(e=Ha(e,lc)),new Ou(e,t=>Ju(e,t))}var ah;exports.Transaction=Zu,function(e){c=e}(t.SDK_VERSION),(0,t._registerComponent)(new n.Component("firestore",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=new lc(n,new _(e.getProvider("auth-internal")));return t=Object.assign({useFetchStreams:!0},t),r._setSettings(t),r},"PUBLIC")),(0,t.registerVersion)(o,"3.1.1",ah),(0,t.registerVersion)(o,"3.1.1","esm2017");
},{"@firebase/app":"Qqsz","@firebase/component":"sLOu","@firebase/logger":"MfMd","@firebase/util":"chA2","@firebase/webchannel-wrapper":"qQDx","process":"pBGv"}],"vHL5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/firestore");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/firestore":"lBbe"}],"Q6BU":[function(require,module,exports) {
var process = require("process");
var e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports._repoManagerDatabaseFromApp=dl,exports._setSDKVersion=l,exports.child=Ca,exports.connectDatabaseEmulator=yl,exports.enableLogging=wl,exports.endAt=Ua,exports.endBefore=Ba,exports.equalTo=ol,exports.get=Sa,exports.getDatabase=ml,exports.goOffline=vl,exports.goOnline=Cl,exports.increment=Il,exports.limitToFirst=Ka,exports.limitToLast=$a,exports.off=La,exports.onChildAdded=Ma,exports.onChildChanged=Aa,exports.onChildMoved=Fa,exports.onChildRemoved=qa,exports.onDisconnect=wa,exports.onValue=Da,exports.orderByChild=Ja,exports.orderByKey=el,exports.orderByPriority=nl,exports.orderByValue=sl,exports.push=Ta,exports.query=al,exports.ref=ya,exports.refFromURL=va,exports.remove=ba,exports.runTransaction=xl,exports.serverTimestamp=kl,exports.set=ka,exports.setPriority=Ia,exports.setWithPriority=Ea,exports.startAfter=Ya,exports.startAt=Va,exports.update=xa,exports._validateWritablePath=exports._validatePathString=exports._TEST_ACCESS_hijackHash=exports._TEST_ACCESS_forceRestClient=exports._ReferenceImpl=exports._QueryParams=exports._QueryImpl=exports.TransactionResult=exports.QueryConstraint=exports.OnDisconnect=exports.Database=exports.DataSnapshot=void 0;var t=require("@firebase/app"),n=require("@firebase/component"),i=require("@firebase/util"),s=require("@firebase/logger");const r="@firebase/database",o="0.12.2";let a="";function l(e){a=e}class h{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,i.stringify)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,i.jsonEval)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class c{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,i.contains)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const u=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new h(t)}}catch(t){}return new c},d=u("localStorage"),p=u("sessionStorage"),_=new s.Logger("@firebase/database"),f=function(){let e=1;return function(){return e++}}(),g=function(e){const t=(0,i.stringToByteArray)(e),n=new i.Sha1;n.update(t);const s=n.digest();return i.base64.encodeByteArray(s)},m=function(...e){let t="";for(let n=0;n<e.length;n++){const s=e[n];Array.isArray(s)||s&&"object"==typeof s&&"number"==typeof s.length?t+=m.apply(null,s):t+="object"==typeof s?(0,i.stringify)(s):s,t+=" "}return t};let y=null,v=!0;const C=function(e,t){(0,i.assert)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(_.logLevel=s.LogLevel.VERBOSE,y=_.log.bind(_),t&&p.set("logging_enabled",!0)):"function"==typeof e?y=e:(y=null,p.remove("logging_enabled"))},w=function(...e){if(!0===v&&(v=!1,null===y&&!0===p.get("logging_enabled")&&C(!0)),y){const t=m.apply(null,e);y(t)}},T=function(e){return function(...t){w(e,...t)}},b=function(...e){const t="FIREBASE INTERNAL ERROR: "+m(...e);_.error(t)},k=function(...e){const t=`FIREBASE FATAL ERROR: ${m(...e)}`;throw _.error(t),new Error(t)},I=function(...e){const t="FIREBASE WARNING: "+m(...e);_.warn(t)},E=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&I("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},x=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},S=function(e){if((0,i.isNodeSdk)()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},P="[MIN_NAME]",N="[MAX_NAME]",R=function(e,t){if(e===t)return 0;if(e===P||t===N)return-1;if(t===P||e===N)return 1;{const n=V(e),i=V(t);return null!==n?null!==i?n-i==0?e.length-t.length:n-i:-1:null!==i?1:e<t?-1:1}},D=function(e,t){return e===t?0:e<t?-1:1},M=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+(0,i.stringify)(t))},A=function(e){if("object"!=typeof e||null===e)return(0,i.stringify)(e);const t=[];for(const i in e)t.push(i);t.sort();let n="{";for(let s=0;s<t.length;s++)0!==s&&(n+=","),n+=(0,i.stringify)(t[s]),n+=":",n+=A(e[t[s]]);return n+="}"},F=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let s=0;s<n;s+=t)s+t>n?i.push(e.substring(s,n)):i.push(e.substring(s,s+t));return i};function q(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const L=function(e){(0,i.assert)(!x(e),"Invalid JSON number");let t,n,s,r,o;0===e?(n=0,s=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(r=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,s=Math.round(e*Math.pow(2,52-r)-Math.pow(2,52))):(n=0,s=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(s%2?1:0),s=Math.floor(s/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse();const l=a.join("");let h="";for(o=0;o<64;o+=8){let e=parseInt(l.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),h+=e}return h.toLowerCase()},O=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},W=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI};function U(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+n);return i.code=e.toUpperCase(),i}const j=new RegExp("^-?(0*)\\d{1,10}$"),B=-2147483648,H=2147483647,V=function(e){if(j.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},z=function(e){try{e()}catch(t){setTimeout(()=>{const e=t.stack||"";throw I("Exception was thrown by user callback.",e),t},Math.floor(0))}},Y=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Q=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};class K{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(e=>this.appCheck=e)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){I(`Provided AppCheck credentials for the app named "${this.appName_}" `+"are invalid. This usually indicates your app was not initialized correctly.")}}class G{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(e=>this.auth_=e)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(e=>e&&"auth/token-not-initialized"===e.code?(w("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',I(e)}}class ${constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}$.OWNER="owner";const X="5",J="v",Z="s",ee="r",te="f",ne=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ie="ls",se="p",re="ac",oe="websocket",ae="long_polling";class le{constructor(e,t,n,i,s=!1,r="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=r,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=d.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&d.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function he(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function ce(e,t,n){let s;if((0,i.assert)("string"==typeof t,"typeof type must == string"),(0,i.assert)("object"==typeof n,"typeof params must == object"),t===oe)s=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==ae)throw new Error("Unknown connection type: "+t);s=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}he(e)&&(n.ns=e.namespace);const r=[];return q(n,(e,t)=>{r.push(e+"="+t)}),s+r.join("&")}class ue{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,i.contains)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,i.deepCopy)(this.counters_)}}const de={},pe={};function _e(e){const t=e.toString();return de[t]||(de[t]=new ue),de[t]}function fe(e,t){const n=e.toString();return pe[n]||(pe[n]=t()),pe[n]}class ge{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&z(()=>{this.onMessage_(e[t])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const me="start",ye="close",ve="pLPCommand",Ce="pRTLPCB",we="id",Te="pw",be="ser",ke="cb",Ie="seg",Ee="ts",xe="d",Se="dframe",Pe=1870,Ne=30,Re=Pe-Ne,De=25e3,Me=3e4;class Ae{constructor(e,t,n,i,s,r,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.transportSessionId=r,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=T(e),this.stats_=_e(t),this.urlFn=(e=>(this.appCheckToken&&(e[re]=this.appCheckToken),ce(t,ae,e)))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ge(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Me)),S(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Fe((...e)=>{const[t,n,i,s,r]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===me)this.id=n,this.password=i;else{if(t!==ye)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,()=>{this.onClosed_()})):this.onClosed_()}},(...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)},()=>{this.onClosed_()},this.urlFn);const e={};e[me]="t",e[be]=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e[ke]=this.scriptTagHolder.uniqueCallbackIdentifier),e[J]=X,this.transportSessionId&&(e[Z]=this.transportSessionId),this.lastSessionId&&(e[ie]=this.lastSessionId),this.applicationId&&(e[se]=this.applicationId),this.appCheckToken&&(e[re]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&ne.test(location.hostname)&&(e[ee]=te);const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ae.forceAllow_=!0}static forceDisallow(){Ae.forceDisallow_=!0}static isAvailable(){return!(0,i.isNodeSdk)()&&(!!Ae.forceAllow_||!Ae.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!O()&&!W())}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,i.stringify)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=(0,i.base64Encode)(t),s=F(n,Re);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,i.isNodeSdk)())return;this.myDisconnFrame=document.createElement("iframe");const n={};n[Se]="t",n[we]=e,n[Te]=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,i.stringify)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Fe{constructor(e,t,n,s){if(this.onDisconnect=n,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,i.isNodeSdk)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=f(),window[ve+this.uniqueCallbackIdentifier]=e,window[Ce+this.uniqueCallbackIdentifier]=t,this.myIFrame=Fe.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(r){w("frame writing exception"),r.stack&&w(r.stack),w(r)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||w("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[we]=this.myID,e[Te]=this.myPW,e[be]=this.currentSerial;let t=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+Ne+n.length<=Pe))break;{const e=this.pendingSegs.shift();n=n+"&"+Ie+i+"="+e.seg+"&"+Ee+i+"="+e.ts+"&"+xe+i+"="+e.d,i++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(n,Math.floor(De));this.addTag(e,()=>{clearTimeout(i),n()})}addTag(e,t){(0,i.isNodeSdk)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const e=i.readyState;e&&"loaded"!==e&&"complete"!==e||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=(()=>{w("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()}),this.myIFrame.doc.body.appendChild(i)}catch(n){}},Math.floor(1))}}const qe=16384,Le=45e3;let Oe=null;"undefined"!=typeof MozWebSocket?Oe=MozWebSocket:"undefined"!=typeof WebSocket&&(Oe=WebSocket);class We{constructor(e,t,n,i,s,r,o){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=T(this.connId),this.stats_=_e(t),this.connURL=We.connectionURL_(t,r,o,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,s){const r={};return r[J]=X,!(0,i.isNodeSdk)()&&"undefined"!=typeof location&&location.hostname&&ne.test(location.hostname)&&(r[ee]=te),t&&(r[Z]=t),n&&(r[ie]=n),s&&(r[re]=s),ce(e,oe,r)}open(t,n){this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,d.set("previous_websocket_failure",!0);try{if((0,i.isNodeSdk)()){const t=this.nodeAdmin?"AdminNode":"Node",n={headers:{"User-Agent":`Firebase/${X}/${a}/${e.platform}/${t}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(n.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(n.headers["X-Firebase-AppCheck"]=this.appCheckToken);const i=e.env,s=0===this.connURL.indexOf("wss://")?i.HTTPS_PROXY||i.https_proxy:i.HTTP_PROXY||i.http_proxy;s&&(n.proxy={origin:s}),this.mySock=new Oe(this.connURL,[],n)}else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Oe(this.connURL,[],e)}}catch(s){this.log_("Error instantiating WebSocket.");const e=s.message||s.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=(()=>{this.log_("Websocket connected."),this.everConnected_=!0}),this.mySock.onclose=(()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()}),this.mySock.onmessage=(e=>{this.handleIncomingFrame(e)}),this.mySock.onerror=(e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()})}start(){}static forceDisallow(){We.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Oe&&!We.forceDisallow_}static previouslyFailed(){return d.isInMemoryStorage||!0===d.get("previous_websocket_failure")}markConnectionHealthy(){d.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=(0,i.jsonEval)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,i.assert)(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=(0,i.stringify)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=F(t,qe);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Le))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}We.responsesRequiredToBeHealthy=2,We.healthyTimeout=3e4;class Ue{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Ae,We]}initTransports_(e){const t=We&&We.isAvailable();let n=t&&!We.previouslyFailed();if(e.webSocketOnly&&(t||I("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[We];else{const e=this.transports_=[];for(const t of Ue.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}const je=6e4,Be=5e3,He=10240,Ve=102400,ze="t",Ye="d",Qe="s",Ke="r",Ge="e",$e="o",Xe="a",Je="n",Ze="p",et="h";class tt{constructor(e,t,n,i,s,r,o,a,l,h){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=r,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=T("c:"+this.id+":"),this.transportManager_=new Ue(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Q(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Ve?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>He?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ze in e){const t=e[ze];t===Xe?this.upgradeIfSecondaryHealthy_():t===Ke?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):t===$e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=M("t",e),n=M("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Ze,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Xe,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Je,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=M("t",e),n=M("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=M(ze,e);if(Ye in e){const n=e[Ye];if(t===et)this.onHandshake_(n);else if(t===Je){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Qe?this.onConnectionShutdown_(n):t===Ke?this.onReset_(n):t===Ge?b("Server Error: "+n):t===$e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):b("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),X!==n&&I("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Q(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(je))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Q(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Be))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Ze,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(d.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class nt{put(e,t,n,i){}merge(e,t,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class it{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,i.assert)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const i=this.getInitialEvent(e);i&&t.apply(n,i)}off(e,t,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!n||n===i[s].context))return void i.splice(s,1)}validateEventType_(e){(0,i.assert)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class st extends it{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,i.isMobileCordova)()||(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new st}getInitialEvent(e){return(0,i.assert)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const rt=32,ot=768;class at{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function lt(){return new at("")}function ht(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ct(e){return e.pieces_.length-e.pieceNum_}function ut(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new at(e.pieces_,t)}function dt(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function pt(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}function _t(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function ft(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new at(t,0)}function gt(e,t){const n=[];for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);if(t instanceof at)for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new at(n,0)}function mt(e){return e.pieceNum_>=e.pieces_.length}function yt(e,t){const n=ht(e),i=ht(t);if(null===n)return t;if(n===i)return yt(ut(e),ut(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function vt(e,t){const n=_t(e,0),i=_t(t,0);for(let s=0;s<n.length&&s<i.length;s++){const e=R(n[s],i[s]);if(0!==e)return e}return n.length===i.length?0:n.length<i.length?-1:1}function Ct(e,t){if(ct(e)!==ct(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function wt(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(ct(e)>ct(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class Tt{constructor(e,t){this.errorPrefix_=t,this.parts_=_t(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=(0,i.stringLength)(this.parts_[n]);It(this)}}function bt(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=(0,i.stringLength)(t),It(e)}function kt(e){const t=e.parts_.pop();e.byteLength_-=(0,i.stringLength)(t),e.parts_.length>0&&(e.byteLength_-=1)}function It(e){if(e.byteLength_>ot)throw new Error(e.errorPrefix_+"has a key path longer than "+ot+" bytes ("+e.byteLength_+").");if(e.parts_.length>rt)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+rt+") or object contains a cycle "+Et(e))}function Et(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class xt extends it{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))},!1)}static getInstance(){return new xt}getInitialEvent(e){return(0,i.assert)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const St=1e3,Pt=3e5,Nt=3e3,Rt=3e4,Dt=1.3,Mt=3e4,At="server_kill",Ft=3;class qt extends nt{constructor(e,t,n,s,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=s,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=qt.nextPersistentConnectionId_++,this.log_=T("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=St,this.maxReconnectDelay_=Pt,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,i.isNodeSdk)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");xt.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&st.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const s=++this.requestNumber_,r={r:s,a:e,b:t};this.log_((0,i.stringify)(r)),(0,i.assert)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[s]=n)}get(e){this.initConnection_();const t=new i.Deferred,n={p:e._path.toString(),q:e._queryObject},s={action:"g",request:n,onComplete:e=>{const i=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,i,!1,null),t.resolve(i)):t.reject(i)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const e=this.outstandingGets_[r];void 0!==e&&s===e&&(delete this.outstandingGets_[r],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+r+" timed out on connection"),t.reject(new Error("Client is offline.")))},Nt),this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,s){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),(0,i.assert)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,i.assert)(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:t,query:e,tag:n};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)})}sendListen_(e){const t=e.query,n=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+n+" for "+i);const s={p:n};e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest("q",s,s=>{const r=s.d,o=s.s;qt.warnOnListenWarnings_(r,t),(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",s),"ok"!==o&&this.removeListen_(n,i),e.onComplete&&e.onComplete(o,r))})}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&(0,i.contains)(e,"w")){const n=(0,i.safeGet)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();I("Using an unspecified index. Your data will be downloaded and "+`filtered on the client. Consider adding ${e} at `+`${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||(0,i.isAdmin)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Rt)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=(0,i.isValidFormat)(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,t=>{const n=t.s,i=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){const n=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+s),(0,i.assert)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,s)&&this.connected_&&this.sendUnlisten_(n,s,e._queryObject,t)}sendUnlisten_(e,t,n,i){this.log_("Unlisten on "+e+" for "+t);const s={p:e};i&&(s.q=n,s.t=i),this.sendRequest("n",s)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,i){const s={p:t,d:n};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,e=>{i&&setTimeout(()=>{i(e.s,e.d)},Math.floor(0))})}put(e,t,n,i){this.putInternal("p",e,t,n,i)}merge(e,t,n,i){this.putInternal("m",e,t,n,i)}putInternal(e,t,n,i,s){this.initConnection_();const r={p:t,d:n};void 0!==s&&(r.h=s),this.outstandingPuts_.push({action:e,request:r,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,i.stringify)(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):b("Unrecognized action received from server: "+(0,i.stringify)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,i.assert)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=St,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=St,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>Mt&&(this.reconnectDelay_=St),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Dt)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+qt.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,n())},h=function(e){(0,i.assert)(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:l,sendRequest:h};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[i,h]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);o?w("getToken() completed but was canceled"):(w("getToken() completed. Creating connection."),this.authToken_=i&&i.accessToken,this.appCheckToken_=h&&h.token,a=new tt(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,e=>{I(e+" ("+this.repoInfo_.toString()+")"),this.interrupt(At)},r))}catch(b){this.log_("Failed to get token: "+b),o||(this.repoInfo_.nodeAdmin&&I(b),l())}}}interrupt(e){w("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){w("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,i.isEmpty)(this.interruptReasons_)&&(this.reconnectDelay_=St,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map(e=>A(e)).join("$"):"default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const n=new at(e).toString();let i;if(this.listens.has(n)){const e=this.listens.get(n);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,t){w("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Ft&&(this.reconnectDelay_=Rt,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){w("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Ft&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";(0,i.isNodeSdk)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+a.replace(/\./g,"-")]=1,(0,i.isMobileCordova)()?e["framework.cordova"]=1:(0,i.isReactNative)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=st.getInstance().currentlyOnline();return(0,i.isEmpty)(this.interruptReasons_)&&e}}qt.nextPersistentConnectionId_=0,qt.nextConnectionId_=0;class Lt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Lt(e,t)}}class Ot{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Lt(P,e),i=new Lt(P,t);return 0!==this.compare(n,i)}minPost(){return Lt.MIN}}let Wt;class Ut extends Ot{static get __EMPTY_NODE(){return Wt}static set __EMPTY_NODE(e){Wt=e}compare(e,t){return R(e.name,t.name)}isDefinedOn(e){throw(0,i.assertionError)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Lt.MIN}maxPost(){return new Lt(N,Wt)}makePost(e,t){return(0,i.assert)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Lt(e,Wt)}toString(){return".key"}}const jt=new Ut;class Bt{constructor(e,t,n,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(e=e,r=t?n(e.key,t):1,i&&(r*=-1),r<0)e=this.isReverse_?e.left:e.right;else{if(0===r){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Ht{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=null!=n?n:Ht.RED,this.left=null!=i?i:zt.EMPTY_NODE,this.right=null!=s?s:zt.EMPTY_NODE}copy(e,t,n,i,s){return new Ht(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return(i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n))).fixUp_()}removeMin_(){if(this.left.isEmpty())return zt.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}remove(e,t){let n,i;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return zt.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Ht.RED=!0,Ht.BLACK=!1;class Vt{copy(e,t,n,i,s){return this}insert(e,t,n){return new Ht(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class zt{constructor(e,t=zt.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new zt(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ht.BLACK,null,null))}remove(e){return new zt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ht.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,i=null;for(;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Bt(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Bt(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Bt(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Bt(this.root_,null,this.comparator_,!0,e)}}function Yt(e,t){return R(e.name,t.name)}function Qt(e,t){return R(e,t)}let Kt;function Gt(e){Kt=e}zt.EMPTY_NODE=new Vt;const $t=function(e){return"number"==typeof e?"number:"+L(e):"string:"+e},Xt=function(e){if(e.isLeafNode()){const t=e.val();(0,i.assert)("string"==typeof t||"number"==typeof t||"object"==typeof t&&(0,i.contains)(t,".sv"),"Priority must be a string or number.")}else(0,i.assert)(e===Kt||e.isEmpty(),"priority of unexpected type.");(0,i.assert)(e===Kt||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Jt,Zt,en;class tn{constructor(e,t=tn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,(0,i.assert)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Xt(this.priorityNode_)}static set __childrenNodeConstructor(e){Jt=e}static get __childrenNodeConstructor(){return Jt}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new tn(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:tn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return mt(e)?this:".priority"===ht(e)?this.priorityNode_:tn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:tn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=ht(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:((0,i.assert)(".priority"!==n||1===ct(e),".priority must be the last token in a path"),this.updateImmediateChild(n,tn.__childrenNodeConstructor.EMPTY_NODE.updateChild(ut(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+$t(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?L(this.value_):this.value_,this.lazyHash_=g(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===tn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof tn.__childrenNodeConstructor?-1:((0,i.assert)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,s=tn.VALUE_TYPE_ORDER.indexOf(t),r=tn.VALUE_TYPE_ORDER.indexOf(n);return(0,i.assert)(s>=0,"Unknown leaf type: "+t),(0,i.assert)(r>=0,"Unknown leaf type: "+n),s===r?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}function nn(e){Zt=e}function sn(e){en=e}tn.VALUE_TYPE_ORDER=["object","boolean","number","string"];class rn extends Ot{compare(e,t){const n=e.node.getPriority(),i=t.node.getPriority(),s=n.compareTo(i);return 0===s?R(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Lt.MIN}maxPost(){return new Lt(N,new tn("[PRIORITY-POST]",en))}makePost(e,t){const n=Zt(e);return new Lt(t,new tn("[PRIORITY-POST]",n))}toString(){return".priority"}}const on=new rn,an=Math.log(2);class ln{constructor(e){this.count=(e=>parseInt(Math.log(e)/an,10))(e+1),this.current_=this.count-1;const t=(e=>parseInt(Array(e+1).join("1"),2))(this.count);this.bits_=e+1&t}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const hn=function(e,t,n,i){e.sort(t);const s=function(t,i){const r=i-t;let o,a;if(0===r)return null;if(1===r)return o=e[t],a=n?n(o):o,new Ht(a,o.node,Ht.BLACK,null,null);{const l=parseInt(r/2,10)+t,h=s(t,l),c=s(l+1,i);return o=e[l],a=n?n(o):o,new Ht(a,o.node,Ht.BLACK,h,c)}},r=function(t){let i=null,r=null,o=e.length;const a=function(t,i){const r=o-t,a=o;o-=t;const h=s(r+1,a),c=e[r],u=n?n(c):c;l(new Ht(u,c.node,i,null,h))},l=function(e){i?(i.left=e,i=e):(r=e,i=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));n?a(i,Ht.BLACK):(a(i,Ht.BLACK),a(i,Ht.RED))}return r}(new ln(e.length));return new zt(i||t,r)};let cn;const un={};class dn{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,i.assert)(un&&on,"ChildrenNode.ts has not been loaded"),cn=cn||new dn({".priority":un},{".priority":on})}get(e){const t=(0,i.safeGet)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof zt?t:null}hasIndex(e){return(0,i.contains)(this.indexSet_,e.toString())}addIndex(e,t){(0,i.assert)(e!==jt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let s=!1;const r=t.getIterator(Lt.Wrap);let o,a=r.getNext();for(;a;)s=s||e.isDefinedOn(a.node),n.push(a),a=r.getNext();o=s?hn(n,e.getCompare()):un;const l=e.toString(),h=Object.assign({},this.indexSet_);h[l]=e;const c=Object.assign({},this.indexes_);return c[l]=o,new dn(c,h)}addToIndexes(e,t){const n=(0,i.map)(this.indexes_,(n,s)=>{const r=(0,i.safeGet)(this.indexSet_,s);if((0,i.assert)(r,"Missing index implementation for "+s),n===un){if(r.isDefinedOn(e.node)){const n=[],i=t.getIterator(Lt.Wrap);let s=i.getNext();for(;s;)s.name!==e.name&&n.push(s),s=i.getNext();return n.push(e),hn(n,r.getCompare())}return un}{const i=t.get(e.name);let s=n;return i&&(s=s.remove(new Lt(e.name,i))),s.insert(e,e.node)}});return new dn(n,this.indexSet_)}removeFromIndexes(e,t){const n=(0,i.map)(this.indexes_,n=>{if(n===un)return n;{const i=t.get(e.name);return i?n.remove(new Lt(e.name,i)):n}});return new dn(n,this.indexSet_)}}let pn;class _n{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Xt(this.priorityNode_),this.children_.isEmpty()&&(0,i.assert)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return pn||(pn=new _n(new zt(Qt),null,dn.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||pn}updatePriority(e){return this.children_.isEmpty()?this:new _n(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?pn:t}}getChild(e){const t=ht(e);return null===t?this:this.getImmediateChild(t).getChild(ut(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if((0,i.assert)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Lt(e,t);let i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(n,this.children_));const r=i.isEmpty()?pn:this.priorityNode_;return new _n(i,r,s)}}updateChild(e,t){const n=ht(e);if(null===n)return t;{(0,i.assert)(".priority"!==ht(e)||1===ct(e),".priority must be the last token in a path");const s=this.getImmediateChild(n).updateChild(ut(e),t);return this.updateImmediateChild(n,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,i=0,s=!0;if(this.forEachChild(on,(r,o)=>{t[r]=o.val(e),n++,s&&_n.INTEGER_REGEXP_.test(r)?i=Math.max(i,Number(r)):s=!1}),!e&&s&&i<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+$t(this.getPriority().val())+":"),this.forEachChild(on,(t,n)=>{const i=n.hash();""!==i&&(e+=":"+t+":"+i)}),this.lazyHash_=""===e?"":g(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new Lt(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Lt(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Lt(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal(e=>t(e.name,e.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,e=>e);{const n=this.children_.getIteratorFrom(e.name,Lt.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,e=>e);{const n=this.children_.getReverseIteratorFrom(e.name,Lt.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===gn?-1:0}withIndex(e){if(e===jt||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new _n(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===jt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(on),n=t.getIterator(on);let i=e.getNext(),s=n.getNext();for(;i&&s;){if(i.name!==s.name||!i.node.equals(s.node))return!1;i=e.getNext(),s=n.getNext()}return null===i&&null===s}return!1}return!1}}resolveIndex_(e){return e===jt?null:this.indexMap_.get(e.toString())}}_n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class fn extends _n{constructor(){super(new zt(Qt),_n.EMPTY_NODE,dn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return _n.EMPTY_NODE}isEmpty(){return!1}}const gn=new fn;Object.defineProperties(Lt,{MIN:{value:new Lt(P,_n.EMPTY_NODE)},MAX:{value:new Lt(N,gn)}}),Ut.__EMPTY_NODE=_n.EMPTY_NODE,tn.__childrenNodeConstructor=_n,Gt(gn),sn(gn);const mn=!0;function yn(e,t=null){if(null===e)return _n.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),(0,i.assert)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new tn(e,yn(t))}if(e instanceof Array||!mn){let n=_n.EMPTY_NODE;return q(e,(t,s)=>{if((0,i.contains)(e,t)&&"."!==t.substring(0,1)){const e=yn(s);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}}),n.updatePriority(yn(t))}{const n=[];let i=!1;if(q(e,(e,t)=>{if("."!==e.substring(0,1)){const s=yn(t);s.isEmpty()||(i=i||!s.getPriority().isEmpty(),n.push(new Lt(e,s)))}}),0===n.length)return _n.EMPTY_NODE;const s=hn(n,Yt,e=>e.name,Qt);if(i){const e=hn(n,on.getCompare());return new _n(s,yn(t),new dn({".priority":e},{".priority":on}))}return new _n(s,yn(t),dn.Default)}}nn(yn);class vn extends Ot{constructor(e){super(),this.indexPath_=e,(0,i.assert)(!mt(e)&&".priority"!==ht(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),i=this.extractChild(t.node),s=n.compareTo(i);return 0===s?R(e.name,t.name):s}makePost(e,t){const n=yn(e),i=_n.EMPTY_NODE.updateChild(this.indexPath_,n);return new Lt(t,i)}maxPost(){const e=_n.EMPTY_NODE.updateChild(this.indexPath_,gn);return new Lt(N,e)}toString(){return _t(this.indexPath_,0).join("/")}}class Cn extends Ot{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?R(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Lt.MIN}maxPost(){return Lt.MAX}makePost(e,t){const n=yn(e);return new Lt(t,n)}toString(){return".value"}}const wn=new Cn,Tn="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",bn="-",kn="z",In=786,En=function(){let e=0;const t=[];return function(n){const s=n===e;let r;e=n;const o=new Array(8);for(r=7;r>=0;r--)o[r]=Tn.charAt(n%64),n=Math.floor(n/64);(0,i.assert)(0===n,"Cannot push at time == 0");let a=o.join("");if(s){for(r=11;r>=0&&63===t[r];r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)a+=Tn.charAt(t[r]);return(0,i.assert)(20===a.length,"nextPushId: Length should be 20."),a}}(),xn=function(e){if("2147483647"===e)return"-";const t=V(e);if(null!=t)return""+(t+1);const n=new Array(e.length);for(let o=0;o<n.length;o++)n[o]=e.charAt(o);if(n.length<786)return n.push("-"),n.join("");let i=n.length-1;for(;i>=0&&"z"===n[i];)i--;if(-1===i)return N;const s=n[i],r=Tn.charAt(Tn.indexOf(s)+1);return n[i]=r,n.slice(0,i+1).join("")},Sn=function(e){if("-2147483648"===e)return P;const t=V(e);if(null!=t)return""+(t-1);const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e.charAt(i);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=Tn.charAt(Tn.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function Pn(e){return{type:"value",snapshotNode:e}}function Nn(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Rn(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Dn(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}function Mn(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}class An{constructor(e){this.index_=e}updateChild(e,t,n,s,r,o){(0,i.assert)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(s).equals(n.getChild(s))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(Rn(t,a)):(0,i.assert)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Nn(t,n)):o.trackChildChange(Dn(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(on,(e,i)=>{t.hasChild(e)||n.trackChildChange(Rn(e,i))}),t.isLeafNode()||t.forEachChild(on,(t,i)=>{if(e.hasChild(t)){const s=e.getImmediateChild(t);s.equals(i)||n.trackChildChange(Dn(t,i,s))}else n.trackChildChange(Nn(t,i))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?_n.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Fn{constructor(e){this.indexedFilter_=new An(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Fn.getStartPost_(e),this.endPost_=Fn.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,i,s,r){return this.matches(new Lt(t,n))||(n=_n.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,i,s,r)}updateFullNode(e,t,n){t.isLeafNode()&&(t=_n.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(_n.EMPTY_NODE);const s=this;return t.forEachChild(on,(e,t)=>{s.matches(new Lt(e,t))||(i=i.updateImmediateChild(e,_n.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class qn{constructor(e){this.rangedFilter_=new Fn(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,i,s,r){return this.rangedFilter_.matches(new Lt(t,n))||(n=_n.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,i,s,r):this.fullLimitUpdateChild_(e,t,n,s,r)}updateFullNode(e,t,n){let i;if(t.isLeafNode()||t.isEmpty())i=_n.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;i=_n.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();let s;if(!(s=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0))break;i=i.updateImmediateChild(t.name,t.node),n++}}else{let e,n,s,r;if(i=(i=t.withIndex(this.index_)).updatePriority(_n.EMPTY_NODE),this.reverse_){r=i.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();s=((e,n)=>t(n,e))}else r=i.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),s=this.index_.getCompare();let o=0,a=!1;for(;r.hasNext();){const t=r.getNext();!a&&s(e,t)<=0&&(a=!0),a&&o<this.limit_&&s(t,n)<=0?o++:i=i.updateImmediateChild(t.name,_n.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,s,r){let o;if(this.reverse_){const e=this.index_.getCompare();o=((t,n)=>e(n,t))}else o=this.index_.getCompare();const a=e;(0,i.assert)(a.numChildren()===this.limit_,"");const l=new Lt(t,n),h=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),c=this.rangedFilter_.matches(l);if(a.hasChild(t)){const e=a.getImmediateChild(t);let i=s.getChildAfterChild(this.index_,h,this.reverse_);for(;null!=i&&(i.name===t||a.hasChild(i.name));)i=s.getChildAfterChild(this.index_,i,this.reverse_);const u=null==i?1:o(i,l);if(c&&!n.isEmpty()&&u>=0)return null!=r&&r.trackChildChange(Dn(t,n,e)),a.updateImmediateChild(t,n);{null!=r&&r.trackChildChange(Rn(t,e));const n=a.updateImmediateChild(t,_n.EMPTY_NODE);return null!=i&&this.rangedFilter_.matches(i)?(null!=r&&r.trackChildChange(Nn(i.name,i.node)),n.updateImmediateChild(i.name,i.node)):n}}return n.isEmpty()?e:c&&o(h,l)>=0?(null!=r&&(r.trackChildChange(Rn(h.name,h.node)),r.trackChildChange(Nn(t,n))),a.updateImmediateChild(t,n).updateImmediateChild(h.name,_n.EMPTY_NODE)):e}}class Ln{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=on}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,i.assert)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,i.assert)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:P}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,i.assert)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,i.assert)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:N}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,i.assert)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===on}copy(){const e=new Ln;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function On(e){return e.loadsAllData()?new An(e.getIndex()):e.hasLimit()?new qn(e):new Fn(e)}function Wn(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}function Un(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}function jn(e,t,n){const i=e.copy();return i.startSet_=!0,void 0===t&&(t=null),i.indexStartValue_=t,null!=n?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function Bn(e,t,n){let i;if(e.index_===jt)"string"==typeof t&&(t=xn(t)),i=jn(e,t,n);else{let s;i=jn(e,t,s=null==n?N:xn(n))}return i.startAfterSet_=!0,i}function Hn(e,t,n){const i=e.copy();return i.endSet_=!0,void 0===t&&(t=null),i.indexEndValue_=t,void 0!==n?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function Vn(e,t,n){let i,s;return e.index_===jt?("string"==typeof t&&(t=Sn(t)),s=Hn(e,t,n)):s=Hn(e,t,i=null==n?P:Sn(n)),s.endBeforeSet_=!0,s}function zn(e,t){const n=e.copy();return n.index_=t,n}function Yn(e){const t={};if(e.isDefault())return t;let n;return e.index_===on?n="$priority":e.index_===wn?n="$value":e.index_===jt?n="$key":((0,i.assert)(e.index_ instanceof vn,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=(0,i.stringify)(n),e.startSet_&&(t.startAt=(0,i.stringify)(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+(0,i.stringify)(e.indexStartName_))),e.endSet_&&(t.endAt=(0,i.stringify)(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+(0,i.stringify)(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Qn(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==on&&(t.i=e.index_.toString()),t}exports._QueryParams=Ln;class Kn extends nt{constructor(e,t,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=T("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,i.assert)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,s){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=Kn.getListenId_(e,n),a={};this.listens_[o]=a;const l=Yn(e._queryParams);this.restRequest_(r+".json",l,(e,t)=>{let l=t;if(404===e&&(l=null,e=null),null===e&&this.onDataUpdate_(r,l,!1,n),(0,i.safeGet)(this.listens_,o)===a){let t;s(t=e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}})}unlisten(e,t){const n=Kn.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Yn(e._queryParams),n=e._path.toString(),s=new i.Deferred;return this.restRequest_(n+".json",t,(e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),s.resolve(i)):s.reject(new Error(i))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,r])=>{s&&s.accessToken&&(t.auth=s.accessToken),r&&r.token&&(t.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,i.querystring)(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=(()=>{if(n&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let t=null;if(a.status>=200&&a.status<300){try{t=(0,i.jsonEval)(a.responseText)}catch(e){I("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,t)}else 401!==a.status&&404!==a.status&&I("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}}),a.open("GET",o,!0),a.send()})}}class Gn{constructor(){this.rootNode_=_n.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function $n(){return{value:null,children:new Map}}function Xn(e,t,n){if(mt(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const i=ht(t);e.children.has(i)||e.children.set(i,$n()),Xn(e.children.get(i),t=ut(t),n)}}function Jn(e,t){if(mt(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(on,(t,n)=>{Xn(e,new at(t),n)}),Jn(e,t)}}if(e.children.size>0){const n=ht(t);if(t=ut(t),e.children.has(n)){Jn(e.children.get(n),t)&&e.children.delete(n)}return 0===e.children.size}return!0}function Zn(e,t,n){null!==e.value?n(t,e.value):ei(e,(e,i)=>{Zn(i,new at(t.toString()+"/"+e),n)})}function ei(e,t){e.children.forEach((e,n)=>{t(n,e)})}class ti{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&q(this.last_,(e,n)=>{t[e]=t[e]-n}),this.last_=e,t}}const ni=1e4,ii=3e4,si=3e5;class ri{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new ti(e);const n=ni+(ii-ni)*Math.random();Q(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;q(e,(e,s)=>{s>0&&(0,i.contains)(this.statsToReport_,e)&&(t[e]=s,n=!0)}),n&&this.server_.reportStats(t),Q(this.reportStats_.bind(this),Math.floor(2*Math.random()*si))}}var oi;function ai(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function li(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function hi(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(oi||(oi={}));class ci{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=oi.ACK_USER_WRITE,this.source=ai()}operationForChild(e){if(mt(this.path)){if(null!=this.affectedTree.value)return(0,i.assert)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new at(e));return new ci(lt(),t,this.revert)}}return(0,i.assert)(ht(this.path)===e,"operationForChild called for unrelated child."),new ci(ut(this.path),this.affectedTree,this.revert)}}class ui{constructor(e,t){this.source=e,this.path=t,this.type=oi.LISTEN_COMPLETE}operationForChild(e){return mt(this.path)?new ui(this.source,lt()):new ui(this.source,ut(this.path))}}class di{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=oi.OVERWRITE}operationForChild(e){return mt(this.path)?new di(this.source,lt(),this.snap.getImmediateChild(e)):new di(this.source,ut(this.path),this.snap)}}class pi{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=oi.MERGE}operationForChild(e){if(mt(this.path)){const t=this.children.subtree(new at(e));return t.isEmpty()?null:t.value?new di(this.source,lt(),t.value):new pi(this.source,lt(),t)}return(0,i.assert)(ht(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new pi(this.source,ut(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class _i{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(mt(e))return this.isFullyInitialized()&&!this.filtered_;const t=ht(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class fi{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function gi(e,t,n,i){const s=[],r=[];return t.forEach(t=>{"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&r.push(Mn(t.childName,t.snapshotNode))}),mi(e,s,"child_removed",t,i,n),mi(e,s,"child_added",t,i,n),mi(e,s,"child_moved",r,i,n),mi(e,s,"child_changed",t,i,n),mi(e,s,"value",t,i,n),s}function mi(e,t,n,i,s,r){const o=i.filter(e=>e.type===n);o.sort((t,n)=>vi(e,t,n)),o.forEach(n=>{const i=yi(e,n,r);s.forEach(s=>{s.respondsTo(n.type)&&t.push(s.createEvent(i,e.query_))})})}function yi(e,t,n){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_),t)}function vi(e,t,n){if(null==t.childName||null==n.childName)throw(0,i.assertionError)("Should only compare child_ events.");const s=new Lt(t.childName,t.snapshotNode),r=new Lt(n.childName,n.snapshotNode);return e.index_.compare(s,r)}function Ci(e,t){return{eventCache:e,serverCache:t}}function wi(e,t,n,i){return Ci(new _i(t,n,i),e.serverCache)}function Ti(e,t,n,i){return Ci(e.eventCache,new _i(t,n,i))}function bi(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function ki(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Ii;const Ei=()=>(Ii||(Ii=new zt(D)),Ii);class xi{constructor(e,t=Ei()){this.value=e,this.children=t}static fromObject(e){let t=new xi(null);return q(e,(e,n)=>{t=t.set(new at(e),n)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:lt(),value:this.value};if(mt(e))return null;{const n=ht(e),i=this.children.get(n);if(null!==i){const s=i.findRootMostMatchingPathAndValue(ut(e),t);if(null!=s){return{path:gt(new at(n),s.path),value:s.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(mt(e))return this;{const t=ht(e),n=this.children.get(t);return null!==n?n.subtree(ut(e)):new xi(null)}}set(e,t){if(mt(e))return new xi(t,this.children);{const n=ht(e),i=(this.children.get(n)||new xi(null)).set(ut(e),t),s=this.children.insert(n,i);return new xi(this.value,s)}}remove(e){if(mt(e))return this.children.isEmpty()?new xi(null):new xi(null,this.children);{const t=ht(e),n=this.children.get(t);if(n){const i=n.remove(ut(e));let s;return s=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&s.isEmpty()?new xi(null):new xi(this.value,s)}return this}}get(e){if(mt(e))return this.value;{const t=ht(e),n=this.children.get(t);return n?n.get(ut(e)):null}}setTree(e,t){if(mt(e))return t;{const n=ht(e),i=(this.children.get(n)||new xi(null)).setTree(ut(e),t);let s;return s=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new xi(this.value,s)}}fold(e){return this.fold_(lt(),e)}fold_(e,t){const n={};return this.children.inorderTraversal((i,s)=>{n[i]=s.fold_(gt(e,i),t)}),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,lt(),t)}findOnPath_(e,t,n){const i=!!this.value&&n(t,this.value);if(i)return i;if(mt(e))return null;{const i=ht(e),s=this.children.get(i);return s?s.findOnPath_(ut(e),gt(t,i),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,lt(),t)}foreachOnPath_(e,t,n){if(mt(e))return this;{this.value&&n(t,this.value);const i=ht(e),s=this.children.get(i);return s?s.foreachOnPath_(ut(e),gt(t,i),n):new xi(null)}}foreach(e){this.foreach_(lt(),e)}foreach_(e,t){this.children.inorderTraversal((n,i)=>{i.foreach_(gt(e,n),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,n)=>{n.value&&e(t,n.value)})}}class Si{constructor(e){this.writeTree_=e}static empty(){return new Si(new xi(null))}}function Pi(e,t,n){if(mt(t))return new Si(new xi(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const s=i.path;let r=i.value;const o=yt(s,t);return r=r.updateChild(o,n),new Si(e.writeTree_.set(s,r))}{const i=new xi(n),s=e.writeTree_.setTree(t,i);return new Si(s)}}}function Ni(e,t,n){let i=e;return q(n,(e,n)=>{i=Pi(i,gt(t,e),n)}),i}function Ri(e,t){if(mt(t))return Si.empty();{const n=e.writeTree_.setTree(t,new xi(null));return new Si(n)}}function Di(e,t){return null!=Mi(e,t)}function Mi(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(yt(n.path,t)):null}function Ai(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(on,(e,n)=>{t.push(new Lt(e,n))}):e.writeTree_.children.inorderTraversal((e,n)=>{null!=n.value&&t.push(new Lt(e,n.value))}),t}function Fi(e,t){if(mt(t))return e;{const n=Mi(e,t);return new Si(null!=n?new xi(n):e.writeTree_.subtree(t))}}function qi(e){return e.writeTree_.isEmpty()}function Li(e,t){return Oi(lt(),e.writeTree_,t)}function Oi(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let s=null;return t.children.inorderTraversal((t,r)=>{".priority"===t?((0,i.assert)(null!==r.value,"Priority writes must always be leaf nodes"),s=r.value):n=Oi(gt(e,t),r,n)}),n.getChild(e).isEmpty()||null===s||(n=n.updateChild(gt(e,".priority"),s)),n}}function Wi(e,t){return ls(t,e)}function Ui(e,t,n,s,r){(0,i.assert)(s>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:s,visible:r}),r&&(e.visibleWrites=Pi(e.visibleWrites,t,n)),e.lastWriteId=s}function ji(e,t,n,s){(0,i.assert)(s>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:s,visible:!0}),e.visibleWrites=Ni(e.visibleWrites,t,n),e.lastWriteId=s}function Bi(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}function Hi(e,t){const n=e.allWrites.findIndex(e=>e.writeId===t);(0,i.assert)(n>=0,"removeWrite called with nonexistent writeId.");const s=e.allWrites[n];e.allWrites.splice(n,1);let r=s.visible,o=!1,a=e.allWrites.length-1;for(;r&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=n&&Vi(t,s.path)?r=!1:wt(s.path,t.path)&&(o=!0)),a--}if(r){if(o)return zi(e),!0;if(s.snap)e.visibleWrites=Ri(e.visibleWrites,s.path);else{q(s.children,t=>{e.visibleWrites=Ri(e.visibleWrites,gt(s.path,t))})}return!0}return!1}function Vi(e,t){if(e.snap)return wt(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&wt(gt(e.path,n),t))return!0;return!1}function zi(e){e.visibleWrites=Qi(e.allWrites,Yi,lt()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function Yi(e){return e.visible}function Qi(e,t,n){let s=Si.empty();for(let r=0;r<e.length;++r){const o=e[r];if(t(o)){const e=o.path;let t;if(o.snap)wt(n,e)?s=Pi(s,t=yt(n,e),o.snap):wt(e,n)&&(t=yt(e,n),s=Pi(s,lt(),o.snap.getChild(t)));else{if(!o.children)throw(0,i.assertionError)("WriteRecord should have .snap or .children");if(wt(n,e))s=Ni(s,t=yt(n,e),o.children);else if(wt(e,n))if(mt(t=yt(e,n)))s=Ni(s,lt(),o.children);else{const e=(0,i.safeGet)(o.children,ht(t));if(e){const n=e.getChild(ut(t));s=Pi(s,lt(),n)}}}}}return s}function Ki(e,t,n,i,s){if(i||s){const r=Fi(e.visibleWrites,t);if(!s&&qi(r))return n;if(s||null!=n||Di(r,lt())){const r=function(e){return(e.visible||s)&&(!i||!~i.indexOf(e.writeId))&&(wt(e.path,t)||wt(t,e.path))};return Li(Qi(e.allWrites,r,t),n||_n.EMPTY_NODE)}return null}{const i=Mi(e.visibleWrites,t);if(null!=i)return i;{const i=Fi(e.visibleWrites,t);if(qi(i))return n;if(null!=n||Di(i,lt())){return Li(i,n||_n.EMPTY_NODE)}return null}}}function Gi(e,t,n){let i=_n.EMPTY_NODE;const s=Mi(e.visibleWrites,t);if(s)return s.isLeafNode()||s.forEachChild(on,(e,t)=>{i=i.updateImmediateChild(e,t)}),i;if(n){const s=Fi(e.visibleWrites,t);return n.forEachChild(on,(e,t)=>{const n=Li(Fi(s,new at(e)),t);i=i.updateImmediateChild(e,n)}),Ai(s).forEach(e=>{i=i.updateImmediateChild(e.name,e.node)}),i}return Ai(Fi(e.visibleWrites,t)).forEach(e=>{i=i.updateImmediateChild(e.name,e.node)}),i}function $i(e,t,n,s,r){(0,i.assert)(s||r,"Either existingEventSnap or existingServerSnap must exist");const o=gt(t,n);if(Di(e.visibleWrites,o))return null;{const t=Fi(e.visibleWrites,o);return qi(t)?r.getChild(n):Li(t,r.getChild(n))}}function Xi(e,t,n,i){const s=gt(t,n),r=Mi(e.visibleWrites,s);if(null!=r)return r;if(i.isCompleteForChild(n)){return Li(Fi(e.visibleWrites,s),i.getNode().getImmediateChild(n))}return null}function Ji(e,t){return Mi(e.visibleWrites,t)}function Zi(e,t,n,i,s,r,o){let a;const l=Fi(e.visibleWrites,t),h=Mi(l,lt());if(null!=h)a=h;else{if(null==n)return[];a=Li(l,n)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=r?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let l=n.getNext();for(;l&&e.length<s;)0!==t(l,i)&&e.push(l),l=n.getNext();return e}}function es(){return{visibleWrites:Si.empty(),allWrites:[],lastWriteId:-1}}function ts(e,t,n,i){return Ki(e.writeTree,e.treePath,t,n,i)}function ns(e,t){return Gi(e.writeTree,e.treePath,t)}function is(e,t,n,i){return $i(e.writeTree,e.treePath,t,n,i)}function ss(e,t){return Ji(e.writeTree,gt(e.treePath,t))}function rs(e,t,n,i,s,r){return Zi(e.writeTree,e.treePath,t,n,i,s,r)}function os(e,t,n){return Xi(e.writeTree,e.treePath,t,n)}function as(e,t){return ls(gt(e.treePath,t),e.writeTree)}function ls(e,t){return{treePath:e,writeTree:t}}class hs{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;(0,i.assert)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,i.assert)(".priority"!==n,"Only non-priority child changes can be tracked.");const s=this.changeMap.get(n);if(s){const r=s.type;if("child_added"===t&&"child_removed"===r)this.changeMap.set(n,Dn(n,e.snapshotNode,s.snapshotNode));else if("child_removed"===t&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===r)this.changeMap.set(n,Rn(n,s.oldSnap));else if("child_changed"===t&&"child_added"===r)this.changeMap.set(n,Nn(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==r)throw(0,i.assertionError)("Illegal combination of changes: "+e+" occurred after "+s);this.changeMap.set(n,Dn(n,e.snapshotNode,s.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}class cs{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}}const us=new cs;class ds{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new _i(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return os(this.writes_,e,t)}}getChildAfterChild(e,t,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ki(this.viewCache_),s=rs(this.writes_,i,t,1,n,e);return 0===s.length?null:s[0]}}function ps(e){return{filter:e}}function _s(e,t){(0,i.assert)(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),(0,i.assert)(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function fs(e,t,n,s,r){const o=new hs;let a,l;if(n.type===oi.OVERWRITE){const h=n;h.source.fromUser?a=vs(e,t,h.path,h.snap,s,r,o):((0,i.assert)(h.source.fromServer,"Unknown source."),l=h.source.tagged||t.serverCache.isFiltered()&&!mt(h.path),a=ys(e,t,h.path,h.snap,s,r,l,o))}else if(n.type===oi.MERGE){const h=n;h.source.fromUser?a=ws(e,t,h.path,h.children,s,r,o):((0,i.assert)(h.source.fromServer,"Unknown source."),l=h.source.tagged||t.serverCache.isFiltered(),a=bs(e,t,h.path,h.children,s,r,l,o))}else if(n.type===oi.ACK_USER_WRITE){const i=n;a=i.revert?Es(e,t,i.path,s,r,o):ks(e,t,i.path,i.affectedTree,s,r,o)}else{if(n.type!==oi.LISTEN_COMPLETE)throw(0,i.assertionError)("Unknown operation type: "+n.type);a=Is(e,t,n.path,s,o)}const h=o.getChanges();return gs(t,a,h),{viewCache:a,changes:h}}function gs(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=bi(e);(n.length>0||!e.eventCache.isFullyInitialized()||s&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&n.push(Pn(bi(t)))}}function ms(e,t,n,s,r,o){const a=t.eventCache;if(null!=ss(s,n))return t;{let l,h;if(mt(n))if((0,i.assert)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=ki(t),i=ns(s,n instanceof _n?n:_n.EMPTY_NODE);l=e.filter.updateFullNode(t.eventCache.getNode(),i,o)}else{const n=ts(s,ki(t));l=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const c=ht(n);if(".priority"===c){(0,i.assert)(1===ct(n),"Can't have a priority with additional path components");const r=a.getNode(),o=is(s,n,r,h=t.serverCache.getNode());l=null!=o?e.filter.updatePriority(r,o):a.getNode()}else{const i=ut(n);let u;if(a.isCompleteForChild(c)){h=t.serverCache.getNode();const e=is(s,n,a.getNode(),h);u=null!=e?a.getNode().getImmediateChild(c).updateChild(i,e):a.getNode().getImmediateChild(c)}else u=os(s,c,t.serverCache);l=null!=u?e.filter.updateChild(a.getNode(),c,u,i,r,o):a.getNode()}}return wi(t,l,a.isFullyInitialized()||mt(n),e.filter.filtersNodes())}}function ys(e,t,n,i,s,r,o,a){const l=t.serverCache;let h;const c=o?e.filter:e.filter.getIndexedFilter();if(mt(n))h=c.updateFullNode(l.getNode(),i,null);else if(c.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,i);h=c.updateFullNode(l.getNode(),e,null)}else{const e=ht(n);if(!l.isCompleteForPath(n)&&ct(n)>1)return t;const s=ut(n),r=l.getNode().getImmediateChild(e).updateChild(s,i);h=".priority"===e?c.updatePriority(l.getNode(),r):c.updateChild(l.getNode(),e,r,s,us,null)}const u=Ti(t,h,l.isFullyInitialized()||mt(n),c.filtersNodes());return ms(e,u,n,s,new ds(s,u,r),a)}function vs(e,t,n,i,s,r,o){const a=t.eventCache;let l,h;const c=new ds(s,t,r);if(mt(n))h=e.filter.updateFullNode(t.eventCache.getNode(),i,o),l=wi(t,h,!0,e.filter.filtersNodes());else{const s=ht(n);if(".priority"===s)h=e.filter.updatePriority(t.eventCache.getNode(),i),l=wi(t,h,a.isFullyInitialized(),a.isFiltered());else{const r=ut(n),h=a.getNode().getImmediateChild(s);let u;if(mt(r))u=i;else{const e=c.getCompleteChild(s);u=null!=e?".priority"===dt(r)&&e.getChild(ft(r)).isEmpty()?e:e.updateChild(r,i):_n.EMPTY_NODE}if(h.equals(u))l=t;else{l=wi(t,e.filter.updateChild(a.getNode(),s,u,r,c,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function Cs(e,t){return e.eventCache.isCompleteForChild(t)}function ws(e,t,n,i,s,r,o){let a=t;return i.foreach((i,l)=>{const h=gt(n,i);Cs(t,ht(h))&&(a=vs(e,a,h,l,s,r,o))}),i.foreach((i,l)=>{const h=gt(n,i);Cs(t,ht(h))||(a=vs(e,a,h,l,s,r,o))}),a}function Ts(e,t,n){return n.foreach((e,n)=>{t=t.updateChild(e,n)}),t}function bs(e,t,n,i,s,r,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,h=t;l=mt(n)?i:new xi(null).setTree(n,i);const c=t.serverCache.getNode();return l.children.inorderTraversal((n,i)=>{if(c.hasChild(n)){const l=t.serverCache.getNode().getImmediateChild(n),c=Ts(e,l,i);h=ys(e,h,new at(n),c,s,r,o,a)}}),l.children.inorderTraversal((n,i)=>{const l=!t.serverCache.isCompleteForChild(n)&&void 0===i.value;if(!c.hasChild(n)&&!l){const l=t.serverCache.getNode().getImmediateChild(n),c=Ts(e,l,i);h=ys(e,h,new at(n),c,s,r,o,a)}}),h}function ks(e,t,n,i,s,r,o){if(null!=ss(s,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=i.value){if(mt(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return ys(e,t,n,l.getNode().getChild(n),s,r,a,o);if(mt(n)){let i=new xi(null);return l.getNode().forEachChild(jt,(e,t)=>{i=i.set(new at(e),t)}),bs(e,t,n,i,s,r,a,o)}return t}{let h=new xi(null);return i.foreach((e,t)=>{const i=gt(n,e);l.isCompleteForPath(i)&&(h=h.set(e,l.getNode().getChild(i)))}),bs(e,t,n,h,s,r,a,o)}}function Is(e,t,n,i,s){const r=t.serverCache;return ms(e,Ti(t,r.getNode(),r.isFullyInitialized()||mt(n),r.isFiltered()),n,i,us,s)}function Es(e,t,n,s,r,o){let a;if(null!=ss(s,n))return t;{const l=new ds(s,t,r),h=t.eventCache.getNode();let c;if(mt(n)||".priority"===ht(n)){let n;if(t.serverCache.isFullyInitialized())n=ts(s,ki(t));else{const e=t.serverCache.getNode();(0,i.assert)(e instanceof _n,"serverChildren would be complete if leaf node"),n=ns(s,e)}n=n,c=e.filter.updateFullNode(h,n,o)}else{const i=ht(n);let r=os(s,i,t.serverCache);null==r&&t.serverCache.isCompleteForChild(i)&&(r=h.getImmediateChild(i)),(c=null!=r?e.filter.updateChild(h,i,r,ut(n),l,o):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(h,i,_n.EMPTY_NODE,ut(n),l,o):h).isEmpty()&&t.serverCache.isFullyInitialized()&&(a=ts(s,ki(t))).isLeafNode()&&(c=e.filter.updateFullNode(c,a,o))}return a=t.serverCache.isFullyInitialized()||null!=ss(s,lt()),wi(t,c,a,e.filter.filtersNodes())}}class xs{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new An(n.getIndex()),s=On(n);this.processor_=ps(s);const r=t.serverCache,o=t.eventCache,a=i.updateFullNode(_n.EMPTY_NODE,r.getNode(),null),l=s.updateFullNode(_n.EMPTY_NODE,o.getNode(),null),h=new _i(a,r.isFullyInitialized(),i.filtersNodes()),c=new _i(l,o.isFullyInitialized(),s.filtersNodes());this.viewCache_=Ci(c,h),this.eventGenerator_=new fi(this.query_)}get query(){return this.query_}}function Ss(e){return e.viewCache_.serverCache.getNode()}function Ps(e){return bi(e.viewCache_)}function Ns(e,t){const n=ki(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!mt(t)&&!n.getImmediateChild(ht(t)).isEmpty())?n.getChild(t):null}function Rs(e){return 0===e.eventRegistrations_.length}function Ds(e,t){e.eventRegistrations_.push(t)}function Ms(e,t,n){const s=[];if(n){(0,i.assert)(null==t,"A cancel should cancel all event registrations.");const r=e.query._path;e.eventRegistrations_.forEach(e=>{const t=e.createCancelEvent(n,r);t&&s.push(t)})}if(t){let n=[];for(let i=0;i<e.eventRegistrations_.length;++i){const s=e.eventRegistrations_[i];if(s.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(i+1));break}}else n.push(s)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return s}function As(e,t,n,s){t.type===oi.MERGE&&null!==t.source.queryId&&((0,i.assert)(ki(e.viewCache_),"We should always have a full cache before handling merges"),(0,i.assert)(bi(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,o=fs(e.processor_,r,t,n,s);return _s(e.processor_,o.viewCache),(0,i.assert)(o.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=o.viewCache,qs(e,o.changes,o.viewCache.eventCache.getNode(),null)}function Fs(e,t){const n=e.viewCache_.eventCache,i=[];if(!n.getNode().isLeafNode()){n.getNode().forEachChild(on,(e,t)=>{i.push(Nn(e,t))})}return n.isFullyInitialized()&&i.push(Pn(n.getNode())),qs(e,i,n.getNode(),t)}function qs(e,t,n,i){const s=i?[i]:e.eventRegistrations_;return gi(e.eventGenerator_,t,n,s)}let Ls,Os;class Ws{constructor(){this.views=new Map}}function Us(e){(0,i.assert)(!Ls,"__referenceConstructor has already been defined"),Ls=e}function js(){return(0,i.assert)(Ls,"Reference.ts has not been loaded"),Ls}function Bs(e){return 0===e.views.size}function Hs(e,t,n,s){const r=t.source.queryId;if(null!==r){const o=e.views.get(r);return(0,i.assert)(null!=o,"SyncTree gave us an op for an invalid query."),As(o,t,n,s)}{let i=[];for(const r of e.views.values())i=i.concat(As(r,t,n,s));return i}}function Vs(e,t,n,i,s){const r=t._queryIdentifier,o=e.views.get(r);if(!o){let e=ts(n,s?i:null),r=!1;e?r=!0:i instanceof _n?(e=ns(n,i),r=!1):(e=_n.EMPTY_NODE,r=!1);const o=Ci(new _i(e,r,!1),new _i(i,s,!1));return new xs(t,o)}return o}function zs(e,t,n,i,s,r){const o=Vs(e,t,i,s,r);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),Ds(o,n),Fs(o,n)}function Ys(e,t,n,i){const s=t._queryIdentifier,r=[];let o=[];const a=Xs(e);if("default"===s)for(const[l,h]of e.views.entries())o=o.concat(Ms(h,n,i)),Rs(h)&&(e.views.delete(l),h.query._queryParams.loadsAllData()||r.push(h.query));else{const t=e.views.get(s);t&&(o=o.concat(Ms(t,n,i)),Rs(t)&&(e.views.delete(s),t.query._queryParams.loadsAllData()||r.push(t.query)))}return a&&!Xs(e)&&r.push(new(js())(t._repo,t._path)),{removed:r,events:o}}function Qs(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Ks(e,t){let n=null;for(const i of e.views.values())n=n||Ns(i,t);return n}function Gs(e,t){if(t._queryParams.loadsAllData())return Js(e);{const n=t._queryIdentifier;return e.views.get(n)}}function $s(e,t){return null!=Gs(e,t)}function Xs(e){return null!=Js(e)}function Js(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}function Zs(e){(0,i.assert)(!Os,"__referenceConstructor has already been defined"),Os=e}function er(){return(0,i.assert)(Os,"Reference.ts has not been loaded"),Os}let tr=1;class nr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new xi(null),this.pendingWriteTree_=es(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ir(e,t,n,i,s){return Ui(e.pendingWriteTree_,t,n,i,s),s?gr(e,new di(ai(),t,n)):[]}function sr(e,t,n,i){ji(e.pendingWriteTree_,t,n,i);const s=xi.fromObject(n);return gr(e,new pi(ai(),t,s))}function rr(e,t,n=!1){const i=Bi(e.pendingWriteTree_,t);if(Hi(e.pendingWriteTree_,t)){let t=new xi(null);return null!=i.snap?t=t.set(lt(),!0):q(i.children,e=>{t=t.set(new at(e),!0)}),gr(e,new ci(i.path,t,n))}return[]}function or(e,t,n){return gr(e,new di(li(),t,n))}function ar(e,t,n){const i=xi.fromObject(n);return gr(e,new pi(li(),t,i))}function lr(e,t){return gr(e,new ui(li(),t))}function hr(e,t,n){const i=Tr(e,n);if(i){const n=br(i),s=n.path,r=n.queryId,o=yt(s,t);return kr(e,s,new ui(hi(r),o))}return[]}function cr(e,t,n,i){const s=t._path,r=e.syncPointTree_.get(s);let o=[];if(r&&("default"===t._queryIdentifier||$s(r,t))){const a=Ys(r,t,n,i);Bs(r)&&(e.syncPointTree_=e.syncPointTree_.remove(s));const l=a.removed;o=a.events;const h=-1!==l.findIndex(e=>e._queryParams.loadsAllData()),c=e.syncPointTree_.findOnPath(s,(e,t)=>Xs(t));if(h&&!c){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=Ir(t);for(let t=0;t<n.length;++t){const i=n[t],s=i.query,r=vr(e,i);e.listenProvider_.startListening(Er(s),Cr(e,s),r.hashFn,r.onComplete)}}}if(!c&&l.length>0&&!i)if(h){const n=null;e.listenProvider_.stopListening(Er(t),n)}else l.forEach(t=>{const n=e.queryToTagMap.get(wr(t));e.listenProvider_.stopListening(Er(t),n)});xr(e,l)}return o}function ur(e,t,n,i){const s=Tr(e,i);if(null!=s){const i=br(s),r=i.path,o=i.queryId,a=yt(r,t);return kr(e,r,new di(hi(o),a,n))}return[]}function dr(e,t,n,i){const s=Tr(e,i);if(s){const i=br(s),r=i.path,o=i.queryId,a=yt(r,t),l=xi.fromObject(n);return kr(e,r,new pi(hi(o),a,l))}return[]}function pr(e,t,n){const s=t._path;let r=null,o=!1;e.syncPointTree_.foreachOnPath(s,(e,t)=>{const n=yt(e,s);r=r||Ks(t,n),o=o||Xs(t)});let a,l=e.syncPointTree_.get(s);if(l?(o=o||Xs(l),r=r||Ks(l,lt())):(l=new Ws,e.syncPointTree_=e.syncPointTree_.set(s,l)),null!=r)a=!0;else{a=!1,r=_n.EMPTY_NODE,e.syncPointTree_.subtree(s).foreachChild((e,t)=>{const n=Ks(t,lt());n&&(r=r.updateImmediateChild(e,n))})}const h=$s(l,t);if(!h&&!t._queryParams.loadsAllData()){const n=wr(t);(0,i.assert)(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const s=Sr();e.queryToTagMap.set(n,s),e.tagToQueryMap.set(s,n)}let c=zs(l,t,n,Wi(e.pendingWriteTree_,s),r,a);if(!h&&!o){const n=Gs(l,t);c=c.concat(Pr(e,t,n))}return c}function _r(e,t,n){const i=e.pendingWriteTree_,s=e.syncPointTree_.findOnPath(t,(e,n)=>{const i=Ks(n,yt(e,t));if(i)return i});return Ki(i,t,s,n,!0)}function fr(e,t){const n=t._path;let i=null;e.syncPointTree_.foreachOnPath(n,(e,t)=>{const s=yt(e,n);i=i||Ks(t,s)});let s=e.syncPointTree_.get(n);s?i=i||Ks(s,lt()):(s=new Ws,e.syncPointTree_=e.syncPointTree_.set(n,s));const r=null!=i,o=r?new _i(i,!0,!1):null;return Ps(Vs(s,t,Wi(e.pendingWriteTree_,t._path),r?o.getNode():_n.EMPTY_NODE,r))}function gr(e,t){return mr(t,e.syncPointTree_,null,Wi(e.pendingWriteTree_,lt()))}function mr(e,t,n,i){if(mt(e.path))return yr(e,t,n,i);{const s=t.get(lt());null==n&&null!=s&&(n=Ks(s,lt()));let r=[];const o=ht(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const e=n?n.getImmediateChild(o):null,t=as(i,o);r=r.concat(mr(a,l,e,t))}return s&&(r=r.concat(Hs(s,e,i,n))),r}}function yr(e,t,n,i){const s=t.get(lt());null==n&&null!=s&&(n=Ks(s,lt()));let r=[];return t.children.inorderTraversal((t,s)=>{const o=n?n.getImmediateChild(t):null,a=as(i,t),l=e.operationForChild(t);l&&(r=r.concat(yr(l,s,o,a)))}),s&&(r=r.concat(Hs(s,e,i,n))),r}function vr(e,t){const n=t.query,i=Cr(e,n);return{hashFn:()=>{return(Ss(t)||_n.EMPTY_NODE).hash()},onComplete:t=>{if("ok"===t)return i?hr(e,n._path,i):lr(e,n._path);{const i=U(t,n);return cr(e,n,null,i)}}}}function Cr(e,t){const n=wr(t);return e.queryToTagMap.get(n)}function wr(e){return e._path.toString()+"$"+e._queryIdentifier}function Tr(e,t){return e.tagToQueryMap.get(t)}function br(e){const t=e.indexOf("$");return(0,i.assert)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new at(e.substr(0,t))}}function kr(e,t,n){const s=e.syncPointTree_.get(t);return(0,i.assert)(s,"Missing sync point for query tag that we're tracking"),Hs(s,n,Wi(e.pendingWriteTree_,t),null)}function Ir(e){return e.fold((e,t,n)=>{if(t&&Xs(t)){return[Js(t)]}{let e=[];return t&&(e=Qs(t)),q(n,(t,n)=>{e=e.concat(n)}),e}})}function Er(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(er())(e._repo,e._path):e}function xr(e,t){for(let n=0;n<t.length;++n){const i=t[n];if(!i._queryParams.loadsAllData()){const t=wr(i),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}function Sr(){return tr++}function Pr(e,t,n){const s=t._path,r=Cr(e,t),o=vr(e,n),a=e.listenProvider_.startListening(Er(t),r,o.hashFn,o.onComplete),l=e.syncPointTree_.subtree(s);if(r)(0,i.assert)(!Xs(l.value),"If we're adding a query, it shouldn't be shadowed");else{const t=l.fold((e,t,n)=>{if(!mt(e)&&t&&Xs(t))return[Js(t).query];{let e=[];return t&&(e=e.concat(Qs(t).map(e=>e.query))),q(n,(t,n)=>{e=e.concat(n)}),e}});for(let n=0;n<t.length;++n){const i=t[n];e.listenProvider_.stopListening(Er(i),Cr(e,i))}}return a}class Nr{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Nr(t)}node(){return this.node_}}class Rr{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=gt(this.path_,e);return new Rr(this.syncTree_,t)}node(){return _r(this.syncTree_,this.path_)}}const Dr=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Mr=function(e,t,n){return e&&"object"==typeof e?((0,i.assert)(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Ar(e[".sv"],t,n):"object"==typeof e[".sv"]?Fr(e[".sv"],t):void(0,i.assert)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Ar=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:(0,i.assert)(!1,"Unexpected server value: "+e)}},Fr=function(e,t,n){e.hasOwnProperty("increment")||(0,i.assert)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const s=e.increment;"number"!=typeof s&&(0,i.assert)(!1,"Unexpected increment value: "+s);const r=t.node();if((0,i.assert)(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return"number"!=typeof o?s:o+s},qr=function(e,t,n,i){return Or(t,new Rr(n,e),i)},Lr=function(e,t,n){return Or(e,new Nr(t),n)};function Or(e,t,n){const i=e.getPriority().val(),s=Mr(i,t.getImmediateChild(".priority"),n);let r;if(e.isLeafNode()){const i=e,r=Mr(i.getValue(),t,n);return r!==i.getValue()||s!==i.getPriority().val()?new tn(r,yn(s)):e}{const i=e;return r=i,s!==i.getPriority().val()&&(r=r.updatePriority(new tn(s))),i.forEachChild(on,(e,i)=>{const s=Or(i,t.getImmediateChild(e),n);s!==i&&(r=r.updateImmediateChild(e,s))}),r}}class Wr{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Ur(e,t){let n=t instanceof at?t:new at(t),s=e,r=ht(n);for(;null!==r;){const e=(0,i.safeGet)(s.node.children,r)||{children:{},childCount:0};s=new Wr(r,s,e),r=ht(n=ut(n))}return s}function jr(e){return e.node.value}function Br(e,t){e.node.value=t,Gr(e)}function Hr(e){return e.node.childCount>0}function Vr(e){return void 0===jr(e)&&!Hr(e)}function zr(e,t){q(e.node.children,(n,i)=>{t(new Wr(n,e,i))})}function Yr(e,t,n,i){n&&!i&&t(e),zr(e,e=>{Yr(e,t,!0,i)}),n&&i&&t(e)}function Qr(e,t,n){let i=n?e:e.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}return!1}function Kr(e){return new at(null===e.parent?e.name:Kr(e.parent)+"/"+e.name)}function Gr(e){null!==e.parent&&$r(e.parent,e.name,e)}function $r(e,t,n){const s=Vr(n),r=(0,i.contains)(e.node.children,t);s&&r?(delete e.node.children[t],e.node.childCount--,Gr(e)):s||r||(e.node.children[t]=n.node,e.node.childCount++,Gr(e))}const Xr=/[\[\].#$\/\u0000-\u001F\u007F]/,Jr=/[\[\].#$\u0000-\u001F\u007F]/,Zr=10485760,eo=function(e){return"string"==typeof e&&0!==e.length&&!Xr.test(e)},to=function(e){return"string"==typeof e&&0!==e.length&&!Jr.test(e)},no=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),to(e)},io=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!x(e)||e&&"object"==typeof e&&(0,i.contains)(e,".sv")},so=function(e,t,n,s){s&&void 0===t||ro((0,i.errorPrefix)(e,"value"),t,n)},ro=function(e,t,n){const s=n instanceof at?new Tt(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Et(s));if("function"==typeof t)throw new Error(e+"contains a function "+Et(s)+" with contents = "+t.toString());if(x(t))throw new Error(e+"contains "+t.toString()+" "+Et(s));if("string"==typeof t&&t.length>10485760/3&&(0,i.stringLength)(t)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+Et(s)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(q(t,(t,r)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!eo(t)))throw new Error(e+" contains an invalid key ("+t+") "+Et(s)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');bt(s,t),ro(e,r,s),kt(s)}),n&&i)throw new Error(e+' contains ".value" child '+Et(s)+" in addition to actual children.")}},oo=function(e,t){let n,i;for(n=0;n<t.length;n++){const s=_t(i=t[n]);for(let t=0;t<s.length;t++)if(".priority"===s[t]&&t===s.length-1);else if(!eo(s[t]))throw new Error(e+"contains an invalid key ("+s[t]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(vt);let s=null;for(n=0;n<t.length;n++){if(i=t[n],null!==s&&wt(s,i))throw new Error(e+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}},ao=function(e,t,n,s){if(s&&void 0===t)return;const r=(0,i.errorPrefix)(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(r+" must be an object containing the children to replace.");const o=[];q(t,(e,t)=>{const i=new at(e);if(ro(r,t,gt(n,i)),".priority"===dt(i)&&!io(t))throw new Error(r+"contains an invalid value for '"+i.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(i)}),oo(r,o)},lo=function(e,t,n){if(!n||void 0!==t){if(x(t))throw new Error((0,i.errorPrefix)(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!io(t))throw new Error((0,i.errorPrefix)(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ho=function(e,t,n,s){if(!(s&&void 0===n||eo(n)))throw new Error((0,i.errorPrefix)(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},co=function(e,t,n,s){if(!(s&&void 0===n||to(n)))throw new Error((0,i.errorPrefix)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')};exports._validatePathString=co;const uo=function(e,t,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),co(e,t,n,i)},po=function(e,t){if(".info"===ht(t))throw new Error(e+" failed = Can't modify data under /.info/")};exports._validateWritablePath=po;const _o=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!eo(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!no(n))throw new Error((0,i.errorPrefix)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class fo{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function go(e,t){let n=null;for(let i=0;i<t.length;i++){const s=t[i],r=s.getPath();null===n||Ct(r,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:r}),n.events.push(s)}n&&e.eventLists_.push(n)}function mo(e,t,n){go(e,n),vo(e,e=>Ct(e,t))}function yo(e,t,n){go(e,n),vo(e,e=>wt(e,t)||wt(t,e))}function vo(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const s=e.eventLists_[i];if(s){t(s.path)?(Co(e.eventLists_[i]),e.eventLists_[i]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Co(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const i=n.getEventRunner();y&&w("event: "+n.toString()),z(i)}}}const wo="repo_interrupt",To=25;class bo{constructor(e,t,n,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new fo,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=$n(),this.transactionQueueTree_=new Wr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ko(e,t,n){if(e.stats_=_e(e.repoInfo_),e.forceRestClient_||Y())e.server_=new Kn(e.repoInfo_,(t,n,i,s)=>{xo(e,t,n,i,s)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>So(e,!0),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,i.stringify)(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}e.persistentConnection_=new qt(e.repoInfo_,t,(t,n,i,s)=>{xo(e,t,n,i,s)},t=>{So(e,t)},t=>{Po(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(t=>{e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(t=>{e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=fe(e.repoInfo_,()=>new ri(e.stats_,e.server_)),e.infoData_=new Gn,e.infoSyncTree_=new nr({startListening:(t,n,i,s)=>{let r=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(r=or(e.infoSyncTree_,t._path,o),setTimeout(()=>{s("ok")},0)),r},stopListening:()=>{}}),No(e,"connected",!1),e.serverSyncTree_=new nr({startListening:(t,n,i,s)=>(e.server_.listen(t,i,n,(n,i)=>{const r=s(n,i);yo(e.eventQueue_,t._path,r)}),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function Io(e){const t=e.infoData_.getNode(new at(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Eo(e){return Dr({timestamp:Io(e)})}function xo(e,t,n,s,r){e.dataUpdateCount++;const o=new at(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let a=[];if(r)if(s){const t=(0,i.map)(n,e=>yn(e));a=dr(e.serverSyncTree_,o,t,r)}else{const t=yn(n);a=ur(e.serverSyncTree_,o,t,r)}else if(s){const t=(0,i.map)(n,e=>yn(e));a=ar(e.serverSyncTree_,o,t)}else{const t=yn(n);a=or(e.serverSyncTree_,o,t)}let l=o;a.length>0&&(l=$o(e,o)),yo(e.eventQueue_,l,a)}function So(e,t){No(e,"connected",t),!1===t&&Fo(e)}function Po(e,t){q(t,(t,n)=>{No(e,t,n)})}function No(e,t,n){const i=new at("/.info/"+t),s=yn(n);e.infoData_.updateSnapshot(i,s);const r=or(e.infoSyncTree_,i,s);yo(e.eventQueue_,i,r)}function Ro(e){return e.nextWriteId_++}function Do(e,t){const n=fr(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then(n=>{const i=yn(n).withIndex(t._queryParams.getIndex()),s=or(e.serverSyncTree_,t._path,i);return mo(e.eventQueue_,t._path,s),Promise.resolve(i)},n=>(Vo(e,"get for query "+(0,i.stringify)(t)+" failed: "+n),Promise.reject(new Error(n))))}function Mo(e,t,n,i,s){Vo(e,"set",{path:t.toString(),value:n,priority:i});const r=Eo(e),o=yn(n,i),a=_r(e.serverSyncTree_,t),l=Lr(o,a,r),h=Ro(e),c=ir(e.serverSyncTree_,t,l,h,!0);go(e.eventQueue_,c),e.server_.put(t.toString(),o.val(!0),(n,i)=>{const r="ok"===n;r||I("set at "+t+" failed: "+n);const o=rr(e.serverSyncTree_,h,!r);yo(e.eventQueue_,t,o),zo(e,s,n,i)});const u=na(e,t);$o(e,u),yo(e.eventQueue_,u,[])}function Ao(e,t,n,i){Vo(e,"update",{path:t.toString(),value:n});let s=!0;const r=Eo(e),o={};if(q(n,(n,i)=>{s=!1,o[n]=qr(gt(t,n),yn(i),e.serverSyncTree_,r)}),s)w("update() called with empty data.  Don't do anything."),zo(e,i,"ok",void 0);else{const s=Ro(e),r=sr(e.serverSyncTree_,t,o,s);go(e.eventQueue_,r),e.server_.merge(t.toString(),n,(n,r)=>{const o="ok"===n;o||I("update at "+t+" failed: "+n);const a=rr(e.serverSyncTree_,s,!o),l=a.length>0?$o(e,t):t;yo(e.eventQueue_,l,a),zo(e,i,n,r)}),q(n,n=>{const i=na(e,gt(t,n));$o(e,i)}),yo(e.eventQueue_,t,[])}}function Fo(e){Vo(e,"onDisconnectEvents");const t=Eo(e),n=$n();Zn(e.onDisconnect_,lt(),(i,s)=>{const r=qr(i,s,e.serverSyncTree_,t);Xn(n,i,r)});let i=[];Zn(n,lt(),(t,n)=>{i=i.concat(or(e.serverSyncTree_,t,n));const s=na(e,t);$o(e,s)}),e.onDisconnect_=$n(),yo(e.eventQueue_,lt(),i)}function qo(e,t,n){e.server_.onDisconnectCancel(t.toString(),(i,s)=>{"ok"===i&&Jn(e.onDisconnect_,t),zo(e,n,i,s)})}function Lo(e,t,n,i){const s=yn(n);e.server_.onDisconnectPut(t.toString(),s.val(!0),(n,r)=>{"ok"===n&&Xn(e.onDisconnect_,t,s),zo(e,i,n,r)})}function Oo(e,t,n,i,s){const r=yn(n,i);e.server_.onDisconnectPut(t.toString(),r.val(!0),(n,i)=>{"ok"===n&&Xn(e.onDisconnect_,t,r),zo(e,s,n,i)})}function Wo(e,t,n,s){if((0,i.isEmpty)(n))return w("onDisconnect().update() called with empty data.  Don't do anything."),void zo(e,s,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(i,r)=>{"ok"===i&&q(n,(n,i)=>{const s=yn(i);Xn(e.onDisconnect_,gt(t,n),s)}),zo(e,s,i,r)})}function Uo(e,t,n){let i;i=".info"===ht(t._path)?pr(e.infoSyncTree_,t,n):pr(e.serverSyncTree_,t,n),mo(e.eventQueue_,t._path,i)}function jo(e,t,n){let i;i=".info"===ht(t._path)?cr(e.infoSyncTree_,t,n):cr(e.serverSyncTree_,t,n),mo(e.eventQueue_,t._path,i)}function Bo(e){e.persistentConnection_&&e.persistentConnection_.interrupt(wo)}function Ho(e){e.persistentConnection_&&e.persistentConnection_.resume(wo)}function Vo(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),w(n,...t)}function zo(e,t,n,i){t&&z(()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let s=e;i&&(s+=": "+i);const r=new Error(s);r.code=e,t(r)}})}function Yo(e,t,n,s,r,o){Vo(e,"transaction on "+t);const a={path:t,update:n,onComplete:s,status:null,order:f(),applyLocally:o,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=Qo(e,t,void 0);a.currentInputSnapshot=l;const h=a.update(l.val());if(void 0===h)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{ro("transaction failed: Data returned ",h,a.path),a.status=0;const n=Ur(e.transactionQueueTree_,t),s=jr(n)||[];let r;if(s.push(a),Br(n,s),"object"==typeof h&&null!==h&&(0,i.contains)(h,".priority"))r=(0,i.safeGet)(h,".priority"),(0,i.assert)(io(r),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{r=(_r(e.serverSyncTree_,t)||_n.EMPTY_NODE).getPriority().val()}const o=Eo(e),c=yn(h,r),u=Lr(c,l,o);a.currentOutputSnapshotRaw=c,a.currentOutputSnapshotResolved=u,a.currentWriteId=Ro(e);const d=ir(e.serverSyncTree_,t,u,a.currentWriteId,a.applyLocally);yo(e.eventQueue_,t,d),Ko(e,e.transactionQueueTree_)}}function Qo(e,t,n){return _r(e.serverSyncTree_,t,n)||_n.EMPTY_NODE}function Ko(e,t=e.transactionQueueTree_){if(t||ta(e,t),jr(t)){const n=Zo(e,t);(0,i.assert)(n.length>0,"Sending zero length transaction queue"),n.every(e=>0===e.status)&&Go(e,Kr(t),n)}else Hr(t)&&zr(t,t=>{Ko(e,t)})}function Go(e,t,n){const s=n.map(e=>e.currentWriteId),r=Qo(e,t,s);let o=r;const a=r.hash();for(let c=0;c<n.length;c++){const e=n[c];(0,i.assert)(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const s=yt(t,e.path);o=o.updateChild(s,e.currentOutputSnapshotRaw)}const l=o.val(!0),h=t;e.server_.put(h.toString(),l,i=>{Vo(e,"transaction put response",{path:h.toString(),status:i});let s=[];if("ok"===i){const i=[];for(let t=0;t<n.length;t++)n[t].status=2,s=s.concat(rr(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&i.push(()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)),n[t].unwatcher();ta(e,Ur(e.transactionQueueTree_,t)),Ko(e,e.transactionQueueTree_),yo(e.eventQueue_,t,s);for(let e=0;e<i.length;e++)z(i[e])}else{if("datastale"===i)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{I("transaction at "+h.toString()+" failed: "+i);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=i}$o(e,t)}},a)}function $o(e,t){const n=Jo(e,t),i=Kr(n);return Xo(e,Zo(e,n),i),i}function Xo(e,t,n){if(0===t.length)return;const s=[];let r=[];const o=t.filter(e=>0===e.status).map(e=>e.currentWriteId);for(let l=0;l<t.length;l++){const h=t[l],c=yt(n,h.path);let u,d=!1;if((0,i.assert)(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===h.status)d=!0,u=h.abortReason,r=r.concat(rr(e.serverSyncTree_,h.currentWriteId,!0));else if(0===h.status)if(h.retryCount>=To)d=!0,u="maxretry",r=r.concat(rr(e.serverSyncTree_,h.currentWriteId,!0));else{const n=Qo(e,h.path,o);h.currentInputSnapshot=n;const s=t[l].update(n.val());if(void 0!==s){ro("transaction failed: Data returned ",s,h.path);let t=yn(s);"object"==typeof s&&null!=s&&(0,i.contains)(s,".priority")||(t=t.updatePriority(n.getPriority()));const a=h.currentWriteId,l=Eo(e),c=Lr(t,n,l);h.currentOutputSnapshotRaw=t,h.currentOutputSnapshotResolved=c,h.currentWriteId=Ro(e),o.splice(o.indexOf(a),1),r=(r=r.concat(ir(e.serverSyncTree_,h.path,c,h.currentWriteId,h.applyLocally))).concat(rr(e.serverSyncTree_,a,!0))}else d=!0,u="nodata",r=r.concat(rr(e.serverSyncTree_,h.currentWriteId,!0))}yo(e.eventQueue_,n,r),r=[],d&&(t[l].status=2,a=t[l].unwatcher,setTimeout(a,Math.floor(0)),t[l].onComplete&&("nodata"===u?s.push(()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot)):s.push(()=>t[l].onComplete(new Error(u),!1,null))))}var a;ta(e,e.transactionQueueTree_);for(let i=0;i<s.length;i++)z(s[i]);Ko(e,e.transactionQueueTree_)}function Jo(e,t){let n,i=e.transactionQueueTree_;for(n=ht(t);null!==n&&void 0===jr(i);)i=Ur(i,n),n=ht(t=ut(t));return i}function Zo(e,t){const n=[];return ea(e,t,n),n.sort((e,t)=>e.order-t.order),n}function ea(e,t,n){const i=jr(t);if(i)for(let s=0;s<i.length;s++)n.push(i[s]);zr(t,t=>{ea(e,t,n)})}function ta(e,t){const n=jr(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Br(t,n.length>0?n:void 0)}zr(t,t=>{ta(e,t)})}function na(e,t){const n=Kr(Jo(e,t)),i=Ur(e.transactionQueueTree_,t);return Qr(i,t=>{ia(e,t)}),ia(e,i),Yr(i,t=>{ia(e,t)}),n}function ia(e,t){const n=jr(t);if(n){const s=[];let r=[],o=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?((0,i.assert)(o===t-1,"All SENT items should be at beginning of queue."),o=t,n[t].status=3,n[t].abortReason="set"):((0,i.assert)(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),r=r.concat(rr(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&s.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Br(t,void 0):n.length=o+1,yo(e.eventQueue_,Kr(t),r);for(let e=0;e<s.length;e++)z(s[e])}}function sa(e){let t="";const n=e.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let e=n[s];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(i){}t+="/"+e}return t}function ra(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):I(`Invalid query segment '${n}' in query '${e}'`)}return t}const oa=function(e,t){const n=aa(e),i=n.namespace;"firebase.com"===n.domain&&k(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||k("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&I("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const s="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new le(n.host,n.secure,i,t,s,"",i!==n.subdomain),path:new at(n.pathString)}},aa=function(e){let t="",n="",i="",s="",r="",o=!0,a="https",l=443;if("string"==typeof e){let h=e.indexOf("//");h>=0&&(a=e.substring(0,h-1),e=e.substring(h+2));let c=e.indexOf("/");-1===c&&(c=e.length);let u=e.indexOf("?");-1===u&&(u=e.length),t=e.substring(0,Math.min(c,u)),c<u&&(s=sa(e.substring(c,u)));const d=ra(e.substring(Math.min(e.length,u)));(h=t.indexOf(":"))>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(h+1),10)):h=t.length;const p=t.slice(0,h);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),n=t.substring(e+1),r=i}"ns"in d&&(r=d.ns)}return{host:t,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:s,namespace:r}};class la{constructor(e,t,n,i){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,i.stringify)(this.snapshot.exportVal())}}class ha{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class ca{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,i.assert)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class ua{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new i.Deferred;return qo(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){po("OnDisconnect.remove",this._path);const e=new i.Deferred;return Lo(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){po("OnDisconnect.set",this._path),so("OnDisconnect.set",e,this._path,!1);const t=new i.Deferred;return Lo(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){po("OnDisconnect.setWithPriority",this._path),so("OnDisconnect.setWithPriority",e,this._path,!1),lo("OnDisconnect.setWithPriority",t,!1);const n=new i.Deferred;return Oo(this._repo,this._path,e,t,n.wrapCallback(()=>{})),n.promise}update(e){po("OnDisconnect.update",this._path),ao("OnDisconnect.update",e,this._path,!1);const t=new i.Deferred;return Wo(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}exports.OnDisconnect=ua;class da{constructor(e,t,n,i){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=i}get key(){return mt(this._path)?null:dt(this._path)}get ref(){return new ga(this._repo,this._path)}get _queryIdentifier(){const e=Qn(this._queryParams),t=A(e);return"{}"===t?"default":t}get _queryObject(){return Qn(this._queryParams)}isEqual(e){if(!((e=(0,i.getModularInstance)(e))instanceof da))return!1;const t=this._repo===e._repo,n=Ct(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&n&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+pt(this._path)}}function pa(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function _a(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===jt){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==P)throw new Error(i);if("string"!=typeof t)throw new Error(s)}if(e.hasEnd()){if(e.getIndexEndName()!==N)throw new Error(i);if("string"!=typeof n)throw new Error(s)}}else if(e.getIndex()===on){if(null!=t&&!io(t)||null!=n&&!io(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,i.assert)(e.getIndex()instanceof vn||e.getIndex()===wn,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function fa(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}exports._QueryImpl=da;class ga extends da{constructor(e,t){super(e,t,new Ln,!1)}get parent(){const e=ft(this._path);return null===e?null:new ga(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}exports._ReferenceImpl=ga;class ma{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new at(e),n=Ca(this.ref,e);return new ma(this._node.getChild(t),n,on)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,(t,n)=>e(new ma(n,Ca(this.ref,t),on)))}hasChild(e){const t=new at(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ya(e,t){return(e=(0,i.getModularInstance)(e))._checkNotDeleted("ref"),void 0!==t?Ca(e._root,t):e._root}function va(e,t){(e=(0,i.getModularInstance)(e))._checkNotDeleted("refFromURL");const n=oa(t,e._repo.repoInfo_.nodeAdmin);_o("refFromURL",n);const s=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||s.host===e._repo.repoInfo_.host||k("refFromURL: Host name does not match the current database: (found "+s.host+" but expected "+e._repo.repoInfo_.host+")"),ya(e,n.path.toString())}function Ca(e,t){return null===ht((e=(0,i.getModularInstance)(e))._path)?uo("child","path",t,!1):co("child","path",t,!1),new ga(e._repo,gt(e._path,t))}function wa(e){return e=(0,i.getModularInstance)(e),new ua(e._repo,e._path)}function Ta(e,t){e=(0,i.getModularInstance)(e),po("push",e._path),so("push",t,e._path,!0);const n=Io(e._repo),s=En(n),r=Ca(e,s),o=Ca(e,s);let a;return a=null!=t?ka(o,t).then(()=>o):Promise.resolve(o),r.then=a.then.bind(a),r.catch=a.then.bind(a,void 0),r}function ba(e){return po("remove",e._path),ka(e,null)}function ka(e,t){e=(0,i.getModularInstance)(e),po("set",e._path),so("set",t,e._path,!1);const n=new i.Deferred;return Mo(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}function Ia(e,t){e=(0,i.getModularInstance)(e),po("setPriority",e._path),lo("setPriority",t,!1);const n=new i.Deferred;return Mo(e._repo,gt(e._path,".priority"),t,null,n.wrapCallback(()=>{})),n.promise}function Ea(e,t,n){if(po("setWithPriority",e._path),so("setWithPriority",t,e._path,!1),lo("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const s=new i.Deferred;return Mo(e._repo,e._path,t,n,s.wrapCallback(()=>{})),s.promise}function xa(e,t){ao("update",t,e._path,!1);const n=new i.Deferred;return Ao(e._repo,e._path,t,n.wrapCallback(()=>{})),n.promise}function Sa(e){return Do((e=(0,i.getModularInstance)(e))._repo,e).then(t=>new ma(t,new ga(e._repo,e._path),e._queryParams.getIndex()))}exports.DataSnapshot=ma;class Pa{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new la("value",this,new ma(e.snapshotNode,new ga(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ha(this,e,t):null}matches(e){return e instanceof Pa&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Na{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ha(this,e,t):null}createEvent(e,t){(0,i.assert)(null!=e.childName,"Child events should have a childName.");const n=Ca(new ga(t._repo,t._path),e.childName),s=t._queryParams.getIndex();return new la(e.type,this,new ma(e.snapshotNode,n,s),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Na&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function Ra(e,t,n,i,s){let r;if("object"==typeof i&&(r=void 0,s=i),"function"==typeof i&&(r=i),s&&s.onlyOnce){const t=n,i=(n,i)=>{jo(e._repo,e,a),t(n,i)};i.userCallback=n.userCallback,i.context=n.context,n=i}const o=new ca(n,r||void 0),a="value"===t?new Pa(o):new Na(t,o);return Uo(e._repo,e,a),()=>jo(e._repo,e,a)}function Da(e,t,n,i){return Ra(e,"value",t,n,i)}function Ma(e,t,n,i){return Ra(e,"child_added",t,n,i)}function Aa(e,t,n,i){return Ra(e,"child_changed",t,n,i)}function Fa(e,t,n,i){return Ra(e,"child_moved",t,n,i)}function qa(e,t,n,i){return Ra(e,"child_removed",t,n,i)}function La(e,t,n){let i=null;const s=n?new ca(n):null;"value"===t?i=new Pa(s):t&&(i=new Na(t,s)),jo(e._repo,e,i)}class Oa{}exports.QueryConstraint=Oa;class Wa extends Oa{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){so("endAt",this._value,e._path,!0);const t=Hn(e._queryParams,this._value,this._key);if(fa(t),_a(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new da(e._repo,e._path,t,e._orderByCalled)}}function Ua(e,t){return ho("endAt","key",t,!0),new Wa(e,t)}class ja extends Oa{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){so("endBefore",this._value,e._path,!1);const t=Vn(e._queryParams,this._value,this._key);if(fa(t),_a(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new da(e._repo,e._path,t,e._orderByCalled)}}function Ba(e,t){return ho("endBefore","key",t,!0),new ja(e,t)}class Ha extends Oa{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){so("startAt",this._value,e._path,!0);const t=jn(e._queryParams,this._value,this._key);if(fa(t),_a(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new da(e._repo,e._path,t,e._orderByCalled)}}function Va(e=null,t){return ho("startAt","key",t,!0),new Ha(e,t)}class za extends Oa{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){so("startAfter",this._value,e._path,!1);const t=Bn(e._queryParams,this._value,this._key);if(fa(t),_a(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new da(e._repo,e._path,t,e._orderByCalled)}}function Ya(e,t){return ho("startAfter","key",t,!0),new za(e,t)}class Qa extends Oa{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new da(e._repo,e._path,Wn(e._queryParams,this._limit),e._orderByCalled)}}function Ka(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Qa(e)}class Ga extends Oa{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new da(e._repo,e._path,Un(e._queryParams,this._limit),e._orderByCalled)}}function $a(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Ga(e)}class Xa extends Oa{constructor(e){super(),this._path=e}_apply(e){pa(e,"orderByChild");const t=new at(this._path);if(mt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new vn(t),i=zn(e._queryParams,n);return _a(i),new da(e._repo,e._path,i,!0)}}function Ja(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return co("orderByChild","path",e,!1),new Xa(e)}class Za extends Oa{_apply(e){pa(e,"orderByKey");const t=zn(e._queryParams,jt);return _a(t),new da(e._repo,e._path,t,!0)}}function el(){return new Za}class tl extends Oa{_apply(e){pa(e,"orderByPriority");const t=zn(e._queryParams,on);return _a(t),new da(e._repo,e._path,t,!0)}}function nl(){return new tl}class il extends Oa{_apply(e){pa(e,"orderByValue");const t=zn(e._queryParams,wn);return _a(t),new da(e._repo,e._path,t,!0)}}function sl(){return new il}class rl extends Oa{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(so("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Wa(this._value,this._key)._apply(new Ha(this._value,this._key)._apply(e))}}function ol(e,t){return ho("equalTo","key",t,!0),new rl(e,t)}function al(e,...t){let n=(0,i.getModularInstance)(e);for(const i of t)n=i._apply(n);return n}Us(ga),Zs(ga);const ll="FIREBASE_DATABASE_EMULATOR_HOST",hl={};let cl=!1;function ul(e,t,n,i){e.repoInfo_=new le(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),i&&(e.authTokenProvider_=i)}function dl(t,n,i,s,r){let o=s||t.options.databaseURL;void 0===o&&(t.options.projectId||k("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),w("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a,l=oa(o,r),h=l.repoInfo,c=void 0;void 0!==e&&(c=e.env[ll]),c?(a=!0,o=`http://${c}?ns=${h.namespace}`,h=(l=oa(o,r)).repoInfo):a=!l.repoInfo.secure;const u=r&&a?new $($.OWNER):new G(t.name,t.options,n);_o("Invalid Firebase Database URL",l),mt(l.path)||k("Database URL must point to the root of a Firebase Database (not including a child path).");const d=_l(h,t,u,new K(t.name,i));return new gl(d,t)}function pl(e,t){const n=hl[t];n&&n[e.key]===e||k(`Database ${t}(${e.repoInfo_}) has already been deleted.`),Bo(e),delete n[e.key]}function _l(e,t,n,i){let s=hl[t.name];s||(s={},hl[t.name]=s);let r=s[e.toURLString()];return r&&k("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new bo(e,cl,n,i),s[e.toURLString()]=r,r}function fl(e){cl=e}class gl{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ko(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ga(this._repo,lt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(pl(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&k("Cannot call "+e+" on a deleted database.")}}function ml(e=(0,t.getApp)(),n){return(0,t._getProvider)(e,"database").getImmediate({identifier:n})}function yl(e,t,n,s={}){(e=(0,i.getModularInstance)(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&k("Cannot call useEmulator() after instance has already been initialized.");const r=e._repoInternal;let o=void 0;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&k('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new $($.OWNER);else if(s.mockUserToken){const t="string"==typeof s.mockUserToken?s.mockUserToken:(0,i.createMockUserToken)(s.mockUserToken,e.app.options.projectId);o=new $(t)}ul(r,t,n,o)}function vl(e){(e=(0,i.getModularInstance)(e))._checkNotDeleted("goOffline"),Bo(e._repo)}function Cl(e){(e=(0,i.getModularInstance)(e))._checkNotDeleted("goOnline"),Ho(e._repo)}function wl(e,t){C(e,t)}function Tl(e){l(t.SDK_VERSION),(0,t._registerComponent)(new n.Component("database",(e,{instanceIdentifier:t})=>{return dl(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)},"PUBLIC").setMultipleInstances(!0)),(0,t.registerVersion)(r,o,e),(0,t.registerVersion)(r,o,"esm2017")}exports.Database=gl;const bl={".sv":"timestamp"};function kl(){return bl}function Il(e){return{".sv":{increment:e}}}class El{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function xl(e,t,n){var s;if(e=(0,i.getModularInstance)(e),po("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const r=null===(s=null==n?void 0:n.applyLocally)||void 0===s||s,o=new i.Deferred,a=Da(e,()=>{});return Yo(e._repo,e._path,t,(t,n,i)=>{let s=null;t?o.reject(t):(s=new ma(i,new ga(e._repo,e._path),on),o.resolve(new El(n,s)))},a,r),o.promise}exports.TransactionResult=El,qt.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},qt.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};const Sl=function(e){const t=qt.prototype.put;return qt.prototype.put=function(n,i,s,r){void 0!==r&&(r=e()),t.call(this,n,i,s,r)},function(){qt.prototype.put=t}};exports._TEST_ACCESS_hijackHash=Sl;const Pl=function(e){fl(e)};exports._TEST_ACCESS_forceRestClient=Pl,Tl();
},{"@firebase/app":"Qqsz","@firebase/component":"sLOu","@firebase/util":"chA2","@firebase/logger":"MfMd","process":"pBGv"}],"Uuoh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/database");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/database":"Q6BU"}],"OJEJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/app");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r="firebase",t="9.1.3";(0,e.registerVersion)(r,t,"app");
},{"@firebase/app":"Qqsz"}],"esbM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.database=exports.firebaseApp=void 0;var e=require("firebase/app"),a=require("firebase/database");const t={apiKey:"AIzaSyCw4Y3q73TKMYE55JsFEcKyXbS0tzQK49I",authDomain:"team-project-js-f466b.firebaseapp.com",projectId:"team-project-js-f466b",storageBucket:"team-project-js-f466b.appspot.com",messagingSenderId:"958952460474",appId:"1:958952460474:web:53cbaa1f16e63288b43283",measurementId:"G-XK9DLL5BX7",databaseURL:"https://team-project-js-f466b-default-rtdb.europe-west1.firebasedatabase.app/",storageBucket:"gs://team-project-js-f466b.appspot.com/"},s=(0,e.initializeApp)(t);exports.firebaseApp=s;const p=(0,a.getDatabase)(s);exports.database=p;
},{"firebase/app":"OJEJ","firebase/database":"Uuoh"}],"jcKN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.$=Wt,exports.D=S,exports.E=xe,exports.W=St,exports.X=Ut,exports.Y=Ft,exports.Z=Vt,exports._=jt,exports.a0=Kt,exports.a1=Jt,exports.a2=Bt,exports.a3=$t,exports.a4=Yt,exports.a5=Xt,exports.a6=Qt,exports.a7=Zt,exports.a8=en,exports.a9=nn,exports.aA=gr,exports.aB=or,exports.aC=Le,exports.aF=De,exports.aG=Kn,exports.aa=rn,exports.ab=sn,exports.ad=ht,exports.ae=an,exports.af=cn,exports.ag=un,exports.ah=X,exports.ai=Q,exports.aj=Dt,exports.ak=vn,exports.al=ae,exports.am=Sn,exports.an=Ln,exports.ao=Re,exports.ap=N,exports.aq=Ae,exports.ar=Ee,exports.as=v,exports.at=Yr,exports.au=Er,exports.av=_,exports.aw=E,exports.ax=R,exports.ay=ge,exports.c=Xi,exports.d=Zi,exports.e=Qi,exports.f=ur,exports.g=pr,exports.h=lr,exports.j=fr,exports.l=Vi,exports.n=us,exports.p=_n,exports.q=Tn,exports.r=qi,exports.s=Fi,exports.t=yn,exports.u=Hi,exports.v=wn,exports.w=En,exports.x=kn,exports.y=Nn,exports.z=exports.o=exports.m=exports.k=exports.i=exports.b=exports.az=exports.ac=exports.aJ=exports.aI=exports.aH=exports.aE=exports.aD=exports.a=exports.V=exports.U=exports.T=exports.S=exports.R=exports.Q=exports.P=exports.O=exports.N=exports.M=exports.L=exports.K=exports.J=exports.I=exports.H=exports.G=exports.F=exports.C=exports.B=exports.A=void 0;var e=require("@firebase/util"),t=require("@firebase/app"),n=require("tslib"),i=require("@firebase/logger"),r=require("@firebase/component");const s={PHONE:"phone"};exports.F=s;const o={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};exports.o=o;const a={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"};exports.S=a;const c={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"};exports.O=c;const u={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function d(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}exports.A=u;const h=d;exports.z=h;const p=l;exports.B=p;const m=new e.ErrorFactory("auth","Firebase",l()),f={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized"};exports.C=f;const g=new i.Logger("@firebase/auth");function I(e,...n){g.logLevel<=i.LogLevel.ERROR&&g.error(`Auth (${t.SDK_VERSION}): ${e}`,...n)}function v(e,...t){throw w(e,...t)}function _(e,...t){return w(e,...t)}function T(t,n,i){const r=Object.assign(Object.assign({},p()),{[n]:i});return new e.ErrorFactory("auth","Firebase",r).create(n,{appName:t.name})}function y(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&v(e,"argument-error"),T(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.`+"Did you pass a reference from a different Auth SDK?")}function w(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return m.create(e,...t)}function E(e,t,...n){if(!e)throw w(t,...n)}function k(e){const t="INTERNAL ASSERTION FAILED: "+e;throw I(t),new Error(t)}function N(e,t){e||k(t)}const A=new Map;function R(e){N(e instanceof Function,"Expected a class definition");let t=A.get(e);return t?(N(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,A.set(e,t),t)}function S(n,i){const r=(0,t._getProvider)(n,"auth");if(r.isInitialized()){const t=r.getImmediate(),n=r.getOptions();if((0,e.deepEqual)(n,null!=i?i:{}))return t;v(t,"already-initialized")}return r.initialize({options:i})}function b(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(R);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}function O(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function P(){return"http:"===D()||"https:"===D()}function D(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function C(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(P()||(0,e.isBrowserExtension)()||"connection"in navigator))||navigator.onLine}function L(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}class M{constructor(t,n){this.shortDelay=t,this.longDelay=n,N(n>t,"Short delay should be less than long delay!"),this.isMobile=(0,e.isMobileCordova)()||(0,e.isReactNative)()}get(){return C()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function x(e,t){N(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class U{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void k("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void k("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void k("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}exports.aI=U;const F={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},V=new M(3e4,6e4);function q(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function j(t,n,i,r,s={}){return H(t,s,()=>{let s={},o={};r&&("GET"===n?o=r:s={body:JSON.stringify(r)});const a=(0,e.querystring)(Object.assign({key:t.config.apiKey},o)).slice(1),c=new(U.headers());return c.set("Content-Type","application/json"),c.set("X-Client-Version",t._getSdkClientVersion()),t.languageCode&&c.set("X-Firebase-Locale",t.languageCode),U.fetch()(G(t,t.config.apiHost,i,a),Object.assign({method:n,headers:c,referrerPolicy:"no-referrer"},s))})}async function H(t,n,i){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},F),n);try{const n=new W(t),o=await Promise.race([i(),n.promise]);n.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw K(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const e=o.ok?a.errorMessage:a.error.message,[n,i]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw K(t,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw K(t,"email-already-in-use",a);const s=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw T(t,s,i);v(t,s)}}catch(s){if(s instanceof e.FirebaseError)throw s;v(t,"network-request-failed")}}async function z(e,t,n,i,r={}){const s=await j(e,t,n,i,r);return"mfaPendingCredential"in s&&v(e,"multi-factor-auth-required",{serverResponse:s}),s}function G(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?x(e.config,r):`${e.config.apiScheme}://${r}`}class W{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(_(this.auth,"timeout")),V.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function K(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=_(e,t,i);return r.customData._tokenResponse=n,r}async function J(e,t){return j(e,"POST","/v1/accounts:delete",t)}async function B(e,t){return j(e,"POST","/v1/accounts:update",t)}async function $(e,t){return j(e,"POST","/v1/accounts:lookup",t)}function Y(e){if(e)try{const n=new Date(Number(e));if(!isNaN(n.getTime()))return n.toUTCString()}catch(t){}}function X(t,n=!1){return(0,e.getModularInstance)(t).getIdToken(n)}async function Q(t,n=!1){const i=(0,e.getModularInstance)(t),r=await i.getIdToken(n),s=ee(r);E(s&&s.exp&&s.auth_time&&s.iat,i.auth,"internal-error");const o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:Y(Z(s.auth_time)),issuedAtTime:Y(Z(s.iat)),expirationTime:Y(Z(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}function Z(e){return 1e3*Number(e)}function ee(t){const[n,i,r]=t.split(".");if(void 0===n||void 0===i||void 0===r)return I("JWT malformed, contained fewer than 3 sections"),null;try{const t=(0,e.base64Decode)(i);return t?JSON.parse(t):(I("Failed to decode base64 JWT payload"),null)}catch(s){return I("Caught error parsing JWT payload as JSON",s),null}}function te(e){const t=ee(e);return E(t,"internal-error"),E(void 0!==t.exp,"internal-error"),E(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function ne(t,n,i=!1){if(i)return n;try{return await n}catch(r){throw r instanceof e.FirebaseError&&ie(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ie({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}class re{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}class se{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Y(this.lastLoginAt),this.creationTime=Y(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function oe(e){var t;const n=e.auth,i=await e.getIdToken(),r=await ne(e,$(n,{idToken:i}));E(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?ue(s.providerUserInfo):[],a=ce(e.providerData,o),c=e.isAnonymous,u=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!c&&u,l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new se(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,l)}async function ae(t){const n=(0,e.getModularInstance)(t);await oe(n),await n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)}function ce(e,t){return[...e.filter(e=>!t.some(t=>t.providerId===e.providerId)),...t]}function ue(e){return e.map(e=>{var{providerId:t}=e,i=(0,n.__rest)(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}async function de(t,n){const i=await H(t,{},()=>{const i=(0,e.querystring)({grant_type:"refresh_token",refresh_token:n}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=G(t,r,"/v1/token",`key=${s}`);return U.fetch()(o,{method:"POST",headers:{"X-Client-Version":t._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:i})});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}class le{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){E(e.idToken,"internal-error"),E(void 0!==e.idToken,"internal-error"),E(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):te(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return E(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await de(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new le;return n&&(E("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(E("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(E("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new le,this.toJSON())}_performRefresh(){return k("not implemented")}}function he(e,t){E("string"==typeof e||void 0===e,"internal-error",{appName:t})}class pe{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=(0,n.__rest)(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new re(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.metadata=new se(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ne(this,this.stsTokenManager.getToken(this.auth,e));return E(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Q(this,e)}reload(){return ae(this)}_assign(e){this!==e&&(E(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new pe(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){E(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await oe(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ne(this,J(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,u;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,l=null!==(i=t.email)&&void 0!==i?i:void 0,h=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,m=null!==(o=t.tenantId)&&void 0!==o?o:void 0,f=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,I=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:_,isAnonymous:T,providerData:y,stsTokenManager:w}=t;E(v&&w,e,"internal-error");const k=le.fromJSON(this.name,w);E("string"==typeof v,e,"internal-error"),he(d,e.name),he(l,e.name),E("boolean"==typeof _,e,"internal-error"),E("boolean"==typeof T,e,"internal-error"),he(h,e.name),he(p,e.name),he(m,e.name),he(f,e.name),he(g,e.name),he(I,e.name);const N=new pe({uid:v,auth:e,email:l,emailVerified:_,displayName:d,isAnonymous:T,photoURL:p,phoneNumber:h,tenantId:m,stsTokenManager:k,createdAt:g,lastLoginAt:I});return y&&Array.isArray(y)&&(N.providerData=y.map(e=>Object.assign({},e))),f&&(N._redirectEventId=f),N}static async _fromIdTokenResponse(e,t,n=!1){const i=new le;i.updateFromServerResponse(t);const r=new pe({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await oe(r),r}}exports.aD=pe;class me{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}me.type="NONE";const fe=me;function ge(e,t,n){return`firebase:${e}:${t}:${n}`}exports.K=fe;class Ie{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=ge(this.userKey,i.apiKey,r),this.fullPersistenceKey=ge("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?pe._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ie(R(fe),e,n);const i=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let r=i[0]||R(fe);const s=ge(n,e.config.apiKey,e.name);let o=null;for(const u of t)try{const t=await u._get(s);if(t){const n=pe._fromJSON(e,t);u!==r&&(o=n),r=u;break}}catch(c){}const a=i.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==r)try{await e._remove(s)}catch(c){}})),new Ie(r,e,n)):new Ie(r,e,n)}}function ve(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(we(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(_e(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ke(t))return"Blackberry";if(Ne(t))return"Webos";if(Te(t))return"Safari";if((t.includes("chrome/")||ye(t))&&!t.includes("edge/"))return"Chrome";if(Ee(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function _e(t=(0,e.getUA)()){return/firefox\//i.test(t)}function Te(t=(0,e.getUA)()){const n=t.toLowerCase();return n.includes("safari/")&&!n.includes("chrome/")&&!n.includes("crios/")&&!n.includes("android")}function ye(t=(0,e.getUA)()){return/crios\//i.test(t)}function we(t=(0,e.getUA)()){return/iemobile/i.test(t)}function Ee(t=(0,e.getUA)()){return/android/i.test(t)}function ke(t=(0,e.getUA)()){return/blackberry/i.test(t)}function Ne(t=(0,e.getUA)()){return/webos/i.test(t)}function Ae(t=(0,e.getUA)()){return/iphone|ipad|ipod/i.test(t)}function Re(t=(0,e.getUA)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function Se(t=(0,e.getUA)()){var n;return Ae(t)&&!!(null===(n=window.navigator)||void 0===n?void 0:n.standalone)}function be(){return(0,e.isIE)()&&10===document.documentMode}function Oe(t=(0,e.getUA)()){return Ae(t)||Ee(t)||Ne(t)||ke(t)||/windows phone/i.test(t)||we(t)}function Pe(){try{return!(!window||window===window.top)}catch(e){return!1}}function De(n,i=[]){let r;switch(n){case"Browser":r=ve((0,e.getUA)());break;case"Worker":r=`${ve((0,e.getUA)())}-${n}`;break;default:r=n}const s=i.length?i.join(","):"FirebaseCore-web";return`${r}/JsCore/${t.SDK_VERSION}/${s}`}class Ce{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Me(this),this.idTokenSubscription=new Me(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=m,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=R(t)),this._initializationPromise=this.queue(async()=>{var n;this._deleted||(this.persistenceManager=await Ie.create(this,e),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(t),this._deleted||(this._isInitialized=!0)))}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e)):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);i&&i!==r||null==s||!s.user||(n=s.user)}return n?n._redirectEventId?(E(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await oe(e)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=L()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const n=t?(0,e.getModularInstance)(t):null;return n&&E(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&E(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(R(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new e.ErrorFactory("auth","Firebase",t())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&R(e)||this._popupRedirectResolver;E(t,this,"argument-error"),this.redirectPersistenceManager=await Ie.create(this,[R(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return E(s,this,"internal-error"),s.then(()=>r(this.currentUser)),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return E(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=De(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function Le(t){return(0,e.getModularInstance)(t)}exports.aE=Ce;class Me{constructor(t){this.auth=t,this.observer=null,this.addObserver=(0,e.createSubscribe)(e=>this.observer=e)}get next(){return E(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function xe(e,t,n){const i=Le(e);E(i._canInitEmulator,i,"emulator-config-failed"),E(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=Ue(t),{host:o,port:a}=Fe(t),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||qe()}function Ue(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Fe(e){const t=Ue(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:Ve(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:Ve(t)}}}function Ve(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function qe(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}class je{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return k("not implemented")}_getIdTokenResponse(e){return k("not implemented")}_linkToIdToken(e,t){return k("not implemented")}_getReauthenticationResolver(e){return k("not implemented")}}async function He(e,t){return j(e,"POST","/v1/accounts:resetPassword",q(e,t))}async function ze(e,t){return j(e,"POST","/v1/accounts:update",t)}async function Ge(e,t){return j(e,"POST","/v1/accounts:update",q(e,t))}async function We(e,t){return z(e,"POST","/v1/accounts:signInWithPassword",q(e,t))}async function Ke(e,t){return j(e,"POST","/v1/accounts:sendOobCode",q(e,t))}async function Je(e,t){return Ke(e,t)}async function Be(e,t){return Ke(e,t)}async function $e(e,t){return Ke(e,t)}async function Ye(e,t){return Ke(e,t)}async function Xe(e,t){return z(e,"POST","/v1/accounts:signInWithEmailLink",q(e,t))}async function Qe(e,t){return z(e,"POST","/v1/accounts:signInWithEmailLink",q(e,t))}exports.G=je;class Ze extends je{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ze(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ze(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return We(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Xe(e,{email:this._email,oobCode:this._password});default:v(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ze(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Qe(e,{idToken:t,email:this._email,oobCode:this._password});default:v(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function et(e,t){return z(e,"POST","/v1/accounts:signInWithIdp",q(e,t))}exports.H=Ze;const tt="http://localhost";class nt extends je{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new nt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):v("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=(0,n.__rest)(t,["providerId","signInMethod"]);if(!i||!r)return null;const o=new nt(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return et(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,et(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,et(e,t)}buildRequest(){const t={requestUri:tt,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),t.postBody=(0,e.querystring)(n)}return t}}async function it(e,t){return j(e,"POST","/v1/accounts:sendVerificationCode",q(e,t))}async function rt(e,t){return z(e,"POST","/v1/accounts:signInWithPhoneNumber",q(e,t))}async function st(e,t){const n=await z(e,"POST","/v1/accounts:signInWithPhoneNumber",q(e,t));if(n.temporaryProof)throw K(e,"account-exists-with-different-credential",n);return n}exports.I=nt;const ot={USER_NOT_FOUND:"user-not-found"};async function at(e,t){return z(e,"POST","/v1/accounts:signInWithPhoneNumber",q(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),ot)}class ct extends je{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ct({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ct({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return rt(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return st(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return at(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new ct({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}function ut(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function dt(t){const n=(0,e.querystringDecode)((0,e.extractQuerystring)(t)).link,i=n?(0,e.querystringDecode)((0,e.extractQuerystring)(n)).deep_link_id:null,r=(0,e.querystringDecode)((0,e.extractQuerystring)(t)).deep_link_id;return(r?(0,e.querystringDecode)((0,e.extractQuerystring)(r)).link:null)||r||i||n||t}exports.J=ct;class lt{constructor(t){var n,i,r,s,o,a;const c=(0,e.querystringDecode)((0,e.extractQuerystring)(t)),u=null!==(n=c.apiKey)&&void 0!==n?n:null,d=null!==(i=c.oobCode)&&void 0!==i?i:null,l=ut(null!==(r=c.mode)&&void 0!==r?r:null);E(u&&d&&l,"argument-error"),this.apiKey=u,this.operation=l,this.code=d,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=dt(e);try{return new lt(t)}catch(n){return null}}}function ht(e){return lt.parseLink(e)}exports.ac=lt;class pt{constructor(){this.providerId=pt.PROVIDER_ID}static credential(e,t){return Ze._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=lt.parseLink(t);return E(n,"argument-error"),Ze._fromEmailAndCode(e,n.code,n.tenantId)}}exports.L=pt,pt.PROVIDER_ID="password",pt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",pt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class mt{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ft extends mt{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class gt extends ft{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return E("providerId"in t&&"signInMethod"in t,"argument-error"),nt._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return E(e.idToken||e.accessToken,"argument-error"),nt._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return gt.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return gt.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:i,pendingToken:r,nonce:s,providerId:o}=e;if(!(n||i||t||r))return null;if(!o)return null;try{return new gt(o)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:r})}catch(a){return null}}}exports.T=gt;class It extends ft{constructor(){super("facebook.com")}static credential(e){return nt._fromParams({providerId:It.PROVIDER_ID,signInMethod:It.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return It.credentialFromTaggedObject(e)}static credentialFromError(e){return It.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return It.credential(e.oauthAccessToken)}catch(t){return null}}}exports.M=It,It.FACEBOOK_SIGN_IN_METHOD="facebook.com",It.PROVIDER_ID="facebook.com";class vt extends ft{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return nt._fromParams({providerId:vt.PROVIDER_ID,signInMethod:vt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return vt.credentialFromTaggedObject(e)}static credentialFromError(e){return vt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return vt.credential(t,n)}catch(i){return null}}}exports.N=vt,vt.GOOGLE_SIGN_IN_METHOD="google.com",vt.PROVIDER_ID="google.com";class _t extends ft{constructor(){super("github.com")}static credential(e){return nt._fromParams({providerId:_t.PROVIDER_ID,signInMethod:_t.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _t.credentialFromTaggedObject(e)}static credentialFromError(e){return _t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return _t.credential(e.oauthAccessToken)}catch(t){return null}}}exports.Q=_t,_t.GITHUB_SIGN_IN_METHOD="github.com",_t.PROVIDER_ID="github.com";const Tt="http://localhost";class yt extends je{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return et(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,et(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,et(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i,pendingToken:r}=t;return n&&i&&r&&n===i?new yt(n,r):null}static _create(e,t){return new yt(e,t)}buildRequest(){return{requestUri:Tt,returnSecureToken:!0,pendingToken:this.pendingToken}}}exports.aJ=yt;const wt="saml.";class Et extends mt{constructor(e){E(e.startsWith(wt),"argument-error"),super(e)}static credentialFromResult(e){return Et.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Et.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=yt.fromJSON(e);return E(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return yt._create(n,t)}catch(i){return null}}}exports.U=Et;class kt extends ft{constructor(){super("twitter.com")}static credential(e,t){return nt._fromParams({providerId:kt.PROVIDER_ID,signInMethod:kt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return kt.credentialFromTaggedObject(e)}static credentialFromError(e){return kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return kt.credential(t,n)}catch(i){return null}}}async function Nt(e,t){return z(e,"POST","/v1/accounts:signUp",q(e,t))}exports.V=kt,kt.TWITTER_SIGN_IN_METHOD="twitter.com",kt.PROVIDER_ID="twitter.com";class At{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await pe._fromIdTokenResponse(e,n,i),s=Rt(n);return new At({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Rt(n);return new At({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Rt(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function St(e){var t;const n=Le(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new At({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await Nt(n,{returnSecureToken:!0}),r=await At._fromIdTokenResponse(n,"signIn",i,!0);return await n._updateCurrentUser(r.user),r}class bt extends e.FirebaseError{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,this.name="FirebaseError",Object.setPrototypeOf(this,bt.prototype),this.appName=e.name,this.code=t.code,this.tenantId=null!==(r=e.tenantId)&&void 0!==r?r:void 0,this.serverResponse=t.customData.serverResponse}static _fromErrorAndOperation(e,t,n,i){return new bt(e,t,n,i)}}function Ot(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw bt._fromErrorAndOperation(e,n,t,i);throw n})}function Pt(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}async function Dt(t,n){const i=(0,e.getModularInstance)(t);await Lt(!0,i,n);const{providerUserInfo:r}=await B(i.auth,{idToken:await i.getIdToken(),deleteProvider:[n]}),s=Pt(r||[]);return i.providerData=i.providerData.filter(e=>s.has(e.providerId)),s.has("phone")||(i.phoneNumber=null),await i.auth._persistUserIfCurrent(i),i}async function Ct(e,t,n=!1){const i=await ne(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return At._forOperation(e,"link",i)}async function Lt(e,t,n){await oe(t);const i=!1===e?"provider-already-linked":"no-such-provider";E(Pt(t.providerData).has(n)===e,t.auth,i)}async function Mt(e,t,n=!1){const{auth:i}=e;try{const s=await ne(e,Ot(i,"reauthenticate",t,e),n);E(s.idToken,i,"internal-error");const o=ee(s.idToken);E(o,i,"internal-error");const{sub:a}=o;return E(e.uid===a,i,"user-mismatch"),At._forOperation(e,"reauthenticate",s)}catch(r){throw"auth/user-not-found"===(null==r?void 0:r.code)&&v(i,"user-mismatch"),r}}async function xt(e,t,n=!1){const i=await Ot(e,"signIn",t),r=await At._fromIdTokenResponse(e,"signIn",i);return n||await e._updateCurrentUser(r.user),r}async function Ut(e,t){return xt(Le(e),t)}async function Ft(t,n){const i=(0,e.getModularInstance)(t);return await Lt(!1,i,n.providerId),Ct(i,n)}async function Vt(t,n){return Mt((0,e.getModularInstance)(t),n)}async function qt(e,t){return z(e,"POST","/v1/accounts:signInWithCustomToken",q(e,t))}async function jt(e,t){const n=Le(e),i=await qt(n,{token:t,returnSecureToken:!0}),r=await At._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(r.user),r}class Ht{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?zt._fromServerResponse(e,t):v(e,"internal-error")}}class zt extends Ht{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new zt(t)}}function Gt(e,t,n){var i;E((null===(i=n.url)||void 0===i?void 0:i.length)>0,e,"invalid-continue-uri"),E(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(E(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(E(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Wt(t,n,i){const r=(0,e.getModularInstance)(t),s={requestType:"PASSWORD_RESET",email:n};i&&Gt(r,s,i),await Be(r,s)}async function Kt(t,n,i){await He((0,e.getModularInstance)(t),{oobCode:n,newPassword:i})}async function Jt(t,n){await Ge((0,e.getModularInstance)(t),{oobCode:n})}async function Bt(t,n){const i=(0,e.getModularInstance)(t),r=await He(i,{oobCode:n}),s=r.requestType;switch(E(s,i,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":E(r.newEmail,i,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":E(r.mfaInfo,i,"internal-error");default:E(r.email,i,"internal-error")}let o=null;return r.mfaInfo&&(o=Ht._fromServerResponse(Le(i),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:o},operation:s}}async function $t(t,n){const{data:i}=await Bt((0,e.getModularInstance)(t),n);return i.email}async function Yt(e,t,n){const i=Le(e),r=await Nt(i,{returnSecureToken:!0,email:t,password:n}),s=await At._fromIdTokenResponse(i,"signIn",r);return await i._updateCurrentUser(s.user),s}function Xt(t,n,i){return Ut((0,e.getModularInstance)(t),pt.credential(n,i))}async function Qt(t,n,i){const r=(0,e.getModularInstance)(t),s={requestType:"EMAIL_SIGNIN",email:n};E(i.handleCodeInApp,r,"argument-error"),i&&Gt(r,s,i),await $e(r,s)}function Zt(e,t){const n=lt.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}async function en(t,n,i){const r=(0,e.getModularInstance)(t),s=pt.credentialWithLink(n,i||O());return E(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Ut(r,s)}async function tn(e,t){return j(e,"POST","/v1/accounts:createAuthUri",q(e,t))}async function nn(t,n){const i={identifier:n,continueUri:P()?O():"http://localhost"},{signinMethods:r}=await tn((0,e.getModularInstance)(t),i);return r||[]}async function rn(t,n){const i=(0,e.getModularInstance)(t),r={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};n&&Gt(i.auth,r,n);const{email:s}=await Je(i.auth,r);s!==t.email&&await t.reload()}async function sn(t,n,i){const r=(0,e.getModularInstance)(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:n};i&&Gt(r.auth,s,i);const{email:o}=await Ye(r.auth,s);o!==t.email&&await t.reload()}async function on(e,t){return j(e,"POST","/v1/accounts:update",t)}async function an(t,{displayName:n,photoURL:i}){if(void 0===n&&void 0===i)return;const r=(0,e.getModularInstance)(t),s={idToken:await r.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},o=await ne(r,on(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function cn(t,n){return dn((0,e.getModularInstance)(t),n,null)}function un(t,n){return dn((0,e.getModularInstance)(t),null,n)}async function dn(e,t,n){const{auth:i}=e,r={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(r.email=t),n&&(r.password=n);const s=await ne(e,ze(i,r));await e._updateTokensIfNecessary(s,!0)}function ln(e){var t,n;if(!e)return null;const{providerId:i}=e,r=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!i&&(null==e?void 0:e.idToken)){const i=null===(n=null===(t=ee(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(i){return new hn(s,"anonymous"!==i&&"custom"!==i?i:null)}}if(!i)return null;switch(i){case"facebook.com":return new mn(s,r);case"github.com":return new fn(s,r);case"google.com":return new gn(s,r);case"twitter.com":return new In(s,r,e.screenName||null);case"custom":case"anonymous":return new hn(s,null);default:return new hn(s,i,r)}}class hn{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class pn extends hn{constructor(e,t,n,i){super(e,t,n),this.username=i}}class mn extends hn{constructor(e,t){super(e,"facebook.com",t)}}class fn extends pn{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class gn extends hn{constructor(e,t){super(e,"google.com",t)}}class In extends pn{constructor(e,t,n){super(e,"twitter.com",t,n)}}function vn(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:ln(n)}function _n(t,n){return(0,e.getModularInstance)(t).setPersistence(n)}function Tn(t,n,i,r){return(0,e.getModularInstance)(t).onIdTokenChanged(n,i,r)}function yn(t,n,i,r){return(0,e.getModularInstance)(t).onAuthStateChanged(n,i,r)}function wn(t){(0,e.getModularInstance)(t).useDeviceLanguage()}function En(t,n){return(0,e.getModularInstance)(t).updateCurrentUser(n)}function kn(t){return(0,e.getModularInstance)(t).signOut()}async function Nn(t){return(0,e.getModularInstance)(t).delete()}class An{constructor(e,t){this.type=e,this.credential=t}static _fromIdtoken(e){return new An("enroll",e)}static _fromMfaPendingCredential(e){return new An("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return An._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return An._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Rn{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Le(e),i=(t.serverResponse.mfaInfo||[]).map(e=>Ht._fromServerResponse(n,e));E(t.serverResponse.mfaPendingCredential,n,"internal-error");const r=An._fromMfaPendingCredential(t.serverResponse.mfaPendingCredential);return new Rn(r,i,async e=>{const i=await e._process(n,r);delete t.serverResponse.mfaInfo,delete t.serverResponse.mfaPendingCredential;const s=Object.assign(Object.assign({},t.serverResponse),{idToken:i.idToken,refreshToken:i.refreshToken});switch(t.operationType){case"signIn":const e=await At._fromIdTokenResponse(n,t.operationType,s);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return E(t.user,n,"internal-error"),At._forOperation(t.user,t.operationType,s);default:v(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function Sn(t,n){var i;const r=(0,e.getModularInstance)(t),s=n;return E(n.operationType,r,"argument-error"),E(null===(i=s.serverResponse)||void 0===i?void 0:i.mfaPendingCredential,r,"argument-error"),Rn._fromError(r,s)}function bn(e,t){return j(e,"POST","/v2/accounts/mfaEnrollment:start",q(e,t))}function On(e,t){return j(e,"POST","/v2/accounts/mfaEnrollment:finalize",q(e,t))}function Pn(e,t){return j(e,"POST","/v2/accounts/mfaEnrollment:withdraw",q(e,t))}class Dn{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>Ht._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new Dn(e)}async getSession(){return An._fromIdtoken(await this.user.getIdToken())}async enroll(e,t){const n=e,i=await this.getSession(),r=await ne(this.user,n._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken(),i=await ne(this.user,Pn(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(i);try{await this.user.reload()}catch(r){if("auth/user-token-expired"!==r.code)throw r}}}const Cn=new WeakMap;function Ln(t){const n=(0,e.getModularInstance)(t);return Cn.has(n)||Cn.set(n,Dn._fromUser(n)),Cn.get(n)}const Mn="__sak";class xn{constructor(e,t){this.storage=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Mn,"1"),this.storage.removeItem(Mn),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}}function Un(){const t=(0,e.getUA)();return Te(t)||Ae(t)}const Fn=1e3,Vn=10;class qn extends xn{constructor(){super(window.localStorage,"LOCAL"),this.boundEventHandler=((e,t)=>this.onStorageEvent(e,t)),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=Un()&&Pe(),this.fallbackToPolling=Oe(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);be()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Vn):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},Fn)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qn.type="LOCAL";const jn=qn;exports.b=jn;class Hn extends xn{constructor(){super(window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Hn.type="SESSION";const zn=Hn;function Gn(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}exports.a=zn;class Wn{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Wn(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async e=>e(t.origin,r)),a=await Gn(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Kn(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}Wn.receivers=[];class Jn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise((o,a)=>{const c=Kn("",20);i.port1.start();const u=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Bn(){return window}function $n(e){Bn().location.href=e}function Yn(){return void 0!==Bn().WorkerGlobalScope&&"function"==typeof Bn().importScripts}async function Xn(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}function Qn(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}function Zn(){return Yn()?self:null}const ei="firebaseLocalStorageDb",ti=1,ni="firebaseLocalStorage",ii="fbase_key";class ri{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function si(e,t){return e.transaction([ni],t?"readwrite":"readonly").objectStore(ni)}function oi(){const e=indexedDB.deleteDatabase(ei);return new ri(e).toPromise()}function ai(){const e=indexedDB.open(ei,ti);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(ni,{keyPath:ii})}catch(i){n(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(ni)?t(n):(n.close(),await oi(),t(await ai()))})})}async function ci(e,t,n){const i=si(e,!0).put({[ii]:t,value:n});return new ri(i).toPromise()}async function ui(e,t){const n=si(e,!1).get(t),i=await new ri(n).toPromise();return void 0===i?null:i.value}function di(e,t){const n=si(e,!0).delete(t);return new ri(n).toPromise()}const li=800,hi=3;class pi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ai(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(n){if(t++>hi)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Yn()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wn._getInstance(Zn()),this.receiver._subscribe("keyChanged",async(e,t)=>{return{keyProcessed:(await this._poll()).includes(t.key)}}),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Xn(),!this.activeServiceWorker)return;this.sender=new Jn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&Qn()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await ai();return await ci(t,Mn,"1"),await di(t,Mn),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>ci(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>ui(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>di(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=si(e,!1).getAll();return new ri(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),li)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}pi.type="LOCAL";const mi=pi;function fi(e,t){return j(e,"POST","/v2/accounts/mfaSignIn:start",q(e,t))}function gi(e,t){return j(e,"POST","/v2/accounts/mfaSignIn:finalize",q(e,t))}async function Ii(e){return(await j(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}function vi(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}function _i(e){return new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=(e=>{const t=_("internal-error");t.customData=e,n(t)}),i.type="text/javascript",i.charset="UTF-8",vi().appendChild(i)})}function Ti(e){return`__${e}${Math.floor(1e6*Math.random())}`}exports.i=mi;const yi=500,wi=6e4,Ei=1e12;class ki{constructor(e){this.auth=e,this.counter=Ei,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Ni(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Ei;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Ei;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Ei;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Ni{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=(()=>{this.execute()});const i="string"==typeof e?document.getElementById(e):e;E(i,"argument-error",{appName:t}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=Ai(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()},wi)},yi))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function Ai(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<e;i++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}const Ri=Ti("rcb"),Si=new M(3e4,6e4),bi="https://www.google.com/recaptcha/api.js?";class Oi{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Bn().grecaptcha}load(t,n=""){return E(Pi(n),t,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(Bn().grecaptcha):new Promise((i,r)=>{const s=Bn().setTimeout(()=>{r(_(t,"network-request-failed"))},Si.get());Bn()[Ri]=(()=>{Bn().clearTimeout(s),delete Bn()[Ri];const e=Bn().grecaptcha;if(!e)return void r(_(t,"internal-error"));const o=e.render;e.render=((e,t)=>{const n=o(e,t);return this.counter++,n}),this.hostLanguage=n,i(e)}),_i(`${bi}?${(0,e.querystring)({onload:Ri,render:"explicit",hl:n})}`).catch(()=>{clearTimeout(s),r(_(t,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!Bn().grecaptcha&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Pi(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}class Di{async load(e){return new ki(e)}clearedOneInstance(){}}const Ci="recaptcha",Li={theme:"light",type:"image"};class Mi{constructor(e,t=Object.assign({},Li),n){this.parameters=t,this.type=Ci,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Le(n),this.isInvisible="invisible"===this.parameters.size,E("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const i="string"==typeof e?document.getElementById(e):e;E(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Di:new Oi,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(n=>{const i=e=>{e&&(this.tokenChangeListeners.delete(i),n(e))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){E(!this.parameters.sitekey,this.auth,"argument-error"),E(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),E("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"==typeof e)e(t);else if("string"==typeof e){const n=Bn()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){E(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){E(P()&&!Yn(),this.auth,"internal-error"),await xi(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await Ii(this.auth);E(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return E(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function xi(){let e=null;return new Promise(t=>{"complete"!==document.readyState?(e=(()=>t()),window.addEventListener("load",e)):t()}).catch(t=>{throw e&&window.removeEventListener("load",e),t})}exports.R=Mi;class Ui{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ct._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Fi(t,n,i){const r=Le(t),s=await ji(r,n,(0,e.getModularInstance)(i));return new Ui(s,e=>Ut(r,e))}async function Vi(t,n,i){const r=(0,e.getModularInstance)(t);await Lt(!1,r,"phone");const s=await ji(r.auth,n,(0,e.getModularInstance)(i));return new Ui(s,e=>Ft(r,e))}async function qi(t,n,i){const r=(0,e.getModularInstance)(t),s=await ji(r.auth,n,(0,e.getModularInstance)(i));return new Ui(s,e=>Vt(r,e))}async function ji(e,t,n){var i;const r=await n.verify();try{let s;if(E("string"==typeof r,e,"argument-error"),E(n.type===Ci,e,"argument-error"),"session"in(s="string"==typeof t?{phoneNumber:t}:t)){const t=s.session;if("phoneNumber"in s){return E("enroll"===t.type,e,"internal-error"),(await bn(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo}{E("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;return E(n,e,"missing-multi-factor-info"),(await fi(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await it(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}async function Hi(t,n){await Ct((0,e.getModularInstance)(t),n)}class zi{constructor(e){this.providerId=zi.PROVIDER_ID,this.auth=Le(e)}verifyPhoneNumber(t,n){return ji(this.auth,t,(0,e.getModularInstance)(n))}static credential(e,t){return ct._fromVerification(e,t)}static credentialFromResult(e){const t=e;return zi.credentialFromTaggedObject(t)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?ct._fromTokenResponse(t,n):null}}function Gi(e,t){return t?R(t):(E(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}exports.P=zi,zi.PROVIDER_ID="phone",zi.PHONE_SIGN_IN_METHOD="phone";class Wi extends je{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return et(e,this._buildIdpRequest())}_linkToIdToken(e,t){return et(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return et(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ki(e){return xt(e.auth,new Wi(e),e.bypassAuthState)}function Ji(e){const{auth:t,user:n}=e;return E(n,t,"internal-error"),Mt(n,new Wi(e),e.bypassAuthState)}async function Bi(e){const{auth:t,user:n}=e;return E(n,t,"internal-error"),Ct(n,new Wi(e),e.bypassAuthState)}class $i{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ki;case"linkViaPopup":case"linkViaRedirect":return Bi;case"reauthViaPopup":case"reauthViaRedirect":return Ji;default:v(this.auth,"internal-error")}}resolve(e){N(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){N(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Yi=new M(2e3,1e4);async function Xi(e,t,n){const i=Le(e);y(e,t,mt);const r=Gi(i,n);return new er(i,"signInViaPopup",t,r).executeNotNull()}async function Qi(t,n,i){const r=(0,e.getModularInstance)(t);y(r.auth,n,mt);const s=Gi(r.auth,i);return new er(r.auth,"reauthViaPopup",n,s,r).executeNotNull()}async function Zi(t,n,i){const r=(0,e.getModularInstance)(t);y(r.auth,n,mt);const s=Gi(r.auth,i);return new er(r.auth,"linkViaPopup",n,s,r).executeNotNull()}class er extends $i{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,er.currentPopupAction&&er.currentPopupAction.cancel(),er.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return E(e,this.auth,"internal-error"),e}async onExecution(){N(1===this.filter.length,"Popup operations only handle one event");const e=Kn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(_(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(_(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,er.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;null!==(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)&&void 0!==n&&n.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_(this.auth,"popup-closed-by-user"))},2e3):this.pollId=window.setTimeout(e,Yi.get())};e()}}er.currentPopupAction=null;const tr="pendingRedirect",nr=new Map;class ir extends $i{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=nr.get(this.auth._key());if(!e){try{const n=await rr(this.resolver,this.auth)?await super.execute():null;e=(()=>Promise.resolve(n))}catch(t){e=(()=>Promise.reject(t))}nr.set(this.auth._key(),e)}return e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function rr(e,t){const n=cr(t),i="true"===await ar(e)._get(n);return await ar(e)._remove(n),i}async function sr(e,t){return ar(e)._set(cr(t),"true")}function or(){nr.clear()}function ar(e){return R(e._redirectPersistence)}function cr(e){return ge(tr,e.config.apiKey,e.name)}function ur(e,t,n){return dr(e,t,n)}async function dr(e,t,n){const i=Le(e);y(e,t,mt);const r=Gi(i,n);return await sr(r,i),r._openRedirect(i,t,"signInViaRedirect")}function lr(e,t,n){return hr(e,t,n)}async function hr(t,n,i){const r=(0,e.getModularInstance)(t);y(r.auth,n,mt);const s=Gi(r.auth,i);await sr(s,r.auth);const o=await Ir(r);return s._openRedirect(r.auth,n,"reauthViaRedirect",o)}function pr(e,t,n){return mr(e,t,n)}async function mr(t,n,i){const r=(0,e.getModularInstance)(t);y(r.auth,n,mt);const s=Gi(r.auth,i);await Lt(!1,r,n.providerId),await sr(s,r.auth);const o=await Ir(r);return s._openRedirect(r.auth,n,"linkViaRedirect",o)}async function fr(e,t){return await Le(e)._initializationPromise,gr(e,t,!1)}async function gr(e,t,n=!1){const i=Le(e),r=Gi(i,t),s=new ir(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}async function Ir(e){const t=Kn(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}const vr=6e5;class _r{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wr(e)?t:(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0),t)}sendToConsumer(e,t){var n;if(e.error&&!yr(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(_(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vr&&this.cachedEventUids.clear(),this.cachedEventUids.has(Tr(e))}saveEventToCache(e){this.cachedEventUids.add(Tr(e)),this.lastProcessedEventTime=Date.now()}}function Tr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function yr({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}function wr(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yr(e);default:return!1}}async function Er(e,t={}){return j(e,"GET","/v1/projects",t)}exports.az=_r;const kr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Nr=/^https?/;async function Ar(e){if(e.config.emulator)return;const{authorizedDomains:t}=await Er(e);for(const i of t)try{if(Rr(i))return}catch(n){}v(e,"unauthorized-domain")}function Rr(e){const t=O(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Nr.test(n))return!1;if(kr.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Sr=new M(3e4,6e4);function br(){const e=Bn().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Or(e){return new Promise((t,n)=>{var i,r,s;function o(){br(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{br(),n(_(e,"network-request-failed"))},timeout:Sr.get()})}if(null===(r=null===(i=Bn().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(null===(s=Bn().gapi)||void 0===s||!s.load){const t=Ti("iframefcb");return Bn()[t]=(()=>{gapi.load?o():n(_(e,"network-request-failed"))}),_i(`https://apis.google.com/js/api.js?onload=${t}`)}o()}}).catch(e=>{throw Pr=null,e})}let Pr=null;function Dr(e){return Pr=Pr||Or(e)}const Cr=new M(5e3,15e3),Lr="__/auth/iframe",Mr="emulator/auth/iframe",xr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},Ur=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fr(n){const i=n.config;E(i.authDomain,n,"auth-domain-config-required");const r=i.emulator?x(i,Mr):`https://${n.config.authDomain}/${Lr}`,s={apiKey:i.apiKey,appName:n.name,v:t.SDK_VERSION},o=Ur.get(n.config.apiHost);o&&(s.eid=o);const a=n._getFrameworks();return a.length&&(s.fw=a.join(",")),`${r}?${(0,e.querystring)(s).slice(1)}`}async function Vr(e){const t=await Dr(e),n=Bn().gapi;return E(n,e,"internal-error"),t.open({where:document.body,url:Fr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xr,dontclear:!0},t=>new Promise(async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=_(e,"network-request-failed"),s=Bn().setTimeout(()=>{i(r)},Cr.get());function o(){Bn().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{i(r)})}))}const qr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},jr=500,Hr=600,zr="_blank",Gr="http://localhost";class Wr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Kr(t,n,i,r=jr,s=Hr){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},qr),{width:r.toString(),height:s.toString(),top:o,left:a}),d=(0,e.getUA)().toLowerCase();i&&(c=ye(d)?zr:i),_e(d)&&(n=n||Gr,u.scrollbars="yes");const l=Object.entries(u).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(Se(d)&&"_self"!==c)return Jr(n||"",c),new Wr(null);const h=window.open(n||"",c,l);E(h,t,"popup-blocked");try{h.focus()}catch(p){}return new Wr(h)}function Jr(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}exports.aH=Wr;const Br="__/auth/handler",$r="emulator/auth/handler";function Yr(n,i,r,s,o,a){E(n.config.authDomain,n,"auth-domain-config-required"),E(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:r,redirectUrl:s,v:t.SDK_VERSION,eventId:o};if(i instanceof mt){i.setDefaultLanguage(n.languageCode),c.providerId=i.providerId||"",(0,e.isEmpty)(i.getCustomParameters())||(c.customParameters=JSON.stringify(i.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(i instanceof ft){const e=i.getScopes().filter(e=>""!==e);e.length>0&&(c.scopes=e.join(","))}n.tenantId&&(c.tid=n.tenantId);const u=c;for(const e of Object.keys(u))void 0===u[e]&&delete u[e];return`${Xr(n)}?${(0,e.querystring)(u).slice(1)}`}function Xr({config:e}){return e.emulator?x(e,$r):`https://${e.authDomain}/${Br}`}const Qr="webStorageSupport";class Zr{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zn,this._completeRedirectFn=gr}async _openPopup(e,t,n,i){var r;return N(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),Kr(e,Yr(e,t,n,O(),i),Kn())}async _openRedirect(e,t,n,i){return await this._originValidation(e),$n(Yr(e,t,n,O(),i)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(N(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n}async initAndGetManager(e){const t=await Vr(e),n=new _r(e);return t.register("authEvent",t=>{return E(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qr,{type:Qr},n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Qr];void 0!==r&&t(!!r),v(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Ar(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Oe()||Te()||Ae()}}const es=Zr;exports.k=es;class ts{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return k("unexpected MultiFactorSessionType")}}}class ns extends ts{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new ns(e)}_finalizeEnroll(e,t,n){return On(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return gi(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class is{constructor(){}static assertion(e){return ns._fromCredential(e)}}exports.m=is,is.FACTOR_ID="phone";var rs="@firebase/auth",ss="0.18.3";class os{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){E(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function as(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function cs(e){(0,t._registerComponent)(new r.Component("auth",(t,{options:n})=>{const i=t.getProvider("app").getImmediate(),{apiKey:r,authDomain:s}=i.options;return(t=>{E(r&&!r.includes(":"),"invalid-api-key",{appName:t.name}),E(!(null==s?void 0:s.includes(":")),"argument-error",{appName:t.name});const i={apiKey:r,authDomain:s,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:De(e)},o=new Ce(t,i);return b(o,n),o})(i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,t._registerComponent)(new r.Component("auth-internal",e=>{return(e=>new os(e))(Le(e.getProvider("auth").getImmediate()))},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,t.registerVersion)(rs,ss,as(e)),(0,t.registerVersion)(rs,ss,"esm2017")}function us(e=(0,t.getApp)()){const n=(0,t._getProvider)(e,"auth");return n.isInitialized()?n.getImmediate():S(e,{popupRedirectResolver:es,persistence:[mi,jn,zn]})}cs("Browser");
},{"@firebase/util":"chA2","@firebase/app":"Qqsz","tslib":"vCxL","@firebase/logger":"MfMd","@firebase/component":"sLOu"}],"QWyA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"ActionCodeOperation",{enumerable:!0,get:function(){return e.A}}),Object.defineProperty(exports,"ActionCodeURL",{enumerable:!0,get:function(){return e.ac}}),Object.defineProperty(exports,"AuthCredential",{enumerable:!0,get:function(){return e.G}}),Object.defineProperty(exports,"AuthErrorCodes",{enumerable:!0,get:function(){return e.C}}),Object.defineProperty(exports,"EmailAuthCredential",{enumerable:!0,get:function(){return e.H}}),Object.defineProperty(exports,"EmailAuthProvider",{enumerable:!0,get:function(){return e.L}}),Object.defineProperty(exports,"FacebookAuthProvider",{enumerable:!0,get:function(){return e.M}}),Object.defineProperty(exports,"FactorId",{enumerable:!0,get:function(){return e.F}}),Object.defineProperty(exports,"GithubAuthProvider",{enumerable:!0,get:function(){return e.Q}}),Object.defineProperty(exports,"GoogleAuthProvider",{enumerable:!0,get:function(){return e.N}}),Object.defineProperty(exports,"OAuthCredential",{enumerable:!0,get:function(){return e.I}}),Object.defineProperty(exports,"OAuthProvider",{enumerable:!0,get:function(){return e.T}}),Object.defineProperty(exports,"OperationType",{enumerable:!0,get:function(){return e.O}}),Object.defineProperty(exports,"PhoneAuthCredential",{enumerable:!0,get:function(){return e.J}}),Object.defineProperty(exports,"PhoneAuthProvider",{enumerable:!0,get:function(){return e.P}}),Object.defineProperty(exports,"PhoneMultiFactorGenerator",{enumerable:!0,get:function(){return e.m}}),Object.defineProperty(exports,"ProviderId",{enumerable:!0,get:function(){return e.o}}),Object.defineProperty(exports,"RecaptchaVerifier",{enumerable:!0,get:function(){return e.R}}),Object.defineProperty(exports,"SAMLAuthProvider",{enumerable:!0,get:function(){return e.U}}),Object.defineProperty(exports,"SignInMethod",{enumerable:!0,get:function(){return e.S}}),Object.defineProperty(exports,"TwitterAuthProvider",{enumerable:!0,get:function(){return e.V}}),Object.defineProperty(exports,"applyActionCode",{enumerable:!0,get:function(){return e.a1}}),Object.defineProperty(exports,"browserLocalPersistence",{enumerable:!0,get:function(){return e.b}}),Object.defineProperty(exports,"browserPopupRedirectResolver",{enumerable:!0,get:function(){return e.k}}),Object.defineProperty(exports,"browserSessionPersistence",{enumerable:!0,get:function(){return e.a}}),Object.defineProperty(exports,"checkActionCode",{enumerable:!0,get:function(){return e.a2}}),Object.defineProperty(exports,"confirmPasswordReset",{enumerable:!0,get:function(){return e.a0}}),Object.defineProperty(exports,"connectAuthEmulator",{enumerable:!0,get:function(){return e.E}}),Object.defineProperty(exports,"createUserWithEmailAndPassword",{enumerable:!0,get:function(){return e.a4}}),Object.defineProperty(exports,"debugErrorMap",{enumerable:!0,get:function(){return e.z}}),Object.defineProperty(exports,"deleteUser",{enumerable:!0,get:function(){return e.y}}),Object.defineProperty(exports,"fetchSignInMethodsForEmail",{enumerable:!0,get:function(){return e.a9}}),Object.defineProperty(exports,"getAdditionalUserInfo",{enumerable:!0,get:function(){return e.ak}}),Object.defineProperty(exports,"getAuth",{enumerable:!0,get:function(){return e.n}}),Object.defineProperty(exports,"getIdToken",{enumerable:!0,get:function(){return e.ah}}),Object.defineProperty(exports,"getIdTokenResult",{enumerable:!0,get:function(){return e.ai}}),Object.defineProperty(exports,"getMultiFactorResolver",{enumerable:!0,get:function(){return e.am}}),Object.defineProperty(exports,"getRedirectResult",{enumerable:!0,get:function(){return e.j}}),Object.defineProperty(exports,"inMemoryPersistence",{enumerable:!0,get:function(){return e.K}}),Object.defineProperty(exports,"indexedDBLocalPersistence",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(exports,"initializeAuth",{enumerable:!0,get:function(){return e.D}}),Object.defineProperty(exports,"isSignInWithEmailLink",{enumerable:!0,get:function(){return e.a7}}),Object.defineProperty(exports,"linkWithCredential",{enumerable:!0,get:function(){return e.Y}}),Object.defineProperty(exports,"linkWithPhoneNumber",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(exports,"linkWithPopup",{enumerable:!0,get:function(){return e.d}}),Object.defineProperty(exports,"linkWithRedirect",{enumerable:!0,get:function(){return e.g}}),Object.defineProperty(exports,"multiFactor",{enumerable:!0,get:function(){return e.an}}),Object.defineProperty(exports,"onAuthStateChanged",{enumerable:!0,get:function(){return e.t}}),Object.defineProperty(exports,"onIdTokenChanged",{enumerable:!0,get:function(){return e.q}}),Object.defineProperty(exports,"parseActionCodeURL",{enumerable:!0,get:function(){return e.ad}}),Object.defineProperty(exports,"prodErrorMap",{enumerable:!0,get:function(){return e.B}}),Object.defineProperty(exports,"reauthenticateWithCredential",{enumerable:!0,get:function(){return e.Z}}),Object.defineProperty(exports,"reauthenticateWithPhoneNumber",{enumerable:!0,get:function(){return e.r}}),Object.defineProperty(exports,"reauthenticateWithPopup",{enumerable:!0,get:function(){return e.e}}),Object.defineProperty(exports,"reauthenticateWithRedirect",{enumerable:!0,get:function(){return e.h}}),Object.defineProperty(exports,"reload",{enumerable:!0,get:function(){return e.al}}),Object.defineProperty(exports,"sendEmailVerification",{enumerable:!0,get:function(){return e.aa}}),Object.defineProperty(exports,"sendPasswordResetEmail",{enumerable:!0,get:function(){return e.$}}),Object.defineProperty(exports,"sendSignInLinkToEmail",{enumerable:!0,get:function(){return e.a6}}),Object.defineProperty(exports,"setPersistence",{enumerable:!0,get:function(){return e.p}}),Object.defineProperty(exports,"signInAnonymously",{enumerable:!0,get:function(){return e.W}}),Object.defineProperty(exports,"signInWithCredential",{enumerable:!0,get:function(){return e.X}}),Object.defineProperty(exports,"signInWithCustomToken",{enumerable:!0,get:function(){return e._}}),Object.defineProperty(exports,"signInWithEmailAndPassword",{enumerable:!0,get:function(){return e.a5}}),Object.defineProperty(exports,"signInWithEmailLink",{enumerable:!0,get:function(){return e.a8}}),Object.defineProperty(exports,"signInWithPhoneNumber",{enumerable:!0,get:function(){return e.s}}),Object.defineProperty(exports,"signInWithPopup",{enumerable:!0,get:function(){return e.c}}),Object.defineProperty(exports,"signInWithRedirect",{enumerable:!0,get:function(){return e.f}}),Object.defineProperty(exports,"signOut",{enumerable:!0,get:function(){return e.x}}),Object.defineProperty(exports,"unlink",{enumerable:!0,get:function(){return e.aj}}),Object.defineProperty(exports,"updateCurrentUser",{enumerable:!0,get:function(){return e.w}}),Object.defineProperty(exports,"updateEmail",{enumerable:!0,get:function(){return e.af}}),Object.defineProperty(exports,"updatePassword",{enumerable:!0,get:function(){return e.ag}}),Object.defineProperty(exports,"updatePhoneNumber",{enumerable:!0,get:function(){return e.u}}),Object.defineProperty(exports,"updateProfile",{enumerable:!0,get:function(){return e.ae}}),Object.defineProperty(exports,"useDeviceLanguage",{enumerable:!0,get:function(){return e.v}}),Object.defineProperty(exports,"verifyBeforeUpdateEmail",{enumerable:!0,get:function(){return e.ab}}),Object.defineProperty(exports,"verifyPasswordResetCode",{enumerable:!0,get:function(){return e.a3}});var e=require("./index-f41a0691.js");require("@firebase/util"),require("@firebase/app"),require("tslib"),require("@firebase/logger"),require("@firebase/component");
},{"./index-f41a0691.js":"jcKN","@firebase/util":"chA2","@firebase/app":"Qqsz","tslib":"vCxL","@firebase/logger":"MfMd","@firebase/component":"sLOu"}],"zKjx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/auth");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/auth":"QWyA"}],"RIsD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.firebaseConsts=void 0;var e=require("firebase/firestore"),a=require("firebase/database"),r=require("firebase/auth");const s={fireStoreDatabase:(0,e.getFirestore)(),realTimeDatabase:(0,a.getDatabase)(),auth:(0,r.getAuth)(),userID:0,databaseRef:{},email:"",password:""};exports.firebaseConsts=s;
},{"firebase/firestore":"vHL5","firebase/database":"Uuoh","firebase/auth":"zKjx"}],"GzvF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getWatched=u,exports.getQueue=l;var e=require("firebase/firestore"),t=require("./firebase-vars"),a=i(require("../refs")),n=i(require("../../templates/film-card")),s=require("../translate"),r=require("../fetch-api");function i(e){return e&&e.__esModule?e:{default:e}}async function u(){a.default.watchedBtn.classList.remove("button--white"),a.default.watchedBtn.classList.add("button--orange"),a.default.queueBtn.classList.remove("button--orange"),a.default.queueBtn.classList.add("button--white"),a.default.gallery.innerHTML="";const r=await(0,e.getDoc)(t.firebaseConsts.databaseRef);if(r.exists()){const e=r.data().watched.map(e=>(e.genres=e.genres.map(e=>e.name),d(e),e));0===e.length?(0,s.notifyMovieFound)():a.default.gallery.innerHTML=(0,n.default)(e)}}async function l(){a.default.queueBtn.classList.add("button--orange"),a.default.queueBtn.classList.remove("button--white"),a.default.watchedBtn.classList.add("button--white"),a.default.watchedBtn.classList.remove("button--orange"),a.default.gallery.innerHTML="";const r=await(0,e.getDoc)(t.firebaseConsts.databaseRef);if(r.exists()){const e=r.data().queue.map(e=>(e.genres=e.genres&&e.genres.map(e=>e.name),d(e),e));0===e.length?(0,s.notifyMovieFound)():a.default.gallery.innerHTML=(0,n.default)(e)}}function d(e){e.genres&&e.genres.length>3?e.genres=e.genres.splice(0,2).join(", ")+o():e.genres=e.genres&&e.genres.join(", "),e.release_date&&(e.release_date=e.release_date.slice(0,4))}function o(){return"en"===r.fetchApi.lang?", Other":", другие"}a.default.libraryLink.addEventListener("click",u),a.default.watchedBtn.addEventListener("click",u),a.default.queueBtn.addEventListener("click",l);
},{"firebase/firestore":"vHL5","./firebase-vars":"RIsD","../refs":"VyiV","../../templates/film-card":"fFoL","../translate":"nUSU","../fetch-api":"ye0o"}],"xPtF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addToQueue=l,exports.addToWatched=c,exports.addUserToDatabase=n,exports.deleteFromWatched=f,exports.deleteFromQueue=y;var e=u(require("../refs")),t=require("./firebase-app"),a=u(require("notiflix")),r=require("firebase/firestore"),s=require("firebase/database"),o=require("./firebase-vars"),i=require("../translate"),d=require("./fetch-from-firebase");function u(e){return e&&e.__esModule?e:{default:e}}async function n(e,t){try{o.firebaseConsts.databaseRef=(0,r.doc)(o.firebaseConsts.fireStoreDatabase,"user",e),await(0,r.setDoc)(o.firebaseConsts.databaseRef,{mail:t,userId:e,watched:[],queue:[]})}catch(a){(0,i.notifyErrData)(error)}}async function c(){b().then(e=>{const t=e.id;try{(0,r.setDoc)((0,r.doc)(o.firebaseConsts.databaseRef,"watched",`${t}`),e),(0,r.updateDoc)(o.firebaseConsts.databaseRef,{watched:(0,r.arrayUnion)(e)}),document.querySelector(".modal-movie__buttons--watched").classList.add("visually-hidden"),document.querySelector(".modal-movie__buttons--delete-watched").classList.remove("visually-hidden"),(0,i.notifyMovie)()}catch(error){(0,i.notifyErrData)(error.message)}})}async function l(){b().then(e=>{const t=e.id;try{(0,r.setDoc)((0,r.doc)(o.firebaseConsts.databaseRef,"queue",`${t}`),e),(0,r.updateDoc)(o.firebaseConsts.databaseRef,{queue:(0,r.arrayUnion)(e)}),document.querySelector(".modal-movie__buttons--queue").classList.add("visually-hidden"),document.querySelector(".modal-movie__buttons--delete-queue").classList.remove("visually-hidden"),(0,i.notifyMovieQueue)()}catch(error){(0,i.notifyErrData)(error.message)}})}async function f(){b().then(t=>{try{(0,r.deleteDoc)((0,r.doc)(o.firebaseConsts.databaseRef,"watched",`${t.id}`)),(0,r.updateDoc)(o.firebaseConsts.databaseRef,{watched:(0,r.arrayRemove)(t)}),document.querySelector(".modal-movie__buttons--delete-watched").classList.add("visually-hidden"),document.querySelector(".modal-movie__buttons--watched").classList.remove("visually-hidden"),(0,i.notifyDeleteMovie)(),e.default.libraryLink.classList.contains("header-links__link--current")&&(0,d.getWatched)()}catch(error){(0,i.notifyErrData)(error)}})}function y(){b().then(t=>{try{(0,r.deleteDoc)((0,r.doc)(o.firebaseConsts.databaseRef,"queue",`${t.id}`)),(0,r.updateDoc)(o.firebaseConsts.databaseRef,{queue:(0,r.arrayRemove)(t)}),document.querySelector(".modal-movie__buttons--delete-queue").classList.add("visually-hidden"),document.querySelector(".modal-movie__buttons--queue").classList.remove("visually-hidden"),(0,i.notifyDeleteQueue)(),e.default.libraryLink.classList.contains("header-links__link--current")&&(0,d.getQueue)()}catch(error){(0,i.notifyErrData)(error)}})}async function b(){return await(0,s.get)((0,s.child)((0,s.ref)(o.firebaseConsts.realTimeDatabase),"films/movie")).then(e=>{if(e.exists())return e.val();(0,i.notifyAvailabe)()}).catch(e=>{a.default.Notify.failure(e)})}
},{"../refs":"VyiV","./firebase-app":"esbM","notiflix":"ja4j","firebase/firestore":"vHL5","firebase/database":"Uuoh","./firebase-vars":"RIsD","../translate":"nUSU","./fetch-from-firebase":"GzvF"}],"qUE8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addListeners=g;var e=d(require("../refs")),s=require("./firebase-app"),t=require("firebase/auth"),i=d(require("notiflix")),a=require("firebase/firestore"),n=require("../modal"),r=require("./firebase-vars"),o=require("../translate"),l=require("../fetch-api"),u=require("./firebase-db-logic");function d(e){return e&&e.__esModule?e:{default:e}}function f(){"en"===l.fetchApi.lang?i.default.Notify.success(`Hello, ${r.firebaseConsts.email}`):i.default.Notify.success(`Привет, ${r.firebaseConsts.email}`)}async function c(){r.firebaseConsts.email=document.getElementById("email").value,r.firebaseConsts.password=document.getElementById("password").value,await(0,t.createUserWithEmailAndPassword)(r.firebaseConsts.auth,r.firebaseConsts.email,r.firebaseConsts.password).then(s=>{const t=s.user;(0,u.addUserToDatabase)(t.uid,t.email),e.default.libraryLink.classList.remove("visually-hidden"),(0,n.toggleModal)(),y(),(0,o.notifyAccept)()}).catch(e=>{i.default.Notify.failure(e.message)})}async function m(){r.firebaseConsts.email=document.getElementById("email").value,r.firebaseConsts.password=document.getElementById("password").value,await(0,t.signInWithEmailAndPassword)(r.firebaseConsts.auth,r.firebaseConsts.email,r.firebaseConsts.password).then(s=>{(0,n.toggleModal)(),y(),e.default.libraryLink.classList.remove("visually-hidden"),(0,o.notifyLoggedIn)()}).catch(e=>{i.default.Notify.failure(e.message)})}function b(){r.firebaseConsts.auth.signOut(),v(),e.default.libraryLink.classList.add("visually-hidden"),(0,o.notifyLoggedOut)()}function g(){const e=document.getElementById("login-form"),s=document.querySelector(".sign-up"),t=document.querySelector(".sign-in");e.addEventListener("submit",e=>{e.preventDefault()}),s.addEventListener("click",c),t.addEventListener("click",m)}function y(){const e=document.querySelector(".sign-up"),s=document.querySelector(".sign-in");e.removeEventListener("click",c),s.removeEventListener("click",m)}function v(){e.default.loginLink.classList.toggle("visually-hidden"),e.default.logoutLink.classList.toggle("visually-hidden")}e.default.loginLink.addEventListener("click",n.createLoginModal),e.default.logoutLink.addEventListener("click",b),(0,t.onAuthStateChanged)(r.firebaseConsts.auth,s=>{s&&(v(),e.default.libraryLink.classList.remove("visually-hidden"),r.firebaseConsts.userID=s.uid,r.firebaseConsts.email=s.email,r.firebaseConsts.databaseRef=(0,a.doc)(r.firebaseConsts.fireStoreDatabase,"user",r.firebaseConsts.userID),f())});
},{"../refs":"VyiV","./firebase-app":"esbM","firebase/auth":"zKjx","notiflix":"ja4j","firebase/firestore":"vHL5","../modal":"RSqK","./firebase-vars":"RIsD","../translate":"nUSU","../fetch-api":"ye0o","./firebase-db-logic":"xPtF"}],"RSqK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toggleModal=h,exports.createLoginModal=g;var e=b(require("./refs")),t=b(require("../templates/team-list.hbs")),a=b(require("../templates/team-listRu.hbs")),i=b(require("../html-partials/authentication.html")),n=b(require("../templates/movie-modal-templ.hbs")),d=b(require("../templates/movie-modal-templRu.hbs")),o=b(require("../json/team-infoRu.json")),s=b(require("../json/team-info.json")),l=require("firebase/firestore"),r=require("firebase/database"),u=require("./firebase/firebase-auth"),c=require("./firebase/firebase-db-logic"),f=require("./firebase/firebase-vars"),m=require("./fetch-api.js"),v=require("./translate");function b(e){return e&&e.__esModule?e:{default:e}}function h(){document.body.classList.toggle("modal-open"),e.default.modal.classList.toggle("is-hidden")}function L(){h(),E()}function q(e){e.preventDefault(),M(),w(),"en"===m.fetchApi.lang?p((0,t.default)(s.default)):p((0,t.default)(o.default)),h()}function g(){M(),w(),p(i.default),h(),(0,u.addListeners)(),(0,v.changeLanguage)()}async function y(t){if(M(),w(),!t.target.closest("li"))return;m.fetchApi.movieID=t.target.closest("li").id;const a=await(0,m.fetchDataByID)();"en"===m.fetchApi.lang?p((0,n.default)(a)):p((0,d.default)(a)),S(f.firebaseConsts.realTimeDatabase,a);const i=document.querySelector(".modal-movie__buttons--watched"),o=document.querySelector(".modal-movie__buttons--queue");if(e.default.logoutLink.classList.contains("visually-hidden"))(0,v.notifyWarning)(),o.disabled=!0,i.disabled=!0,o.classList.add("button--disabled"),i.classList.add("button--disabled");else{j(a.id).then(e=>{e&&(document.querySelector(".modal-movie__buttons--watched").classList.add("visually-hidden"),document.querySelector(".modal-movie__buttons--delete-watched").classList.remove("visually-hidden"))}),D(a.id).then(e=>{e&&(document.querySelector(".modal-movie__buttons--queue").classList.add("visually-hidden"),document.querySelector(".modal-movie__buttons--delete-queue").classList.remove("visually-hidden"))})}h(),i.addEventListener("click",c.addToWatched),o.addEventListener("click",c.addToQueue),document.querySelector(".modal-movie__buttons--delete-watched").addEventListener("click",c.deleteFromWatched),document.querySelector(".modal-movie__buttons--delete-queue").addEventListener("click",c.deleteFromQueue)}function p(t){e.default.modalContainer.innerHTML=t}function _(e){"Escape"===e.code&&L()}function k(e){e.target.classList.contains("backdrop")&&L()}function w(){e.default.closeModalBtn.addEventListener("click",L),e.default.backdrop.addEventListener("click",k),window.addEventListener("keydown",_)}function E(){e.default.closeModalBtn.removeEventListener("click",L),e.default.backdrop.removeEventListener("click",k),window.removeEventListener("keydown",_)}function M(){e.default.modalContainer.innerHTML=""}function S(e,t){(0,r.set)((0,r.ref)(e,"films/"),{movie:t,movieId:t.id})}async function D(e){const t=(0,l.doc)(f.firebaseConsts.databaseRef,"queue",`${e}`);return!!(await(0,l.getDoc)(t)).exists()}async function j(e){const t=(0,l.doc)(f.firebaseConsts.databaseRef,"watched",`${e}`);return!!(await(0,l.getDoc)(t)).exists()}e.default.developerLink.addEventListener("click",q),e.default.gallery.addEventListener("click",y),(0,v.changeLanguage)();
},{"./refs":"VyiV","../templates/team-list.hbs":"YrcB","../templates/team-listRu.hbs":"s2Sp","../html-partials/authentication.html":"sqTZ","../templates/movie-modal-templ.hbs":"BjeX","../templates/movie-modal-templRu.hbs":"IKki","../json/team-infoRu.json":"yOA5","../json/team-info.json":"loKf","firebase/firestore":"vHL5","firebase/database":"Uuoh","./firebase/firebase-auth":"qUE8","./firebase/firebase-db-logic":"xPtF","./firebase/firebase-vars":"RIsD","./fetch-api.js":"ye0o","./translate":"nUSU"}],"yQEh":[function(require,module,exports) {
"use strict";var o=e(require("../refs"));function e(o){return o&&o.__esModule?o:{default:o}}const{footer:t}=o.default;window.onscroll=function(){f()};const s=t.offsetBottom=t.offsetTop+t.offsetHeight+500;function f(){window.pageYOffset>=s?t.classList.add("footer--visible"):t.classList.remove("footer--visible")}
},{"../refs":"VyiV"}],"Focm":[function(require,module,exports) {
"use strict";require("./sass/main.scss"),require("./js/header/header"),require("./js/check-theme"),require("./js/container/mainMarkup"),require("./js/modal"),require("./js/firebase/firebase-app"),require("./js/firebase/firebase-auth"),require("./js/firebase/fetch-from-firebase"),require("./js/footer/footer"),require("./js/translate"),require("./js/header/filter");
},{"./sass/main.scss":"clu1","./js/header/header":"N0LX","./js/check-theme":"ToPQ","./js/container/mainMarkup":"u2ZQ","./js/modal":"RSqK","./js/firebase/firebase-app":"esbM","./js/firebase/firebase-auth":"qUE8","./js/firebase/fetch-from-firebase":"GzvF","./js/footer/footer":"yQEh","./js/translate":"nUSU","./js/header/filter":"ZO32"}],"FheM":[function(require,module,exports) {
var t=null;function e(){return t||(t=n()),t}function n(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return r(t[0])}return"/"}function r(t){return(""+t).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}exports.getBundleURL=e,exports.getBaseURL=r;
},{}],"TUK3":[function(require,module,exports) {
var r=require("./bundle-url").getBundleURL;function e(r){Array.isArray(r)||(r=[r]);var e=r[r.length-1];try{return Promise.resolve(require(e))}catch(n){if("MODULE_NOT_FOUND"===n.code)return new s(function(n,i){t(r.slice(0,-1)).then(function(){return require(e)}).then(n,i)});throw n}}function t(r){return Promise.all(r.map(u))}var n={};function i(r,e){n[r]=e}module.exports=exports=e,exports.load=t,exports.register=i;var o={};function u(e){var t;if(Array.isArray(e)&&(t=e[1],e=e[0]),o[e])return o[e];var i=(e.substring(e.lastIndexOf(".")+1,e.length)||e).toLowerCase(),u=n[i];return u?o[e]=u(r()+e).then(function(r){return r&&module.bundle.register(t,r),r}).catch(function(r){throw delete o[e],r}):void 0}function s(r){this.executor=r,this.promise=null}s.prototype.then=function(r,e){return null===this.promise&&(this.promise=new Promise(this.executor)),this.promise.then(r,e)},s.prototype.catch=function(r){return null===this.promise&&(this.promise=new Promise(this.executor)),this.promise.catch(r)};
},{"./bundle-url":"FheM"}],"A3BY":[function(require,module,exports) {
module.exports=function(t){return fetch(t).then(function(t){return t.text()})};
},{}],0:[function(require,module,exports) {
var b=require("TUK3");b.register("html",require("A3BY"));b.load([["authentication.b28f97e8.html","sqTZ"]]).then(function(){require("Focm");});
},{}]},{},[0], null)
//# sourceMappingURL=/team-project-js/src.3192eabf.js.map